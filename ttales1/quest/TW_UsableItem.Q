// $Id: TW_UsableItem.Q,v 1.94 2003/05/07 01:51:21 softmax Exp $

#Import quest/system.h
#Import quest/tales_system.h
#Import quest/tw_mssi.h
#Import quest/tw_util.h
#Import quest/TW_NPC_Talk.h
#Import quest/TW_UsableItem.h
#Import quest/TW_NPC_Clad.h
#Import quest/TW_ResetQuest_Last.h
#Import quest/TW_EP2_CHAP00_Log.h


quest
qPickItem()
{
//	// check type class. only item can call this quest
//	if (controller.getTypeName() != "Item") {
//		Util.log("! invalid type [" + controller.getTypeName() + "] instead of item");
//		return;
//	}
//
//	// TODO: check item class and determin which jobs should be done
}


quest
qDropItem()
{
//	// check type class. only item can call this quest
//	if (controller.getTypeName() != "Item") {
//		Util.log("! invalid type [" + controller.getTypeName() + "] instead of item");
//		return;
//	}
//
//	// TODO: check item class and determin which jobs should be done
}

quest
qCanGiveToUser()
{
	// 전속을 할 수 있는 아이템 유무 체크 1이면 가능 0이면 불가
	if (controller.canBelong() == 1)
	{
		if (controller.getClassName() == "1006166")
		{
			if (controller.getAttribute("meetuser") == null)
				controller.setAttribute("meetuser", trigger.getName());
		}
/*
		if (!controller.isCashItem())
		{
			trigger.message(TEXT_CASHITEM_NOT_BELONG, MSG_TYPE__SYSTEM);
			return;
		}
*/
		// 이미 전속을 한 아이템 인가를 체크 (0이면 가능 1이면 불가)
		if (controller.belong() == 0)
		{
			// 서버에서 setBelong 처리
//			controller.setBelong(1);
			Machine.setBooleanReturn(true);
		}
		else
			Machine.setBooleanReturn(false);
	}
	else
		Machine.setBooleanReturn(false);
}

quest
qCanDropCash()
{
	if (Util.getRealNationType() == JAPAN)
		Machine.setBooleanReturn(true);
	else
		Machine.setBooleanReturn(false);
}


quest
qDropCashItem()
{
	integer iSeed, nSeed;
	string iName;
	iName = controller.getClassName();

	if (Util.getRealNationType() == JAPAN ) {
		iSeed = controller.getPrice() / 4;
//		if (iSeed < 1)		// vahma - setting for japan
			iSeed = 1;

		nSeed = trigger.getAvailGold();
		if (nSeed < iSeed) {
			trigger.setGold(trigger.getGold() + iSeed);
			iSeed = nSeed;
		} else {
			trigger.setGold(trigger.getGold() + iSeed);
		}

		trigger.message(TEXT_CASH_ITEM_DROP_SEED + iSeed, MSG_TYPE__SYSTEM);
		Util.log("! Cash Item Drop! # Item[ " + iName + " / " + controller.getDescClassNamed(iName) + " : " + iSeed + "], User[" + trigger.getName() + "], when[" + Util.getTimeString("%A %b %d %T") + "] at [" + trigger.getWorld().getNumber() + "]");
	} else {
		trigger.message(TEXT_CASH_ITEM_DROP, MSG_TYPE__SYSTEM);
		Util.log("! Cash Item Drop! # Item[ " + iName + " / " + controller.getDescClassNamed(iName) + "], User[" + trigger.getName() + "], when[" + Util.getTimeString("%A %b %d %T") + "] at [" + trigger.getWorld().getNumber() + "]");
	}
	controller.sweep();
}


quest
qUseItem()
{
//	string useQuestName;
//	useQuestName	= "qUseItem" + controller.getClassName();
//	controller.giveQuestTo(useQuestName, trigger, /* no argument */"");
}


function boolean
checkMinMax(object item, integer TEIP)
{
	integer current = item.getTEIP(TEIP);

	if (current <= 0) {
		trigger.message(CANT_USE_FOR_ZERO_VALUE , MSG_TYPE__SYSTEM);
		return false;
	}
	if (current >= item.getMaxTEIP(TEIP)) {
		trigger.message(CANT_USE_FOR_MAX_VALUE , MSG_TYPE__SYSTEM);
		return false;
	}
	return true;
}

function boolean
checkMinMaxOfMax(object item, integer TEIP, integer value)
{
	integer tmpValue = item.getMaxTEIP(TEIP) + value;

	if (tmpValue <= 0) {
		trigger.message(CANT_USE_FOR_ZERO_VALUE_MAX , MSG_TYPE__SYSTEM);
		return false;
	}
	if (tmpValue > 255) {
		trigger.message(CANT_USE_FOR_MAX_VALUE_MAX , MSG_TYPE__SYSTEM);
		return false;
	}
	return true;
}

function boolean
checkMinOfMax(object item, integer TEIP, integer value)
{
	integer tmpValue = item.getTEIP(TEIP) + value;

	if (tmpValue <= 0) {
		trigger.message(CANT_USE_FOR_ZERO_VALUE , MSG_TYPE__SYSTEM);
		return false;
	}
	if (tmpValue > 255) {
		trigger.message(CANT_USE_FOR_MAX_VALUE , MSG_TYPE__SYSTEM);
		return false;
	}
	return true;
}

function boolean
checkManufactureCnt(object item)
{
	if (item.getManufactureCnt() >= item.getMaxManufactureCnt()) {
		trigger.message(TEXT_USABLEITEM_MAX_MANUFACTURE , MSG_TYPE__SYSTEM);
		return false;
	} else
		return true;
}

function void
checkCrack(object item, integer randomValue)		// 아이템 파손 처리용 함수 by stsoul
{
	integer randcnt = Util.random(0, 99);
	integer mapChk = trigger.getWorld().getNumber();
	integer chkvalue = 0 - randomValue;

	if (mapChk == 7 || mapChk == 114) {
		randcnt = randcnt - 5;
	} else if (mapChk == 47 || mapChk == 50 || mapChk == 303 || mapChk == 317) {
		randcnt = randcnt - 3;
	}

	if (trigger.getCharacterType() == CHAR_TYPE0 || trigger.getCharacterType() == CHAR_TYPE8) {
		randcnt = randcnt - 2;
	}

	if (randcnt < 50) return 0;
	if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, chkvalue)) return 0;
	if (!checkMinMaxOfMax(item, TEIP__FIRMNESS, chkvalue)) return 0;

	item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - randomValue);
	item.setTEIP(TEIP__FIRMNESS, item.getTEIP(TEIP__FIRMNESS) - randomValue);
	trigger.message(TEXT_USABLEITEM_MINUS_ENDURANCE1 + randomValue + TEXT_USABLEITEM_MINUS_ENDURANCE2 , MSG_TYPE__SYSTEM);
	trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE1 + randomValue + TEXT_USABLEITEM_MINUS_ENDURANCE2 , MSG_TYPE__SYSTEM);
	return 1;
}


function boolean
checkBreak(object item)				// 아이템 파괴 처리 관련 체크용 함수 by stsoul
{
	integer randcnt = Util.random(0, 99);
	integer mapChk = trigger.getWorld().getNumber();

	if (!item.canBeUnequippedBy(trigger)) return false;
//	if (!item.canBeUsedBy(trigger)) return false;

	if (item.getManufactureCnt() > 3)
		randcnt = randcnt + 30;
	else if (item.getManufactureCnt() > 2)
		randcnt = randcnt + 20;
	else if (item.getManufactureCnt() > 1)
		randcnt = randcnt + 10;

	if (mapChk == 7 || mapChk == 114)
		randcnt = randcnt - 7;
	else if (mapChk == 47 || mapChk == 50 || mapChk == 303 || mapChk == 317)
		randcnt = randcnt - 4;

	if (trigger.getCharacterType() == CHAR_TYPE0 || trigger.getCharacterType() == CHAR_TYPE8) {
		randcnt = randcnt - 2;
	}

	if (randcnt > 60) {
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_ITEM , MSG_TYPE__SYSTEM);
		item.sweep();
//		trigger.removeItemClassNamed(item.getClassName(), 1);

		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return false;
	} else
		return true;
}


function boolean
checkDeCount(object item, integer success)				// 아이템 합성회수 감소 처리 관련 체크용 함수 by stsoul
{
	integer randcnt = Util.random(0, 99);
	integer mapChk = trigger.getWorld().getNumber();

	if (!item.canBeUnequippedBy(trigger)) return false;
//	if (!item.canBeUsedBy(trigger)) return false;

	if (item.getManufactureCnt() > 3)
		randcnt = randcnt;
	else if (item.getManufactureCnt() > 2)
		randcnt = randcnt + 10;
	else if (item.getManufactureCnt() > 1)
		randcnt = randcnt + 20;

	if (mapChk == 7 || mapChk == 114)
		success = success + 100;
	else if (mapChk == 47 || mapChk == 50 || mapChk == 303 || mapChk == 317)
		success = success + 100;

	if (trigger.getCharacterType() == CHAR_TYPE0 || trigger.getCharacterType() == CHAR_TYPE8) {
		success = success + 100;
	}

	if (randcnt < (100 - success)) {
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_ITEM , MSG_TYPE__SYSTEM);
		item.sweep();
//		trigger.removeItemClassNamed(item.getClassName(), 1);

		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return false;
	} else
		return true;
}


function boolean
NormalItemCanBeUsed()
{
	if (trigger.isDead()) {
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return false;
	} else {
		return true;
	}
}

function boolean
ResurrectItemCanBeUsed(object target)
{
	if (target.isAlive()) {
		trigger.message(CANT_USE_FOR_NON_GHOST, MSG_TYPE__SYSTEM);
		return false;
	} else if (target.getWorld().canPK()) {
		if (trigger.getWorld().getNumber() == 103) {		// 운영용 PK 필드일 경우 예외처리
			return true;
		} else {
			trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, MSG_TYPE__SYSTEM);
			return false;
		}
	} else {
		return true;
	}
}

function boolean
ItemDownHP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	// 의도된 바와 실제 스크립트 내용이 다르게 구현되어 있어서 수정함.
	// value = value + target.getHP() * target.getDefence() / 2 / 100;
	// value = value - value * target.getDefence() / 2 / 100;
	value = (value - (value * target.getDefence() / 256)) / 2;

	if (value <= 0) {
		// do nothing
		return true;
	} else if (target.getHP() <= 1) {
		return false;
	} else {
		oldValue = target.getHP();

		if (oldValue - value <= 1) target.setHP(1);
		else target.setHP(oldValue - value);

		newValue = target.getHP();

		// update attribute
		target.updateAttr();

		// send message
		target.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_HP + (oldValue - newValue) + TEXT_USABLEITEM_ENDURANCE_MESSAGE_DOWN, MSG_TYPE__SYSTEM);
		return true;
	}
}


function boolean
ItemUpHP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_HP_REGEN)) {
		target.message(CANT_USE_FOR_NO_HP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	if (!target.getWorld().canUsePotion()) {
		target.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_FILED, MSG_TYPE__SYSTEM);
		return false;
	}

	// 녹색 풍선 회복 처리. 임시 -_-;
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
		value = value + (value * 3 / 10) + value * target.getDefence() / 2 / 100;
	else
		value = value + value * target.getDefence() / 2 / 100;

	// 체력이 0 일때도 회복되는 버그 수정. 캐릭터가 죽어있을때에는 허가. (부활 아이템 사용)
	if(target.isAlive() && target.getHP()==0)
		return false;

	if (value <= 0) {
		Util.log("! invalid hp value " + value + " in ItemUpHP()");
		return false;
	} else if (target.getMaxHP() == target.getHP()) {
		target.message(HP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} // else {
		oldValue = target.getHP();

		if (target.getMaxHP() < oldValue + value)
			target.setHP(target.getMaxHP());
		else
			target.setHP(oldValue + value);

		newValue = target.getHP();
		//Util.log("old " + oldValue);
		//Util.log("new " + newValue);

		// update attribute
		target.updateAttr();

		// send message
		target.message(HP_UP_MESSAGE_PREFIX + (newValue - oldValue) + HP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return true;
	// }
}

function boolean
ItemBalloonUpHP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_HP_REGEN)) {
		target.message(CANT_USE_FOR_NO_HP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	if (!target.getWorld().canUsePotion()) {
		target.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_FILED, MSG_TYPE__SYSTEM);
		return false;
	}

	value = value * 3 / 10;

	// 체력이 0 일때도 회복되는 버그 수정. 캐릭터가 죽어있을때에는 허가. (부활 아이템 사용)
	if(target.isAlive() && target.getHP()==0)
		return false;

	if (value <= 0) {
		Util.log("! invalid hp value " + value + " in ItemUpHP()");
		return false;
	} else if (target.getMaxHP() == target.getHP()) {
		target.message(HP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} // else {

	oldValue = target.getHP();

	if (target.getMaxHP() < oldValue + value)
		target.setHP(target.getMaxHP());
	else
		target.setHP(oldValue + value);

	newValue = target.getHP();
	//Util.log("old " + oldValue);
	//Util.log("new " + newValue);

	// update attribute
	target.updateAttr();

	// send message
	target.message(HP_UP_MESSAGE_BALLOON + (newValue - oldValue) + HP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
	return true;
	// }
}

function boolean
ItemDownMP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	// 의도된 바와 실제 스크립트 내용이 다르게 구현되어 있어서 수정함.
	// value = value + target.getMP() * target.getMagicResist() / 4 / 100;
	value = value - value * target.getMagicResist() / 4 / 100;

	if (value <= 0) {
		// do nothing
		return true;
	} else if (target.getMP() < value) {
		return false;
	} else {
		oldValue = target.getMP();
		target.setMP(oldValue - value);

		newValue = target.getMP();

		// update attribute
		target.updateAttr();

		// send message
		target.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_MP + (oldValue - newValue) + TEXT_USABLEITEM_ENDURANCE_MESSAGE_DOWN, MSG_TYPE__SYSTEM);
		return true;
	}
}

function boolean
ItemUpMP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_MP_REGEN)) {
		target.message(CANT_USE_FOR_NO_MP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	// 노란 풍선 회복 처리. 임시 -_-;
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")
		value = value + (value * 3 / 10) + target.getMagicResist() / 4 * target.getMP() / 150;
	else
		// 버그 지속으로 인해 짜증나는 상태가 되었으므로 다음과 같이 수정했으며 계속 고쳐나가야 함. 122 -> 150
		value = value + target.getMagicResist() / 4 * target.getMP() / 150;
		//value = value + value * target.getMagicResist() / 4 / 100;

	if (value <= 0) {
		Util.log("! invalid mp value " + value + " in ItemUpMP()");
		return false;
	} else if (target.getMaxMP() == target.getMP()) {
		target.message(MP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} else {
		oldValue = target.getMP();

		if (target.getMaxMP() < oldValue + value) target.setMP(target.getMaxMP());
		else target.setMP(oldValue + value);

		newValue = target.getMP();
		//Util.log("old " + oldValue);
		//Util.log("new " + newValue);

		// update attribute
		target.updateAttr();

		// send message
		target.message(MP_UP_MESSAGE_PREFIX + (newValue - oldValue) + MP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return true;
	}
}

function boolean
ItemBalloonUpMP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_MP_REGEN)) {
		target.message(CANT_USE_FOR_NO_MP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	value = value * 3 / 10;

	if (value <= 0) {
		Util.log("! invalid mp value " + value + " in ItemUpMP()");
		return false;
	} else if (target.getMaxMP() == target.getMP()) {
		target.message(MP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} else {
		oldValue = target.getMP();

		if (target.getMaxMP() < oldValue + value) target.setMP(target.getMaxMP());
		else target.setMP(oldValue + value);

		newValue = target.getMP();
		//Util.log("old " + oldValue);
		//Util.log("new " + newValue);

		// update attribute
		target.updateAttr();

		// send message
		target.message(MP_UP_MESSAGE_BALLOON + (newValue - oldValue) + MP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return true;
	}
}

function boolean
ItemDownSP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	// 의도된 바와 실제 스크립트 내용이 다르게 구현되어 있어서 수정함.
	// value = value + target.getSP() * target.getSP() / 3 / 100;
	// value = value + value * target.getSP() / 3 / 100;
	value = value - value * target.getDex() / 3 / 100;

	if (value <= 0) {
		// do nothing
		return true;
	} else if (target.getSP() < value) {
		return false;
	} else {
		oldValue = target.getSP();
		target.setSP(oldValue - value);

		newValue = target.getSP();

		// update attribute
		target.updateAttr();

		// send message
		target.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_SP + (oldValue - newValue) + TEXT_USABLEITEM_ENDURANCE_MESSAGE_DOWN, MSG_TYPE__SYSTEM);
		return true;
	}
}

function boolean
ItemUpSP(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_SP_REGEN)) {
		target.message(CANT_USE_FOR_NO_SP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	// 의도된 바와 실제 스크립트 내용이 다르게 구현되어 있어서 수정함.
	// value = value + target.getSP() * target.getSP() / 3 / 100;
	// value = value + value * target.getSP() / 3 / 100;
	value = value + value * target.getDex() / 3 / 100;

	if (value <= 0) {
		Util.log("! invalid sp value " + value + " in ItemUpSP()");
		return false;
	} else if (target.getMaxSP() == target.getSP()) {
		target.message(SP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} else {
		oldValue = target.getSP();

		if (target.getMaxSP() < oldValue + value) target.setSP(target.getMaxSP());
		else target.setSP(oldValue + value);

		newValue = target.getSP();

		//Util.log("old " + oldValue);
		//Util.log("new " + newValue);

		// update attribute
		target.updateAttr();

		// send message
		target.message(SP_UP_MESSAGE_PREFIX + (newValue - oldValue) + SP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return true;
	}
}

function boolean
UseSkill(object target, string skillID, integer duration)
{
	if (!NormalItemCanBeUsed()) return false;

	// decrease number
	if (controller.canBeExhausted())  controller.decreaseNumber(1);

	target.castNamedWithDuration(skillID,duration);

	// send using effect
	controller.effectBy(target);
	target.message(TEXT_USABLEITEM_MESSAGE1 + trigger.getName() + TEXT_USABLEITEM_MESSAGE2 + controller.getDesc() + TEXT_USABLEITEM_MESSAGE_GET_ITEM, MSG_TYPE__SYSTEM);
	Util.log("##Skill item use [" + trigger.getName() + "] when [" + Util.getTimeString("%A %b %d %T") + "] Skill ID [ " + skillID + " ]");

	return true;
}

function boolean
UseSkillByProb(object target, string skillID, integer duration, integer deno, integer mole)
{
	if (!NormalItemCanBeUsed()) return false;

	// decrease number
	if (controller.canBeExhausted())  controller.decreaseNumber(1);

	if (Util.random(1, deno) < mole)	target.castNamedWithDuration(skillID,duration);
	else return false;

	// send using effect
	controller.effectBy(target);
	target.message(TEXT_USABLEITEM_MESSAGE1 + trigger.getName() + TEXT_USABLEITEM_MESSAGE2 + controller.getDesc() + TEXT_USABLEITEM_MESSAGE_GET_ITEM, MSG_TYPE__SYSTEM);

	return true;
}


function boolean
ItemGetEXP(object target, integer value)
{
	integer tLV, uLV, LV, gExp;

	if (target.getCookie("RESR") != null) {
		trigger.message(TEXT_RESURRECT_TIME, MSG_TYPE__SYSTEM);
		return false;
	}

	uLV = trigger.getLevel();
	tLV = target.getLevel();

	if (tLV <= uLV)
		LV = 1;
	else
		LV = tLV - uLV;

	if (LV >= 50)
		gExp = 500;
	else
		gExp = 10 * LV;

	gExp = gExp / value;

	if (gExp < 1)
		gExp = 1;

	// 1회 부활되면 1분 이상 상대방에게 부활 경험치 제공 안함
	target.setCookie("RESR", "ALR", 60 + LV);
	trigger.addExp(gExp);
	return true;
}


quest
WriteLoveConfession()
{
	controller.setAttribute("LOVE_MESSAGE", Util.filterCurse(trigger.getQuestArgument()) + " </n></n><c9></r>[From " + trigger.getName() + "]");
	trigger.message(TEXT_LOVE_CONFESSION_WRITE, MSG_TYPE__SYSTEM);
}

quest
LOVE_INPUT()					// 고백 쓰기
{
	trigger.sendDescribeQuestMessage(TEXT_LOVE_CONFESSION_INPUT, "WriteLoveConfession", controller);
}

quest
LOVE_CANCEL()					// 고백 쓰기 거부
{
	trigger.message(TEXT_LOVE_CONFESSION_FAIL, MSG_TYPE__SYSTEM);
}




// EACH item
quest
qUseItem1000013()				// 레드 허브
{
/*
	Util.log("- in");

	controller.cast("0", trigger);
*/

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 30 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 30)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 30)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 30);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000014()				// 딸기 시럽
{
/*
	Util.log("- in2");
	controller.cast("1", trigger);
*/

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 60 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 60)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 60)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 60);
	}
	
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000015()				// 딸기 주스
{
/*
	Util.log("- in3");
	controller.cast("2", trigger);
*/

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 120)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 120)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000016()				// 힐링 포션 (소)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 200 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 200)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 200)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 200);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000017()				// 힐링 포션 (중)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 350 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 350)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 350)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 350);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000018()				// 힐링 포션 (대)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// hp 500 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 500)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 500)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 500);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000019()				// 라이프 포션 (소)
{
	integer toUp;
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max hp 의 10% 만큼
	toUp = trigger.getMaxHP() * 10 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, toUp)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, toUp)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, toUp);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000020()				// 라이프 포션 (중)
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max hp 의 30% 만큼
	toUp = trigger.getMaxHP() * 30 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, toUp)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, toUp)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, toUp);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000021()				// 라이프 포션 (대)
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max hp 의 50% 만큼
	toUp = trigger.getMaxHP() * 50 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, toUp)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, toUp)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, toUp);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000022()				// 생명의 조각
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_HP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_HP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max hp 의 100% 만큼
	toUp = trigger.getMaxHP();
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, toUp)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, toUp)) return;
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest						// 그린 허브
qUseItem1000024()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 10 회복
	if (!HardCode.itemUpMP(trigger, 10)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 10);

	// send using effect
	controller.effectBy(trigger);
}

quest						// 키위 시럽
qUseItem1000025()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 20 회복
	if (!HardCode.itemUpMP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	// send using effect
	controller.effectBy(trigger);
}

quest						// 키위 주스
qUseItem1000026()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 30 회복
	if (!HardCode.itemUpMP(trigger, 30)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 30);

	// send using effect
	controller.effectBy(trigger);
}

quest						// 마나 포션 (소)
qUseItem1000027()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 60 회복
	if (!HardCode.itemUpMP(trigger, 60)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 60);

	// send using effect
	controller.effectBy(trigger);
}

quest						// 마나 포션 (중)
qUseItem1000028()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 90 회복
	if (!HardCode.itemUpMP(trigger, 90)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 90);

	// send using effect
	controller.effectBy(trigger);
}

quest						// 마나 포션 (대)
qUseItem1000029()
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// mp 120 회복
	if (!HardCode.itemUpMP(trigger, 120)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 120);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000030()				// 에너지 포션 (소)
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max mp 의 10% 만큼
	toUp = trigger.getMaxMP() * 10 / 100;
	if (!HardCode.itemUpMP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, toUp);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000031()				// 에너지 포션 (중)
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max mp 의 30% 만큼
	toUp = trigger.getMaxMP() * 30 / 100;
	if (!HardCode.itemUpMP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, toUp);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000032()				// 에너지 포션 (대)
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max mp 의 50% 만큼
	toUp = trigger.getMaxMP() * 50 / 100;
	if (!HardCode.itemUpMP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, toUp);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000033()				// 마나의 결정
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_MP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_MP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// max mp 의 100% 만큼
	toUp = trigger.getMaxMP();
	if (!HardCode.itemUpMP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1000035()				// 바이올렛 허브
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
	    controller.decreaseNumber(1);

	toUp = 1;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	// if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//	if (!ItemBalloonUpHP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 7);
	controller.effectBy(target);
}

quest
qUseItem1000036()				// 리바이브 파우더
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
    	controller.decreaseNumber(1);

	toUp = 10;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	// if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//	if (!ItemBalloonUpHP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 6);
	controller.effectBy(target);
}

quest
qUseItem1000037()				// 리바이브 드링크
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
    	controller.decreaseNumber(1);

	toUp = 50;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	// if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//	if (!ItemBalloonUpHP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 5);
	controller.effectBy(target);
}

quest
qUseItem1000038()				// 리서렉션 포션(소)
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
	    controller.decreaseNumber(1);

	toUp = target.getMaxHP() * 10 / 100;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	//if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//if (!ItemBalloonUpHP(target, toUp)) return;

	toUp = target.getMaxMP() * 10 / 100;
	HardCode.itemUpMP(target, toUp);
	// 노란 풍선 회복 처리. 임시
	//if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")
	//if (!ItemBalloonUpMP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 4);
	controller.effectBy(target);
}

quest
qUseItem1000039()				// 리서렉션 포션(중)
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
    	controller.decreaseNumber(1);

	toUp = target.getMaxHP() * 30 / 100;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	//if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//if (!ItemBalloonUpHP(target, toUp)) return;

	toUp = target.getMaxMP() * 30 / 100;
	HardCode.itemUpMP(target, toUp);
	// 노란 풍선 회복 처리. 임시
	// if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")
	//if (!ItemBalloonUpMP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 3);
	controller.effectBy(target);
}

quest
qUseItem1000040()				// 리서렉션 포션(대)
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	toUp = target.getMaxHP() * 50 / 100;
	HardCode.itemUpHP(target, toUp);
	// 녹색 풍선 회복 처리. 임시
	//if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004467")
	//	if (!ItemBalloonUpHP(target, toUp)) return;

	toUp = target.getMaxMP() * 50 / 100;
	HardCode.itemUpMP(target, toUp);
	// 노란 풍선 회복 처리. 임시
	//if (target.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")
	//	if (!ItemBalloonUpMP(target, toUp)) return;

	target.resurrect(false);
	ItemGetEXP(target, 2);
	controller.effectBy(target);
}

quest
qUseItem1000041()				// 엘릭서
{
	object target;
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;
	if (!ResurrectItemCanBeUsed(target)) return;

	if (controller.canBeExhausted())
	    controller.decreaseNumber(1);

	toUp = target.getMaxHP();
	HardCode.itemUpHP(target, toUp);
	toUp = target.getMaxMP();
	HardCode.itemUpMP(target, toUp);
	toUp = target.getMaxSP();
	ItemUpSP(target, toUp);

	target.resurrect(false);
	ItemGetEXP(target, 1);
	controller.effectBy(target);
}

quest
qUseItem1000149()				// 윙
{
	object loc;

	if(!NormalItemCanBeUsed()) return;

	// discard if world is event world
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

//	if (!trigger.getWorld().canTeleport()) {
	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;
	// if (controller.canBeExhausted())
	    // controller.decreaseNumber(1);

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	controller.sweepNumbered(1);
/*
	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		loc = Location.create();
		loc.set(667,255,253);

		trigger.teleportTo(loc);
		return;
	}
*/
	// send using effect
	// controller.effectBy(trigger);

	trigger.teleportTo(trigger.lastVisitedVillageLoc());
}


quest
qUseItem1002968()				// 클라드 워프 카드
{
	object loc;
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	// controller.effectBy(trigger);

	loc = Location.create();
	loc.set(1, 300, 300);

	trigger.teleportTo(loc);
}

quest
qUseItem1002969()				// 나르비크 워프 카드
{
	object loc;
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	// controller.effectBy(trigger);

	loc = Location.create();
	loc.set(30, 290, 290);

	trigger.teleportTo(loc);
}

quest
qUseItem1002970()				// 라이디아 워프 카드
{
	object loc;
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	// controller.effectBy(trigger);

	loc = Location.create();
	loc.set(82, 160, 180);

	trigger.teleportTo(loc);
}

quest
qUseItem1002971()				// 카울 워프 카드
{
	object loc;
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	// controller.effectBy(trigger);

	loc = Location.create();
	loc.set(15, 200, 200);

	trigger.teleportTo(loc);
}

quest
qUseItem1003884()				// 깃발뺏기 대기실 워프 카드
{
	object loc;
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	// controller.effectBy(trigger);

	loc = Location.create();
	loc.set(446, 104, 100);

	trigger.teleportTo(loc);
}

quest
qUseItem1000150()				// 신조의 깃털
{
	// discard if world is event world
	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	// if (!trigger.getWorld().canTeleport()) {
	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;
/*
//	trigger.sendSelectQuestMessage("신조의 깃털을 사용하시겠습니까?확인하실 경우 무조건 사용됩니다", "qUseItem1000150_1", "null", controller);
//	if (controller.canBeExhausted())
		// controller.decreaseNumber(1);

	// send using effect
	// controller.effectBy(trigger);

	controller.sweepNumbered(1);

//	trigger.sendWarpPoint();
	trigger.sendWarpPoint(1);
*/

	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().allowedWarpGroup() == 0)
	{
		controller.sweepNumbered(1);
//		trigger.sendWarpPoint();
		trigger.sendWarpPoint(1);
	}
	else if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}
	return;
}


quest
qUseItem1000150_1()				// 신조의 깃털 사용 처리
{
	if (trigger.getWorld().allowedWarpGroup() == 0)
	{
		controller.sweepNumbered(1);
//		trigger.sendWarpPoint();
		trigger.sendWarpPoint(1);
	}
	else if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}
	return;
}

quest
qUseItem1000002()				// 혼의조각
{
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000076()				// 수선도구
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 5);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1); // setTEIP and setMaxTEIP in Item class have already included update func

		trigger.message(TEXT_USABLEITEM_ENDURANCE1_5 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000077()				// 땜납키트
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 10);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1); // setTEIP and setMaxTEIP in Item class have already included update func

		trigger.message(TEXT_USABLEITEM_ENDURANCE1_10 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000078()				// 백랍키트
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 20);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1); // setTEIP and setMaxTEIP in Item class have already included update func

		trigger.message(TEXT_USABLEITEM_ENDURANCE1_20 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000079()				// 멘딩키트 (소)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -2)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 30);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 2); // setTEIP and setMaxTEIP in Item class have already included update func

		trigger.message(TEXT_USABLEITEM_ENDURANCE1_30 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000080()				// 멘딩키트(중)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -2)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 40);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 2); // setTEIP and setMaxTEIP in Item class have already included update func

		trigger.message(TEXT_USABLEITEM_ENDURANCE1_40 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000081()				// 패치키트(소)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 10);

		trigger.message(TEXT_USABLEITEM_ENDURANCE10 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
		controller.decreaseNumber(1);
	}
}

quest
qUseItem1000082()				// 패치키트(중)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 20);

		trigger.message(TEXT_USABLEITEM_ENDURANCE20 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000083()				// 리페어키트(소)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 30);

		trigger.message(TEXT_USABLEITEM_ENDURANCE30 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000084()				// 리페어키트(중)
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getTEIP(TEIP__ENDURANCE) + 50);

		trigger.message(TEXT_USABLEITEM_ENDURANCE50 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000085()				// 리스토어세트
{
	object item;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!item.getCanBeRepaired()) return;

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkMinMax(item, TEIP__ENDURANCE)) return;

		item.setTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE));

		trigger.message(TEXT_USABLEITEM_ENDURANCE100 , MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000086()				// 내구성스프레이(소) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, 2)) return;

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) < item.getMaxTEIP(TEIP__ENDURANCE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__ENDURANCE);
			if (randomValue < 1) randomValue = 0;
			item.setMaxTEIP(TEIP__ENDURANCE, item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT));
		}
		else item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func

		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_MAX_ENDURANCE + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000087()				// 내구성스프레이(중) - 수정
{
	object item;
	integer randomValue;
	integer randcnt;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, 3)) return;

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) < item.getMaxTEIP(TEIP__ENDURANCE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__ENDURANCE);
			if (randomValue < 1) randomValue = 0;
			item.setMaxTEIP(TEIP__ENDURANCE, item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT));
		}
		else item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func

		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_MAX_ENDURANCE + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);
		randcnt = Util.random(0, 99);

		if (randcnt > 50) ;
		else if (!checkMinOfMax(item, TEIP__FIRMNESS, -randomValue)) ;
		else {
			item.setTEIP(TEIP__FIRMNESS, item.getTEIP(TEIP__FIRMNESS) - randomValue);
			trigger.message(TEXT_USABLEITEM_FIRMNESS + randomValue + TEXT_USABLEITEM_MESSAGE1_1 , MSG_TYPE__SYSTEM);
		}

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000088()				// 내구성스프레이(대) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, 4)) return;

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) < item.getMaxTEIP(TEIP__ENDURANCE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__ENDURANCE);
			if (randomValue < 1) randomValue = 0;
			item.setMaxTEIP(TEIP__ENDURANCE, item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT));
		}
		else item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func

		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_MAX_ENDURANCE+ randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__ENDURANCE)==item.getLowerOrUpperTEIP(TEIP__ENDURANCE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000089()				// 샤프너
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__STAB)) return;

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__STAB) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__STAB);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__STAB, item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__STAB, item.getTEIP(TEIP__STAB) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_STAB + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000090()				// 키닝세트 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__STAB)) return;

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__STAB) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__STAB);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__STAB, item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__STAB, item.getTEIP(TEIP__STAB) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_STAB + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		checkCrack(item, randomValue);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000091()				// 제련키트 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__STAB)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__STAB) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__STAB);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__STAB, item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__STAB, item.getTEIP(TEIP__STAB) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_STAB + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP, MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000092()				// 스트렙
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__HACK)) return;

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__HACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__HACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__HACK, item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__HACK, item.getTEIP(TEIP__HACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_HACK + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__STAB)==item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000093()				// 숫돌 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__HACK)) return;

		if(item.getTEIP(TEIP__HACK)==item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__HACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__HACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__HACK, item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__HACK, item.getTEIP(TEIP__HACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_HACK + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__HACK)==item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		checkCrack(item, randomValue);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000094()				// 그라인더 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__HACK)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__HACK)==item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__HACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__HACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__HACK, item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__HACK, item.getTEIP(TEIP__HACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_HACK + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__HACK)==item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}


quest
qUseItem1000095()				// 탄성로션(소)
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
		// 유저상점 올라간 아이템인지 체크
		if (item.isLocked()) {
			trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
			return;
		}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__DEFENSE)) return;

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__DEFENSE, item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__DEFENSE, item.getTEIP(TEIP__DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_DEF + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000096()				// 탄성로션(중) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__DEFENSE)) return;

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__DEFENSE, item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__DEFENSE, item.getTEIP(TEIP__DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_DEF + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		checkCrack(item, randomValue);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000097()				// 탄성로션(대) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__DEFENSE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__DEFENSE, item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__DEFENSE, item.getTEIP(TEIP__DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_DEF + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__DEFENSE)==item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000098()				// 마력 강화제 (소)
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_ATTACK)) return;

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_ATTACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_ATTACK, item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_ATTACK, item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_INT + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000099()				// 마력 강화제 (중) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_ATTACK)) return;

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_ATTACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_ATTACK, item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_ATTACK, item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_INT + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		checkCrack(item, randomValue);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000100()				 // 마력 강화제 (대) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_ATTACK)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_ATTACK);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_ATTACK, item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_ATTACK, item.getTEIP(TEIP__MAGIC_ATTACK) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_INT + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_ATTACK)==item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000101()				// 요정의가호
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_DEFENSE)) return;

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_DEFENSE, item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_DEFENSE, item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_MR + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000102()				// 천사의가호 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_DEFENSE)) return;

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_DEFENSE, item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_DEFENSE, item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_MR + randomValue +  TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		checkCrack(item, randomValue);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000103()				// 여신의가호 - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__MAGIC_DEFENSE)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__MAGIC_DEFENSE);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__MAGIC_DEFENSE, item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__MAGIC_DEFENSE, item.getTEIP(TEIP__MAGIC_DEFENSE) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_ATTACK_MR + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__MAGIC_DEFENSE)==item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}

quest
qUseItem1000104()				// 경화제(소)
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);

	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__FIRMNESS)) return;

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(0, 2);
		if (item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__FIRMNESS) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__FIRMNESS);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__FIRMNESS, item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__FIRMNESS, item.getTEIP(TEIP__FIRMNESS) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_FIRMNESS_UP + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
		    controller.decreaseNumber(1);
	}
}

quest
qUseItem1000105()				// 경화제(중) - 수정
{
	object item;
	integer randomValue;
	integer randcnt;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);

	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__FIRMNESS)) return;

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		randomValue = Util.random(1, 3);
		if (item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__FIRMNESS) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__FIRMNESS);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__FIRMNESS, item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__FIRMNESS, item.getTEIP(TEIP__FIRMNESS) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);

		trigger.message(TEXT_USABLEITEM_FIRMNESS_UP + randomValue + TEXT_USABLEITEM_MANUFACTURE , MSG_TYPE__SYSTEM);

		randcnt = Util.random(0, 99);
		if (randcnt > 50) ;
		else if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -randomValue)) ;

		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - randomValue);
		trigger.message(TEXT_USABLEITEM_MAX_ENDURANCE2 + randomValue + TEXT_USABLEITEM_MESSAGE1_1 , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
		    controller.decreaseNumber(1);
	}
}

quest
qUseItem1000106()				// 경화제(대) - 수정
{
	object item;
	integer randomValue;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);

	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (!checkManufactureCnt(item)) return;
		if (!checkMinMax(item, TEIP__FIRMNESS)) return;
		if (!checkMinMaxOfMax(item, TEIP__ENDURANCE, -1)) return;

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_UPGRADE_ITEM, MSG_TYPE__SYSTEM);
			return;
		}

		if (!checkBreak(item)) return;

		randomValue = Util.random(2, 4);
		if (item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) < item.getTEIP(TEIP__FIRMNESS) + randomValue)	//결과값이 최대치보다 높을경우 최대치로 보정
		{
			randomValue = item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT) - item.getMaxTEIP(TEIP__FIRMNESS);
			if (randomValue < 1) randomValue = 0;
			item.setTEIP(TEIP__FIRMNESS, item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT));
		}
		else item.setTEIP(TEIP__FIRMNESS, item.getTEIP(TEIP__FIRMNESS) + randomValue); // setTEIP and setMaxTEIP in Item class have already included update func
		item.setManufactureCnt(item.getManufactureCnt() + 1);
		item.setMaxTEIP(TEIP__ENDURANCE, item.getMaxTEIP(TEIP__ENDURANCE) - 1);

		trigger.message(TEXT_USABLEITEM_FIRMNESS_UP + randomValue + TEXT_USABLEITEM_MANUFACTURE_UP , MSG_TYPE__SYSTEM);

		if(item.getTEIP(TEIP__FIRMNESS)==item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__MAX_LIMIT))
			trigger.message(TEXT_USABLEITEM_CANT_UPGRADE_OVER_LIMIT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
		    controller.decreaseNumber(1);
	}
}


quest
qUseItem1001808()				// 인크립트 스크롤
{
	object item;
	integer prob = 10;

	if (!NormalItemCanBeUsed()) return;

	item = controller.getObjectArgumentAt(0);

	// 유료아이템에 사용불가
	if (item.isCashItem())
	{
		trigger.message(TEXT_CASHITEM_NOT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	// 유저상점 올라간 아이템인지 체크
	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		if (item.getTEIP(TEIP__ENDURANCE) <= 1) {
			trigger.message(TEXT_USABLEITEM_CANT_ENDURANCE, MSG_TYPE__SYSTEM);
			return;
		} else if (item.getManufactureCnt() <= 1) {
			trigger.message(TEXT_USABLEITEM_CANT_DECOUNT, MSG_TYPE__SYSTEM);
			return;
		}
		if (!checkDeCount(item, prob)) return;

		item.setManufactureCnt(item.getManufactureCnt() - 1);

		trigger.message(TEXT_USABLEITEM_DECOUNT, MSG_TYPE__SYSTEM);

		// send using effect
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
	    	controller.decreaseNumber(1);
	}
}


quest
qUseItem1002008()				// 신비한 정령석 : 보상용 아이템
{
	object item, clubObject;
	integer nowTime;
	integer bType;

	if (!NormalItemCanBeUsed()) return;

	// 기간 체크. 기간 체크해서 기간 경과했을 경우 바로 소모시켜 버린다.
	nowTime = Util.getTick();

	clubObject = trigger.getGuild(GD_TYPE_NORMAL);

	// 운영팀 요청에 따라 아이템 사용시 운영자가 사용하면 사용일자에 관계없이 사용 가능하도록 수정.
	bType = trigger.getBuilderType();

	if (bType != 1 && bType != 2 && bType != 3 && bType != 5) {
/*
   //vahma - disable expiration

		// 2005년 10월17일 부터 10월24일 동안에만 퀘스트 수행
		if (Util.getYear(nowTime) != 2005 && Util.getMonth(nowTime) != 10) {
			trigger.message(" ?????f??q ??_??", MSG_TYPE__SYSTEM);
			if (controller.canBeExhausted())
			    controller.decreaseNumber(1);
			return;
		}
		else if (Util.getDay(nowTime) > 24)
		{
			trigger.message(" ?????f??q ??_??", MSG_TYPE__SYSTEM);
			if (controller.canBeExhausted())
			    controller.decreaseNumber(1);
			return;
		}
*/
		if(clubObject == null) {
			trigger.message("Nu(2?!!!B", MSG_TYPE__SYSTEM);	// vahma - translate here
/*
   //vahma - disable expiration
			// 2005년 10월17일 부터 10월24일 동안에만 퀘스트 수행
			if (Util.getYear(nowTime) != 2005 && Util.getMonth(nowTime) != 10) {
				if (controller.canBeExhausted())
				    controller.decreaseNumber(1);
				return;
			}
			else if (Util.getDay(nowTime) > 24)
			{
				if (controller.canBeExhausted())
				    controller.decreaseNumber(1);
				return;
			}
*/
			return;
		}
		if (clubObject.getMemberType(trigger.getName()) != GM_TYPE_MASTER &&
			clubObject.getMemberType(trigger.getName()) != GM_TYPE_SUBMASTER) {
			trigger.message("Nu}X^[?Tu}X^[-g B", MSG_TYPE__SYSTEM);	// vahma - translate here
/*
   //vahma - disable expiration
			// 2005년 10월17일 부터 10월24일 동안에만 퀘스트 수행
			if (Util.getYear(nowTime) != 2005 && Util.getMonth(nowTime) != 10) {
				if (controller.canBeExhausted())
				    controller.decreaseNumber(1);
				return;
			}
			else if (Util.getDay(nowTime) > 24)
			{
				if (controller.canBeExhausted())
				    controller.decreaseNumber(1);
				return;
			}
*/
			return;
		}
	}

	item = controller.getObjectArgumentAt(0);

	// 유료아이템에 사용불가
	if (item.isCashItem())
	{
		trigger.message(TEXT_CASHITEM_NOT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isMonster() && item && item.isEquippable()) {
		// if (!checkMinMax(item, TEIP__HACK)) return;

		if (item.getTEIP(TEIP__FIRMNESS) <= item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__UPPER))
		{
			item.setTEIP(TEIP__FIRMNESS, item.getLowerOrUpperTEIP(TEIP__FIRMNESS, TEIP__UPPER));
		}
		// 이미 올리는 아이템 같은 걸 사용했을 경우가 else가 된다. 이 경우엔 깎진 않으므로 생략한다.
		if (item.getTEIP(TEIP__STAB) <= item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__UPPER))
		{
			item.setTEIP(TEIP__STAB, item.getLowerOrUpperTEIP(TEIP__STAB, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__HACK) <= item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__UPPER))
		{
			item.setTEIP(TEIP__HACK, item.getLowerOrUpperTEIP(TEIP__HACK, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__DEFENSE) <= item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__UPPER))
		{
			item.setTEIP(TEIP__DEFENSE, item.getLowerOrUpperTEIP(TEIP__DEFENSE, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__MAGIC_ATTACK) <= item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__UPPER))
		{
			item.setTEIP(TEIP__MAGIC_ATTACK, item.getLowerOrUpperTEIP(TEIP__MAGIC_ATTACK, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__MAGIC_DEFENSE) <= item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__UPPER))
		{
			item.setTEIP(TEIP__MAGIC_DEFENSE, item.getLowerOrUpperTEIP(TEIP__MAGIC_DEFENSE, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__HIT_ACCURACY) <= item.getLowerOrUpperTEIP(TEIP__HIT_ACCURACY, TEIP__UPPER))
		{
			item.setTEIP(TEIP__HIT_ACCURACY, item.getLowerOrUpperTEIP(TEIP__HIT_ACCURACY, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__CRITICAL) <= item.getLowerOrUpperTEIP(TEIP__CRITICAL, TEIP__UPPER))
		{
			item.setTEIP(TEIP__CRITICAL, item.getLowerOrUpperTEIP(TEIP__CRITICAL, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__AVOIDANCE) <= item.getLowerOrUpperTEIP(TEIP__AVOIDANCE, TEIP__UPPER))
		{
			item.setTEIP(TEIP__AVOIDANCE, item.getLowerOrUpperTEIP(TEIP__AVOIDANCE, TEIP__UPPER));
		}
		if (item.getTEIP(TEIP__AGILITY) <= item.getLowerOrUpperTEIP(TEIP__AGILITY, TEIP__UPPER))
		{
			item.setTEIP(TEIP__AGILITY, item.getLowerOrUpperTEIP(TEIP__AGILITY, TEIP__UPPER));
		}

		trigger.message(TEXT_USABLEITEM_ATTACK_ALL, MSG_TYPE__SYSTEM);
		controller.effectBy(trigger);

		if (controller.canBeExhausted())
		    controller.decreaseNumber(1);
    }
}


quest
qUseItem1000120()				// 이리의 어금니
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgStab(trigger.getOrgStab() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_STAB_UP1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000121()				// 늑대의 어금니
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgStab(trigger.getOrgStab() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_STAB_UP2, MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000122()				// 맹수의 어금니
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgStab(trigger.getOrgStab() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_STAB_UP3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000123()				// 힘의 치즈 (조각)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgHack(trigger.getOrgHack() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_HACK_UP1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000124()				// 힘의 치즈
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgHack(trigger.getOrgHack() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_HACK_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000125()				// 힘의 치즈 (덩어리)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgHack(trigger.getOrgHack() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_HACK_UP3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000126()				// 인어의 비늘
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDefence(trigger.getOrgDefence() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEFENSE_UP1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000127()				// 인어의 눈물
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDefence(trigger.getOrgDefence() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEFENSE_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000128()				// 인어의 가호
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDefence(trigger.getOrgDefence() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEFENSE_UP3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000129()				// 환상초의 잎
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgInt(trigger.getOrgInt() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_ATTACK1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000130()				// 환상초의 꽃
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgInt(trigger.getOrgInt() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_ATTACK2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000131()				// 환상초
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgInt(trigger.getOrgInt() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_ATTACK3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000132()				// 환영초의 잎
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgMagicResist(trigger.getOrgMagicResist() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_DEFENSE1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000133()				// 환영초의 꽃
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgMagicResist(trigger.getOrgMagicResist() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_DEFENSE2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000134()				// 환영초
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgMagicResist(trigger.getOrgMagicResist() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_MAGIC_DEFENSE3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000135()				// 쾌속의 치즈 (조각)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDex(trigger.getOrgDex() + 1);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEX_UP1 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000136()				// 쾌속의 치즈
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDex(trigger.getOrgDex() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEX_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000137()				// 쾌속의 치즈 (덩어리)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgDex(trigger.getOrgDex() + 3);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEX_UP3 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000138()				// 근성의 메추리알
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setMaxInvenWeight(trigger.getMaxInvenWeight() + 10);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_INVEN_MAX10 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000139()				// 근성의 달걀
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setMaxInvenWeight(trigger.getMaxInvenWeight() + 20);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_INVEN_MAX20 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000140()				// 근성의 오리알
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setMaxInvenWeight(trigger.getMaxInvenWeight() + 30);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_INVEN_MAX30 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000141()				// 고양이의 눈
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgMaxHP(trigger.getOrgMaxHP() + 50);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_HP_MAX50 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000142()				// 자연의 결정
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.setOrgMaxMP(trigger.getOrgMaxMP() + 10);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_HP_MAX10 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItemqUseItem1000143()				// 성장촉진제 (미구현)
{
}

quest
qUseItem1000144()				// 회춘제
{
	integer UserLV;
	if (!NormalItemCanBeUsed()) return;

	UserLV = trigger.getLevel() -1;

	if (UserLV < 2) {
		trigger.message(TEXT_USABLEITEM_LOW_LEVEL1 , MSG_TYPE__SYSTEM);
		return;
	} else {
		trigger.setLevel(UserLV);
		trigger.updateAttr();
	}

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.message(TEXT_USABLEITEM_LOW_LEVEL2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000145()				// 체험 스크롤
{
// ************ 보상을 위해 임시로 기능 추가 시작 ****************
	integer chkLV;
	integer repayEXP;
	integer tickTime;
// ************ 보상을 위해 임시로 기능 추가 종료 ****************

	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

// ************ 보상을 위해 임시로 기능 추가 시작 ****************
	// 사용가능 시점 체크
	tickTime = Util.getTick();

	if (Util.getYear(tickTime) != 2003) {
		trigger.addExp(500);
		trigger.updateAttr();

        trigger.message("o1l?0??! B", MSG_TYPE__SYSTEM);
		return;
	} else if (Util.getMonth(tickTime) != 10) {
		trigger.addExp(500);
		trigger.updateAttr();

        trigger.message("o1l?0??! B", MSG_TYPE__SYSTEM);
		return;
	} else if (Util.getDay(tickTime) > 28) {
		trigger.addExp(500);
		trigger.updateAttr();

        trigger.message("o1l?0??! B", MSG_TYPE__SYSTEM);
		return;
	}

	chkLV = trigger.getLevel();

	if (chkLV < 1) {
        trigger.message("g!!!x! B", MSG_TYPE__SYSTEM);
		return;
	} else if (chkLV < 10) {
		repayEXP = 5000;
	} else if (chkLV < 21) {
		repayEXP = 20000;
	} else if (chkLV < 33) {
		repayEXP = 40000;
	} else if (chkLV < 50) {
		repayEXP = 60000;
	} else if (chkLV < 60) {
		repayEXP = 80000;
	} else if (chkLV < 68) {
		repayEXP = 100000;
	} else if (chkLV < 75) {
		repayEXP = 120000;
	} else if (chkLV < 81) {
		repayEXP = 140000;
	} else if (chkLV < 87) {
		repayEXP = 160000;
	} else if (chkLV < 94) {
		repayEXP = 180000;
	} else if (chkLV < 110) {
		repayEXP = 190000;
	} else if (chkLV < 170) {
		repayEXP = 200000;
	} else if (chkLV < 210) {
		repayEXP = 210000;
	} else {
        trigger.message("gp!?!!!x! B", MSG_TYPE__SYSTEM);
		return;
	}

	trigger.addExp(repayEXP);
	trigger.updateAttr();

    trigger.message("?x [" + chkLV + "]", MSG_TYPE__SYSTEM);
    trigger.message("5?4?!o1l[" + repayEXP + "] ??! B", MSG_TYPE__SYSTEM);

// ************ 보상을 위해 임시로 기능 추가 종료 ****************


// ************ 보상을 위해 임시로 기능 수정 ****************
/*
	trigger.addExp(500);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_EXP_UP , MSG_TYPE__SYSTEM);
*/
// ************ 보상을 위해 임시로 기능 수정 ****************

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1000146()				// 수수께끼 상자
{
	integer rval, iBirth;
	integer wNum;
	integer tickTime;
	integer mx, my;
	integer rCount;

	string userName, timestamp;
	string time_Info, world_Info, Item_Info;
	object rank;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
    		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 초보자 던전에서 사용 불가능
	if (wNum == 422 || wNum == 423 || wNum == 424)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
    		return;
    	}

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
        	return;
    	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
        	return;
    	}

	// 길이 좁은 연결통 맵
	if(wNum == 91 || wNum == 92 || wNum == 48 || wNum == 51 || wNum == 114 || wNum == 124)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
        	return;
    	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
    	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 6)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
    	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 10000);

	iBirth = trigger.getBirthTime();

	// 주말 보정 기능
	if (Util.getWday(tickTime) == 0)	{
		if (rval > 4400)		rval = rval - 200;
	} else if (Util.getWday(tickTime) == 1)	{
		if (rval > 4400)		rval = rval - 100;
	}

	// 2100221	3%
	if(rval >= 9700)
	{
		trigger.getWorld().genMonster("2100221", 1, "twMechanic.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100221 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100026	3%
	else if(rval >= 9400)
	{
		trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100026 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100119	5%
	else if(rval >= 8900)
	{
		trigger.getWorld().genMonster("2100119", 1, "twAzidahaka_J.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100119 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100123	5%
	else if(rval >= 8400)
	{
		trigger.getWorld().genMonster("2100123", 1, "twPumkinRot.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100123 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100193	5%
	else if(rval >= 7900)
	{
		trigger.getWorld().genMonster("2100193", 1, "twPoseidon.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100193 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100194	5%
	else if(rval >= 7400)
	{
		trigger.getWorld().genMonster("2100194", 1, "twDduKing.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100194 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100195	5%
	else if(rval >= 6900)
	{
		trigger.getWorld().genMonster("2100195", 1, "twDduQueen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100195 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100338	8%
	else if(rval >= 6100)
	{
		trigger.getWorld().genMonster("2100338", 5, "twDuckWarriorF.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100338 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100339	8%
	else if(rval >= 5300)
	{
		trigger.getWorld().genMonster("2100339", 5, "twPumkin_Dandy.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100339 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 2100359	8%
	else if(rval >= 4500)
	{
		trigger.getWorld().genMonster("2100359", 5, "twDGeneral.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100359 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// ***********************************************************************************************
	// 여기서부터 아이템~
	// ***********************************************************************************************
	// 1000126	1%
	else if(rval >= 4400)
	{
		rank = Rank.select("NEWBIE_ITEM_1");
		rCount = rank.getCount();

		if(rCount < 5)
		{
			timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
			Util.log("### 200408 Event Item UserName[" + userName + "] getItem [1000126] #" + rCount + "/5 On time = [" + timestamp + "] ###");
			rank.add(userName, 0, 0, 0, iBirth, "null");
			trigger.addItemClassNamed("1000126", 1);
			Item_Info = "From Present Box : +ITEM [ 1000123 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		} else {
			trigger.addItemClassNamed("1000022", 1);
			Item_Info = "From Present Box : +ITEM [ 1000022 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
	}
	// 1000138	1%
	else if(rval >= 4300)
	{
		rank = Rank.select("NEWBIE_ITEM_2");
		rCount = rank.getCount();

		if(rCount < 8)
		{
			timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
			Util.log("### 200408 Event Item UserName[" + userName + "] getItem [1000138] #" + rCount + "/8 On time = [" + timestamp + "] ###");
			rank.add(userName, 0, 0, 0, iBirth, "null");
			trigger.addItemClassNamed("1000138", 1);
			Item_Info = "From Present Box : +ITEM [ 1000138 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		} else {
			trigger.addItemClassNamed("1000033", 1);
			Item_Info = "From Present Box : +ITEM [ 1000033 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
	}
	// 1000141	1%
	else if(rval >= 4200)
	{
		rank = Rank.select("NEWBIE_ITEM_3");
		rCount = rank.getCount();

		if(rCount < 5)
		{
			timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
			Util.log("### 200408 Event Item UserName[" + userName + "] getItem [1000141] #" + rCount + "/5 On time = [" + timestamp + "] ###");
			rank.add(userName, 0, 0, 0, iBirth, "null");
			trigger.addItemClassNamed("1000141", 1);
			Item_Info = "From Present Box : +ITEM [ 1000141 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		} else {
			trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From Present Box : MONSTER [ 2100026 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
	}
	// 1000142	1%
	else if(rval >= 4100)
	{
		rank = Rank.select("NEWBIE_ITEM_4");
		rCount = rank.getCount();

		if(rCount < 5)
		{
			timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
			Util.log("### 200408 Event Item UserName[" + userName + "] getItem [1000142] #" + rCount + "/5 On time = [" + timestamp + "] ###");
			rank.add(userName, 0, 0, 0, iBirth, "null");
			trigger.addItemClassNamed("1000142", 1);
			Item_Info = "From Present Box : +ITEM [ 1000142 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		} else {
			trigger.getWorld().genMonster("2100359", 5, "twDGeneral.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From Present Box : MONSTER [ 2100359 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
	}
	// 1001808	1%
	else if(rval >= 4000)
	{
		trigger.addItemClassNamed("1001808", 1);
		Item_Info = "From Present Box : +ITEM [ 1001808 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
	}
	// 1001810	5%
	else if(rval >= 3500)
	{
		trigger.addItemClassNamed("1001810", 1);
		Item_Info = "From Present Box : +ITEM [ 1001810 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1003047	5%
	else if(rval >= 3000)
	{
		trigger.addItemClassNamed("1003047", 1);
		Item_Info = "From Present Box : +ITEM [ 1003047 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1000022	5%
	else if(rval >= 2500)
	{
		trigger.addItemClassNamed("1000022", 1);
		Item_Info = "From Present Box : +ITEM [ 1000022 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1000033	5%
	else if(rval >= 2000)
	{
		trigger.addItemClassNamed("1000033", 1);
		Item_Info = "From Present Box : +ITEM [ 1000033 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1001809	20%
	else if(rval)
	{
		trigger.addItemClassNamed("1001809", 1);
		Item_Info = "From Present Box : +ITEM [ 1001809 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}


quest
qUseItem1000151()     //투척 단검
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1000152()     //돌맹이
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1000153()     //투창
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1000154()     //표창
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1000155()      //수리검
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1000156()			//폭죽
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001002()				// 스테미너 포션 (소)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_SP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_SP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// sp 250 회복
	if (!ItemUpSP(trigger, 250)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001003()				// 스테미너 포션 (중)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_SP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_SP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// sp 500 회복
	if (!ItemUpSP(trigger, 500)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001004()				// 스테미너 포션 (대)
{
	if (!NormalItemCanBeUsed()) return;

/*	if (trigger.isState(CREATURE_STATE__LIMIT_RECOVER_SP)) {
		trigger.message(CANT_USE_FOR_LIMIT_RECOVER_SP_STATE, MSG_TYPE__SYSTEM);
		return;
	}*/

	// sp 1000 회복
	if (!ItemUpSP(trigger, 1000)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000055()				// 죽음의 호흡 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!target.getWorld().canFight() && target.isUser())
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD , MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000201",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_MESSAGE3, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_MESSAGE_FAIL, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000056()				// 좀비파우더 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!target.getWorld().canFight() && target.isUser())
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD , MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000201",10)==true)
		trigger.message(TEXT_USABLEITEM_ZOMBIEFOUDER, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000057()				// 잉크 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000199",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_INK2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_INK1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000058()				// 먹물 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000199",10)==true)
		trigger.message(TEXT_USABLEITEM_INK2_1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000059()				// 독액 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000198",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_POISON1_2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_POISON1_1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000060()				// 독약 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000198",10)==true)
		trigger.message(TEXT_USABLEITEM_POISON2, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000061()				// 밀짚인형 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000190",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_STRAWDOLL2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_STRAWDOLL1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000062()				// 부두인형 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000190",10)==true)
		trigger.message(TEXT_USABLEITEM_DOLL2, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000063()				// 환각제 (미구현)
{
	
}

quest
qUseItem1000064()				// LSD (미구현)
{
	
}

quest
qUseItem1000065()				// 아이스 바 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000195",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_ICE2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_ICE1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000066()				// 빙결 분무기 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000195",10)==true)
		trigger.message(TEXT_USABLEITEM_FREEZING, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000067()				// 석탄 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000194",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_COAL2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_COAL1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000068()				// 석유 분무기 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000194",10)==true)
		trigger.message(TEXT_USABLEITEM_OIL, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000069()				// 허스키 캔디 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000188",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_HUSKY_CANDY2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_HUSKY_CANDY1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000070()				// 묵음 캔디 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000188",10)==true)
		trigger.message(TEXT_USABLEITEM_SILENT_CANDY, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000071()				// 수면제 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000182",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_SLEEP2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_SLEEP1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000072()				// 마취제 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000182",10)==true)
		trigger.message(TEXT_USABLEITEM_COMA, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000073()				// 망각 캔디 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(target.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkillByProb(target,"3000189",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_OBLIVION_CANDY2, MSG_TYPE__SYSTEM);
	else trigger.message(TEXT_USABLEITEM_OBLIVION_CANDY1, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000074()				// 망각 파우더 (수정)
{
	integer wNum;
	object target;
	target = controller.getObjectArgumentAt(0);

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (!target)	return;

	if (!target.isAlive())
	{
		trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if(UseSkill(target,"3000189",10)==true)
		trigger.message(TEXT_USABLEITEM_OBLIVIONFOUDER, MSG_TYPE__SYSTEM);
}

quest
qUseItem1000043()				// 해독제 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000198")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000198");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000044()				// 안약 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.getObjectCreatureStated(CREATURE_STATE__BLIND) || castedSpellInven.hasNamed("3000020") ||
		castedSpellInven.hasNamed("3000092") || castedSpellInven.hasNamed("3000896") ||
		castedSpellInven.hasNamed("3001616") || castedSpellInven.hasNamed("3001708"))
	{
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		if (castedSpellInven.getObjectCreatureStated(CREATURE_STATE__BLIND))
			castedSpellInven.getObjectCreatureStated(CREATURE_STATE__BLIND).finalize();
		if (castedSpellInven.hasNamed("3000020"))
			castedSpellInven.finalizeNamed("3000020");
		if (castedSpellInven.hasNamed("3000092"))
			castedSpellInven.finalizeNamed("3000092");
		if (castedSpellInven.hasNamed("3000896"))
			castedSpellInven.finalizeNamed("3000896");
		if (castedSpellInven.hasNamed("3001616"))
			castedSpellInven.finalizeNamed("3001616");
		if (castedSpellInven.hasNamed("3001708"))
			castedSpellInven.finalizeNamed("3001708");

		// send using effect
		controller.effectBy(trigger);
	}
}


quest
qUseItem1000045()				// 정신안정제 (미구현)
{
}

quest
qUseItem1000046()				// 봄의바람 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000195")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000195");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000047()				// 냉각캡슐 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000194")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000194");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000048()				// 라임 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000189")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000189");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000049()				// 목캔디 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000188")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000188");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000050()				// 어웨이큰 포션 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000182")) {
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000182");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000051()				// 성수 (수정)
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000900")) {	// 경주가 3000201 언데드는 사용안한다고 했음 -_-;;
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		castedSpellInven.finalizeNamed("3000900");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1000052()				// 만병통치약
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	// finalize
	castedSpellInven.finalizeAll();

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000053()				// 천사의눈물
{
	integer toUp;
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	// finalize
	castedSpellInven.finalizeAll();

	// hp, mp maxUp
	toUp = trigger.getMaxHP();
	HardCode.itemUpHP(trigger, toUp);
	toUp = trigger.getMaxMP();
	HardCode.itemUpMP(trigger, toUp);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001009()				// 하니베어의 고기
{
	if (!NormalItemCanBeUsed()) return;

	// hp 60 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 60)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 60)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 60);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001010()				// 카니보레의 꽃잎
{
	if (!NormalItemCanBeUsed()) return;

	// mp 15 회복
	if (!HardCode.itemUpMP(trigger, 15)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 15);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001011()				// 젤리 리프
{
	if (!NormalItemCanBeUsed()) return;

	// sp 20 회복
	if (!ItemUpSP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001012()				// 포이즌젤리
{
	if (!NormalItemCanBeUsed()) return;

	// hp 70 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 70)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 70)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 70);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001014()				// 상어 지느러미
{
	if (!NormalItemCanBeUsed()) return;

	// hp 230 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 230)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 230)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 230);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001020()				// 로글베글의 족발
{
	if (!NormalItemCanBeUsed()) return;

	// hp 150 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 150)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 150)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 150);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001023_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 민첩성 +1, 물리 방어력 -1
	trigger.addDex(1);
	trigger.subDefence(1);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 민첩성, 방어력 회복
	trigger.subDex(1);
	trigger.addDefence(1);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001023()				// 맥주
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001023_wait")) return;

	// 2 % mp 사용
	downMP = trigger.getMP() * 2 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001023_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001024_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 민첩성 -2, 물리 방어력 +1
	trigger.subDex(2);
	trigger.addDefence(1);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 민첩성, 방어력 회복
	trigger.addDex(2);
	trigger.subDefence(1);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001024()				// 소주
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001024_wait")) return;

	// 2 % mp 사용
	downMP = trigger.getMP() * 2 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001024_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001025_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 공격력 +1, 민첩성 +1, 마법 방어력 -1
	trigger.addStab(1);
	trigger.addDex(1);
	trigger.subMagicResist(1);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subStab(1);
	trigger.subDex(1);
	trigger.addMagicResist(1);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001025()				// 샴페인
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001025_wait")) return;

	// 5 % mp 사용
	downMP = trigger.getMP() * 5 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001025_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001026_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 공격력 +1, 베기 공격력 +1, 마법 공격력 +1, 민첩성 +2, 물리 방어력 -3
	trigger.addStab(1);
	trigger.addHack(1);
	trigger.addInt(1);
	trigger.addDex(2);
	trigger.subDefence(3);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subStab(1);
	trigger.subHack(1);
	trigger.subInt(1);
	trigger.subDex(2);
	trigger.addDefence(3);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001026()				// 칵테일
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001026_wait")) return;

	// 5 % mp 사용
	downMP = trigger.getMP() * 5 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001026_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001027_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 마법 공격력 +1, 민첩성 +1, 물리 방어력 -1
	trigger.addInt(1);
	trigger.addDex(1);
	trigger.subDefence(1);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subInt(1);
	trigger.subDex(1);
	trigger.addDefence(1);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001027()				// 와인
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001027_wait")) return;

	// 8 % mp 사용
	downMP = trigger.getMP() * 8 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001027_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001028_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 마법 공격력 +2, 마법 방어력 +2, 물리 방어력 -2
	trigger.addInt(2);
	trigger.addMagicResist(2);
	trigger.subDefence(2);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subInt(2);
	trigger.subMagicResist(2);
	trigger.addDefence(2);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001028()				// 보드카
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001028_wait")) return;

	// 8 % mp 사용
	downMP = trigger.getMP() * 8 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001028_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001029_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 베기 공격력 +1, 물리 방어력 +3, 민첩성 -2
	trigger.addHack(1);
	trigger.addDefence(3);
	trigger.subDex(2);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subHack(1);
	trigger.subDefence(3);
	trigger.addDex(2);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001029()				// 폭탄주
{
	integer downMP, downHP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001029_wait")) return;

	// 8 % mp 사용
	downMP = trigger.getMP() * 8 / 100;
	if (downMP == 0) downMP = 1;
	// 8 % hp 사용
	downHP = trigger.getHP() * 8 / 100;
	if (downHP == 0) downHP = 1;

	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getHP() < downHP) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;
	if (!HardCode.itemDownHP(trigger, downHP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001029_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001030_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 베기 공격력 +3, 물리 방어력 +1, 민첩성 -3
	trigger.addHack(3);
	trigger.addDefence(1);
	trigger.subDex(3);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subHack(3);
	trigger.subDefence(1);
	trigger.addDex(3);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001030()				// 럼주
{
	integer downMP, downHP, downSP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001030_wait")) return;

	// 8 % mp 사용
	downMP = trigger.getMP() * 8 / 100;
	if (downMP == 0) downMP = 1;
	// 8 % hp 사용
	downHP = trigger.getHP() * 8 / 100;
	if (downHP == 0) downHP = 1;
	// 5 % sp 사용
	downSP = trigger.getSP() * 5 / 100;
	if (downSP == 0) downSP = 1;

	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getHP() < downHP) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getSP() < downSP) {
		trigger.message(CANT_USE_FOR_LOW_SP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;
	if (!HardCode.itemDownHP(trigger, downHP)) return;
	if (!ItemDownSP(trigger, downSP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001030_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001031_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 공격력 +1, 베기 공격력 +1, 물리 방어력 +2, 민첩성 +1, 마법 방어력 -3
	trigger.addStab(1);
	trigger.addHack(1);
	trigger.addDefence(2);
	trigger.addDex(1);
	trigger.subMagicResist(3);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subStab(1);
	trigger.subHack(1);
	trigger.subDefence(2);
	trigger.subDex(1);
	trigger.addMagicResist(3);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001031()				// 발렌타인 100 년산
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001031_wait")) return;

	// 10 % mp 사용
	downMP = trigger.getMP() * 10 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001031_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001032()				// 알 수 없는 술
{
	integer selection = Util.random(0, 8);
	string effect;

	if (selection == 0) effect = "qUseItem1001023";
	else if (selection == 1) effect = "qUseItem1001024";
	else if (selection == 2) effect = "qUseItem1001025";
	else if (selection == 3) effect = "qUseItem1001026";
	else if (selection == 4) effect = "qUseItem1001027";
	else if (selection == 5) effect = "qUseItem1001028";
	else if (selection == 6) effect = "qUseItem1001029";
	else if (selection == 7) effect = "qUseItem1001030";
	else if (selection == 8) effect = "qUseItem1001031";

	controller.giveQuestTo(effect, trigger, null);
}

quest
qUseItem1001033_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 마법 공력력 +2, 마법 방어력 +1, 물리 방어력 -1
	trigger.addInt(2);
	trigger.addMagicResist(1);
	trigger.subDefence(1);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subInt(2);
	trigger.subMagicResist(1);
	trigger.addDefence(1);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1001033()				// 광천수
{
	integer downMP, downHP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1001033_wait")) return;

	// 5 % mp 사용
	downMP = trigger.getMP() * 8 / 100;
	if (downMP == 0) downMP = 1;
	// 5 % hp 사용
	downHP = trigger.getHP() * 8 / 100;
	if (downHP == 0) downHP = 1;

	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getHP() < downHP) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1001033_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001034()				// 우유
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getMP() < 5) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	// hp 300 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 300)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 300)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 300);
	}
	// sp 300 회복
	if (ItemUpSP(trigger, 300)) bUsed = true;

	if (bUsed == true) HardCode.itemDownMP(trigger, 5);
	else return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001035()				// 녹차
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getMP() < 5) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	// hp 500 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 500)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 500)) bUsed = true;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 500);
	}

	if (bUsed == true) HardCode.itemDownMP(trigger, 5);
	else return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001036()				// 홍차
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getHP() < 100) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}

	if (HardCode.itemUpMP(trigger, 10)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 10);

	if (bUsed == true) {
	// hp 100 소비
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		HardCode.itemUpHP(trigger, 100);
	} else {
		HardCode.itemDownHP(trigger, 100);	}
	}
	else return;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001037()				// 커피
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getHP() < 50) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getSP() < 50) {
		trigger.message(CANT_USE_FOR_LOW_SP, MSG_TYPE__SYSTEM);
		return;
	}

	if (HardCode.itemUpMP(trigger, 50)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 50);

	if (bUsed == true) {
		// hp 50 소비
		if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
			HardCode.itemUpHP(trigger, 50);
		} else	HardCode.itemDownHP(trigger, 50);
		// sp 50 소비
		ItemDownSP(trigger, 50);
	}
	else return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001038()				// 코코아
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getMP() < 5) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	// sp 500 회복
	if (ItemUpSP(trigger, 500)) bUsed = true;

	if (bUsed == true) HardCode.itemDownMP(trigger, 5);
	else return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001039()				// 아이스크림
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getMP() < 10) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	// hp 500 회복
	if (HardCode.itemUpHP(trigger, 500)) bUsed = true;
	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
	ItemBalloonUpHP(trigger, 500);
	// sp 500 회복
	if (ItemUpSP(trigger, 500)) bUsed = true;

	if (bUsed == true) HardCode.itemDownMP(trigger, 10);
	else return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001041()				// 생돈육
{
	if (!NormalItemCanBeUsed()) return;

	// hp 30 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 30)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 30)) return;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 30);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001044()				// 호박 조각
{
	if (!NormalItemCanBeUsed()) return;

	// hp 45 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 45)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 45)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 45);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001046()				// 해물 소시지
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 200 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 200)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 200)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 200);
	}

	// mp 20 회복
	if (HardCode.itemUpMP(trigger, 20)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001047()				// 토끼풀 꽃
{
	if (!NormalItemCanBeUsed()) return;

	// mp 10 회복
	if (!HardCode.itemUpMP(trigger, 10)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 10);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001048()				// 데이지 꽃
{
	if (!NormalItemCanBeUsed()) return;

	// sp 15 회복
	if (!ItemUpSP(trigger, 15)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001049()				// 블루베리
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 30 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 30)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 30)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 30);
	}

	// mp 5 회복
	if (HardCode.itemUpMP(trigger, 5)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 5);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001050()				// 레드베리
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 60 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 60)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 60)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 60);
	}

	// mp 10 회복
	if (HardCode.itemUpMP(trigger, 10)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 10);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001051()				// 화이트베리
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 90 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 90)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 90)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 90);
	}

	// mp 15 회복
	if (HardCode.itemUpMP(trigger, 15)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 15);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001053()				// 다이어트약
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getHP() < 5) {
		trigger.message(CANT_USE_FOR_LOW_HP, MSG_TYPE__SYSTEM);
		return;
	}

	// hp 5 소비
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemUpHP(trigger, 5)) bUsed = true;
	} else {
		if (HardCode.itemDownHP(trigger, 5)) bUsed = true;
	}

	// mp 30 회복
	if (HardCode.itemUpMP(trigger, 30)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 30);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001054()				// 하니브레드
{
	if (!NormalItemCanBeUsed()) return;

	// hp 70 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 70)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 70)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 70);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001057()				// 하니베어 구이
{
	if (!NormalItemCanBeUsed()) return;

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 120)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 120)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001058()				// 벌꿀
{
	if (!NormalItemCanBeUsed()) return;

	// hp 200 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 200)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 200)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 200);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001059()				// 로얄제리
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	// sp 50% 회복
	toUp = trigger.getMaxSP() * 50 / 100;
	if(!ItemUpSP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001060()				// 빵
{
	if (!NormalItemCanBeUsed()) return;

	// hp 20 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 20)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 20)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 20);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001063()				// 딸기맛 파르페
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 10 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 10)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 10)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 10);
	}

	// mp 50 회복
	if (HardCode.itemUpMP(trigger, 50)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 50);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001064()				// 테스터의 상징
{
	if (!NormalItemCanBeUsed()) return;

	// 경험치 500 증가
	trigger.addExp(500);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1001102()				// 스페셜 아이템 상자	(내용은 테스터 상징과 동일. 일본에서 알아서 수정해서 사용.)
{
	if (!NormalItemCanBeUsed()) return;

	// 경험치 500 증가
	trigger.addExp(500);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1001065()				// 호박죽
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 300 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 300)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 300)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 300);
	}

	// sp 30 회복
	if (ItemUpSP(trigger, 30)) bUsed = true;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001068()				// 젤리 크림
{
	if (!NormalItemCanBeUsed()) return;

	// hp 15 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 15)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 15)) return;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 15);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000230()				// 줄무늬 사탕
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 30% 회복
	Up = trigger.getMaxHP() * 30 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, Up);
	}

	// mp 30% 회복
	Up = trigger.getMaxMP() * 30 / 100;
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, Up);

	// sp 30% 회복
	Up = trigger.getMaxSP() * 30 / 100;
	if (ItemUpSP(trigger, Up)) bUsed = true;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000231()				// 크리스마스 선물
{
	integer selection,number=1;
	string itemID;

	selection = Util.random(1, 20000);

	if (selection == 1) {			// 1등 1/20000 다크윙
		itemID	= "1002675";
	} else if (selection == 20000) {	// 2등 1/20000 화이트윙
		itemID = "1002674";
	} else if (selection <= 11) {		// 3등 1/1000 베레모
		itemID = "1002647";
	} else if (selection >= 19989) {	// 4등 1/1000 유치원 가방
		itemID = "1002324";
	} else if (selection <= 21) {		// 5등 1/1000 순록옷
		itemID = "1002697";
	} else if (selection <= 10000) {	// 6등 질풍의 약초(5개)
		itemID = "1001890";
		number = 5;
	} else {				// 7등 신속의 열매(5개)
		itemID = "1001889";
		number = 5;
	}

	// 아이템을 준다.
	trigger.addItemClassNamed(itemID, number);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1000233()				// 신년 선물 (미구현)
{
}


quest
qUseItem1000234()				// 어린이날 선물
{
	integer selection;
//	integer giftchk;
	string itemID;

//	giftchk = Util.random(0, 10000);
	selection = Util.random(0, 100);

/*
	if (giftchk <= 11) {			// 레어 아이템의 처리
		if (selection >= 90) {
			itemID = "1000103";	// 여신의 가호 (대)
		} else if (selection >= 80) {
			itemID = "1000085";	// 리스토어 세트
		} else if (selection >= 70) {
			itemID = "1000093";	// 숫돌 (중)
		} else if (selection >= 60) {
			itemID = "1000102";	// 천사의 가호 (중)
		} else if (selection >= 50) {
			itemID = "1000099";	// 마력강화제 (중)
		} else if (selection >= 40) {
			itemID = "1000090";	// 키닝키트 (중)
		} else if (selection >= 30) {
			itemID = "1000105";	// 경화제 (중)
		} else if (selection >= 20) {
			itemID = "1000096";	// 탄성로션 (중)
		} else {
			itemID = "1000087";	// 내구성 스프레이(중)
}

	} else {		// 정상적인 처리의 경우
*/
	if (selection >= 90) {
		itemID = "1000297";		// 10% 에페
	} else if (selection >= 80) {
		itemID = "1000276";		// 10% 대거
	} else if (selection >= 70) {
		itemID = "1000318";		// 10% 실드소드
	} else if (selection >= 60) {
		itemID = "1000339";		// 10% 강철대검
	} else if (selection >= 50) {
		itemID = "1000360";		// 10% 커터
	} else if (selection >= 40) {
		itemID = "1000381";		// 10% 타도
	} else if (selection >= 30) {
		itemID = "1000402";		// 10% 태도
	} else if (selection >= 20) {
		itemID = "1000423";		// 10% 당파창
	} else {
		itemID = "1000465";		// 10% 사슬채찍
}
//	}

	// 아이템을 준다.
	trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001829()				// 망둥이의 비늘
{
	if (!NormalItemCanBeUsed()) return;

	// sp 30 회복
	if(!ItemUpSP(trigger, 30)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001831()				// 플라바의 꽃잎
{
	if (!NormalItemCanBeUsed()) return;

	// mp 25 회복
	if (!HardCode.itemUpMP(trigger, 25)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 25);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001835()				// 문어다리
{
	if (!NormalItemCanBeUsed()) return;

	// hp 40 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 40)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 40)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 40);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001877() 				// 로슈 1호 포션
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// HP 140~240 상승 (범위 값)
	value = Util.random(140, 240);

	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, value)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, value)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, value);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);

}

quest
qUseItem1001878() 				// 로슈 3호 포션
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// HP 270~410 상승 (범위 값)
	value = Util.random(270, 410);

	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, value)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, value)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			if (!ItemBalloonUpHP(trigger, value)) return;
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);

}

quest
qUseItem1001879() 				// 로슈 5호 포션
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// HP 400~580 상승 (범위 값)
	value = Util.random(400, 580);

	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, value)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, value)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, value);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);

}

quest						// 두기 1호 포션?
qUseItem1001880()
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// MP 45~70 상승 (범위 값)
	value = Util.random(45, 70);
	if (!HardCode.itemUpMP(trigger, value)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, value);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest						// 두기 3호 포션?
qUseItem1001881()
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// MP 70~110 상승 (범위 값
	value = Util.random(70, 110);
	if (!HardCode.itemUpMP(trigger, value)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, value);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest						// 두기 5호 포션?
qUseItem1001882()
{
	integer value;

	if (!NormalItemCanBeUsed()) return;

	// MP 95~150 상승 (범위 값)
	value = Util.random(95, 150);
	if (!HardCode.itemUpMP(trigger, value)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, value);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001234()				// 캐비어
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	// mp 50% 회복
	toUp = trigger.getMaxMP() * 50 / 100;
	if (!HardCode.itemUpMP(trigger, toUp)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, toUp);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001240()				// 크리스마스 양말
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 20% 회복
	Up = trigger.getMaxHP() * 20 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, Up);
	}

	// mp 20% 회복
	Up = trigger.getMaxMP() * 20 / 100;
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, Up);

	// sp 20% 회복
	Up = trigger.getMaxSP() * 20 / 100;
	if (ItemUpSP(trigger, Up)) bUsed = true;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001241()				// 왕 별
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 10% 회복
	Up = trigger.getMaxHP() * 10 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, Up);
	}

	// mp 10% 회복
	Up = trigger.getMaxMP() * 10 / 100;
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, Up);

	// sp 10% 회복
	Up = trigger.getMaxSP() * 10 / 100;
	if (ItemUpSP(trigger, Up)) bUsed = true;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001242()				// 리스
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 10% 회복
	Up = trigger.getMaxHP() * 10 / 100;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, Up);
	}

	// mp 10% 회복
	Up = trigger.getMaxMP() * 10 / 100;
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, Up);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002698()				// 케이크 조각
{
	integer torchTime;
	object skill_Torch;
	integer	Up,UseCount=0;
	boolean bUsed = false;
	object castedSpellInven;

	castedSpellInven = trigger.getCastedSpellInventory();
	skill_Torch = castedSpellInven.getObjectCreatureStated(CREATURE_STATE__ILLUMINATE);

	if (!NormalItemCanBeUsed()) return;

	// hp 완전 회복
	Up = trigger.getMaxHP();
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
	    if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
	    if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
	}

	// mp 완전 회복
	Up = trigger.getMaxMP();
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// sp 완전 회복
	Up = trigger.getMaxSP();
	if (ItemUpSP(trigger, Up)) bUsed = true;

	if(trigger.isState(CREATURE_STATE__ILLUMINATE))
	{
		torchTime = skill_Torch.getDuration();
	}

	//castedSpellInven = trigger.getCastedSpellInventory();
	if(castedSpellInven.getCount() > 0)
	{
		castedSpellInven.finalizeAll();
		bUsed = true;
	}

	if(torchTime != 0)
	{
		trigger.castNamedWithDuration("3000253",torchTime);
		// send using effect
		controller.effectBy(trigger);
	}

	if (!bUsed) return;

	// decrease number
	if (controller.checkAttribute("UC") == true)
		UseCount = String.toInteger(controller.getAttribute("UC"));
	else
	{
		if (controller.checkAttribute("USE_COUNT") == true)
			UseCount = String.toInteger(controller.getAttribute("USE_COUNT"));
		controller.resetAttribute("USE_COUNT");
	}
	if (controller.canBeExhausted() && UseCount >= 9) {
		controller.decreaseNumber(1);
	}
	else controller.setAttribute("UC",Integer.toString(UseCount+1));

	//trigger.message(String.toString(UseCount+1), MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001244()				// 리프젤리크림
{
	if (!NormalItemCanBeUsed()) return;

	// hp 400 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 400)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 400)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 400);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001246()				// 이파리맨의 이파리
{
	if (!NormalItemCanBeUsed()) return;

	// mp 200 회복
	if (!HardCode.itemUpMP(trigger, 200)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 200);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001250()				// 버섯
{
	if (!NormalItemCanBeUsed()) return;

	// mp 20 회복
	if (!HardCode.itemUpMP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001251()				// 곰팡이 포자
{
	if (!NormalItemCanBeUsed()) return;

	// hp 500 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 500)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 500)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 500);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001252()				// 100년 묵은 버섯
{
	integer toUp;

	if (!NormalItemCanBeUsed()) return;

	// hp 완전회복
	toUp = trigger.getMaxHP();
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, toUp)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, toUp)) return;
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001806()				// 테스터의 혼. 재분배 아이템
{
//	integer InventorySlotCount = 0;
	integer EquipPartCount = 8;
	integer checkUserWeight;
	integer i;

	if (!NormalItemCanBeUsed())
		return;

	if (trigger.getWorld().canFight() || trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD , MSG_TYPE__SYSTEM);
		return;
	}

	checkUserWeight = trigger.getCarryingItemInventory().weight();

	if (checkUserWeight >= 750) {
        trigger.message("Please Keep Your Weight under 750.", MSG_TYPE__SYSTEM);
//        trigger.message(TEXT_NO_RESET_CAUSE_WEIGHT, MSG_TYPE__SYSTEM);	// vahma - japan setting
		return;
	}

//	InventorySlotCount = trigger.getEmptyInvenSlotCount();

	for (i=1;i<9;++i) {
		if (trigger.getDescAtPart(i) == null) {
			EquipPartCount = EquipPartCount - 1;
		}
	}

	if (EquipPartCount != 0) {
        trigger.message("Please Unequip All Items.", MSG_TYPE__SYSTEM);
//        trigger.message(TEXT_NO_RESET_CAUSE_EQUIP, MSG_TYPE__SYSTEM);	// vahma - japan setting
		trigger.updateEquipAt(EQUIP_PART__ALL);
		trigger.updateAttr();			// 혹시 몰라서 상태 업데이트
		return;
	}

	// 초기화 함수를 실행한다.
	trigger.getExpFromAllAbilityLevel();		// 스킬과 레벨을 경험치로 환원
	trigger.resetCharacter(RESET_CHAR_LEVEL + RESET_CHAR_ACTION);	// 초기화 스펙에 맞추어 캐릭터를 초기화
	trigger.getCastedSpellInventory().terminatePassiveAll();

	Setup_Skill();
    trigger.message("Character Status Reset Complete!!", MSG_TYPE__SYSTEM);
//    trigger.message(TEXT_REQUEST_SHARE_END, MSG_TYPE__SYSTEM);	// vahma - japan setting

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	trigger.updateAttr();				// 혹시 몰라서 상태 업데이트
	controller.effectBy(trigger);
}


quest
qUseItem1001876()				// 복주머니
{
	integer selection;
	string itemID;

	selection = Util.random(0, 100);

	if (!NormalItemCanBeUsed()) return;

	if (selection >= 80) {			// 20 %	바이올렛 하브
		itemID = "1000035";
	} else if (selection >= 60) {		// 20 % 해독제
		itemID = "1000043";
	} else if (selection >= 40) {		// 20 % 키위주스
		itemID = "1000026";
	} else if (selection >= 25) {		// 15 % 리바이브 파우더
		itemID = "1000036";
	} else if (selection >= 15) {		// 10 % 힐링 포션 (중)
		itemID = "1000017";
	} else if (selection >= 10) {		// 5 % 파이프 포션 (소)
		itemID = "1000019";
	} else if (selection >= 5) {		// 5 % 만병 통치약
		itemID = "1000052";
	} else {				// 5 % 리저렉션 포션 (소)
		itemID = "1000038";
	}

	// 아이템을 준다.
	trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001884()				// 마물의 나침반
{
	if (!NormalItemCanBeUsed())
		return;

	trigger.message(TEXT_USABLEITEM_COMPASS , MSG_TYPE__SYSTEM);

	controller.effectBy(trigger);
}

quest
qUseItem1001887()				// 망각초
{
	if (!NormalItemCanBeUsed())
		return;

	if (!controller.getObjectArgumentAt(0).isMerchant()) {
		trigger.message(TEXT_USABLEITEM_OBLIVION , MSG_TYPE__SYSTEM);
		return;
	}

	// 호감도 초기화.
	trigger.setGoodwillFor(controller.getObjectArgumentAt(0), 10);
	trigger.message(USE_GOODWILL_RESET , MSG_TYPE__SYSTEM);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	controller.effectBy(trigger);
}

quest
qUseItem1001889()	//신속의 열매
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000202",60);
}

quest
qUseItem1001890()	//질풍의 약초
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if (trigger.isState(CREATURE_STATE__HIGH_SPEED) || trigger.isState(CREATURE_STATE__SYLPH_WIND)) return;

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000204",60);
}

quest
qUseItem1001891()	//부활의 향수
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000207",120);
}

quest
qUseItem1001892()	//괴력의 햄
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000209",60);
}

quest
qUseItem1001893()	//축복의 성수
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isState(CREATURE_STATE__BLESS))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING, MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000210",60);
}

quest
qUseItem1001894()	//적중의 푸딩
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getDex()>=45)
	{
		trigger.message(TEXT_USABLEITEM_DEX_RATE, MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000211",60);
}

quest
qUseItem1001895()	//회피의 쿠키
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
 	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000212",60);
}

quest
qUseItem1001896()	//완전회피의 물약
{
	integer wNum;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// PVP 이벤트 지역
	if (wNum == 565 || wNum == 566 || wNum == 567 || wNum == 568 || wNum == 569)
	{
		trigger.sayTo(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK, trigger);
		return;
	}

	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000213",30);
}

quest
qUseItem1001901()	// 라이디아 특산차
{
	integer Regen_chk = 0;

	if (!NormalItemCanBeUsed())
		return;

	if (trigger.isState(CREATURE_STATE__NO_HP_REGEN) || trigger.isState(CREATURE_STATE__NO_MP_REGEN)) {
		trigger.message(TEXT_USABLEITEM_TEA, MSG_TYPE__SYSTEM);
		return;
	}

	// HP 150 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 150));
	} else {
		if (!HardCode.itemUpHP(trigger, 150)) ++Regen_chk;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 150);
	}

	// MP 100 회복
	if (!HardCode.itemUpMP(trigger, 100)) ++Regen_chk;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 100);

	if (Regen_chk >= 2) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1001907()	// 라바의 번데기
{
	integer Regen_chk = 0;

	if (!NormalItemCanBeUsed())
		return;

	if (trigger.isState(CREATURE_STATE__NO_HP_REGEN) || trigger.isState(CREATURE_STATE__NO_MP_REGEN)) {
		trigger.message(TEXT_USABLEITEM_RAVA, MSG_TYPE__SYSTEM);
		return;
	}

	// HP 500 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 500));
	} else {
		if (!HardCode.itemUpHP(trigger, 500)) ++Regen_chk;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 500);
	}

	// MP 60 회복
	if (!HardCode.itemUpMP(trigger, 50)) ++Regen_chk;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 50);

	if (Regen_chk >= 2) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1001909()	// 반디 수정
{
	object target,castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	target = controller.getObjectArgumentAt(0);

	castedSpellInven = target.getCastedSpellInventory();
	if (castedSpellInven.getObjectCreatureStated(CREATURE_STATE__BLIND)) {
		// decrease number
		if (controller.canBeExhausted())
	 		controller.decreaseNumber(1);

		// finalize
		castedSpellInven.getObjectCreatureStated(CREATURE_STATE__BLIND).finalize();

		// send using effect
		controller.effectBy(target);
	}
}

quest
qUseItem1001954()	//	물의 징표
{
	if (!NormalItemCanBeUsed()) return;

	// sp 150 회복
	if (!ItemUpSP(trigger, 150)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001955()	// 워터 윙키의 장갑
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1001956()	//	바람의 사탕
{
	if (!NormalItemCanBeUsed()) return;

	// mp 150 회복
	if (!HardCode.itemUpMP(trigger, 150)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 150);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1001957()	//	혼 오브 더 데스
{
	if (!NormalItemCanBeUsed()) return;

	// hp 700 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 700)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 700)) return;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 700);
	}

	if(UseSkillByProb(trigger,"3000199",10,100,50)==true)
		trigger.message(TEXT_USABLEITEM_HORNOFDEATH, MSG_TYPE__SYSTEM);
}

quest
qUseItem1001961()	// 샤피어의 화염
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1001964()	// 무투백호의 이빨
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1001966()	// 불길의 실타래
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1001968()	// 전격 라바 번데기
{
	if (!NormalItemCanBeUsed())
		return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

function
boolean
ItemUseEnd()
{
	trigger.setState(USER_STATE__EVENT, false);
	trigger.setState(USER_STATE__NO_PORTAL, false);
	trigger.setState(CREATURE_STATE__NO_MOVE, false);
	return true;
}

function
boolean
NPCRangeCheck()
{
	integer defX, defY, startX, startY, endX, endY;
	object loc;

	startX = trigger.getX() - 4;
	startY = trigger.getY() - 4;
	endX = trigger.getX() + 4;
	endY = trigger.getY() + 4;

	for (defX = startX; defX < endX; ++defX) {
		for (defY = startY; defY < endY; ++defY) {
			loc = Visible.at(defX, defY);
			if (loc && loc.isMerchant()) {
				trigger.message(TEXT_USABLEITEM_CANT_NPC_POSITION, MSG_TYPE__SYSTEM);
				return false;
			}
		}
	}
	return true;
}

quest
qUseItem1001914()	// 상인의 뿔피리
{
	// 대만등에 적용할 땐 빼서 적용해야 함. isPaid
	
	if (trigger.getWorld().canFight() || trigger.getWorld().isEventWorld())
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().getNumber() == 30) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD , MSG_TYPE__SYSTEM);
		return;
	}

	if (!NPCRangeCheck()) {
		ItemUseEnd();
		return;
	}

	trigger.setState(USER_STATE__EVENT, true);
	trigger.setState(USER_STATE__NO_PORTAL, true);
	trigger.setState(CREATURE_STATE__NO_MOVE, true);

	if (!NormalItemCanBeUsed()) {
		ItemUseEnd();
		return;
	}

	// 락을 걸어주고..
	controller.setLocked(true);

	// 만드는데 실패했나? 그렇다면 락을 바로 풀어주자.
	if (!trigger.startTrade(false, 800)) {
//		if (!trigger.startTradeWith(controller, 800)) {
		controller.setLocked(false);
		ItemUseEnd();
		return;
	}

	// 유저의 응답을 기다린 후
	Event.waitFor(EVENT_USER_MERCHANT);

	// 락을 풀어준다.
	controller.setLocked(false);

	// 만들다가 중간에 캔슬
	if (!Event.result(EVENT_USER_MERCHANT)) {
		ItemUseEnd();
		return;
	}

	controller.effectBy(trigger);

	// 다 만들었으니까 아래 처리
	// 이 때 주의할 것은 wait 에 들어갔다가 나온 것이기 때문에,
	// decrease number 를 불러서는 안된다.
	// 반드시 sweepNumbered 를 부를 것!!
	// 그리고 sweepNumbered 를 부르는 경우는 아이템이 바로 없어지기 때문에
	// effectBy 를 앞에서 불러야 한다.
	if (controller.canBeExhausted()) controller.sweepNumbered(1);
		ItemUseEnd();
}

quest
qUseItem1002853()	// 잡상인의 뿔피리
{
	integer MapNumber;

	trigger.setState(USER_STATE__EVENT, true);
	trigger.setState(USER_STATE__NO_PORTAL, true);
	trigger.setState(CREATURE_STATE__NO_MOVE, true);

	if (!NormalItemCanBeUsed()) {
		ItemUseEnd();
		return;
	}

	MapNumber = trigger.getWorld().getNumber();

	if (MapNumber != 303 && MapNumber != 317 && MapNumber != 562) {
		trigger.sayTo(TEXT_CANT_USE_EXCEPT_FLEAMARKET, trigger);
		ItemUseEnd();
		return;
	}

	if (!NPCRangeCheck()) {
		ItemUseEnd();
		return;
	}
	// 락을 걸어주고..
	controller.setLocked(true);

	// 만드는데 실패했나? 그렇다면 락을 바로 풀어주자.
	if (!trigger.startTrade(false, 180)) {
	// if (!trigger.startTradeWith(controller, 180)) {
		controller.setLocked(false);
		ItemUseEnd();
		return;
	}

	// 유저의 응답을 기다린 후
	Event.waitFor(EVENT_USER_MERCHANT);

	// 락을 풀어준다.
	controller.setLocked(false);

	// 만들다가 중간에 캔슬
	if (!Event.result(EVENT_USER_MERCHANT)) {
		ItemUseEnd();
		return;
	}

	controller.effectBy(trigger);

	// 다 만들었으니까 아래 처리
	// 이 때 주의할 것은 wait 에 들어갔다가 나온 것이기 때문에,
	// decrease number 를 불러서는 안된다.
	// 반드시 sweepNumbered 를 부를 것!!
	// 그리고 sweepNumbered 를 부르는 경우는 아이템이 바로 없어지기 때문에
	// effectBy 를 앞에서 불러야 한다.
	if (controller.canBeExhausted()) controller.sweepNumbered(1);
		ItemUseEnd();
}


quest
qUseItem1002051_wait()
{
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	// 찌르기 공격력 +2, 베기 공격력 +2, 마법 공격력 +2, 민첩성 +4, 물리 방어력 -4
	trigger.addStab(2);
	trigger.addHack(2);
	trigger.addInt(2);
	trigger.addDex(4);
	trigger.subDefence(4);
	trigger.updateAttr();

	// 10 초간 기다림
	Util.sleep(10);

	// 환원
	trigger.subStab(2);
	trigger.subHack(2);
	trigger.subInt(2);
	trigger.subDex(4);
	trigger.addDefence(4);
	trigger.updateAttr();

	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1002051()				// 페퍼민트 칵테일
{
	integer downMP;

	if (!NormalItemCanBeUsed()) return;

	// 이미 사용 중?
	if (trigger.hasQuest("qUseItem1002051_wait")) return;

	// 10 % mp 사용
	downMP = trigger.getMP() * 10 / 100;
	if (downMP == 0) downMP = 1;
	if (trigger.getMP() < downMP) {
		trigger.message(CANT_USE_FOR_LOW_MP, MSG_TYPE__SYSTEM);
		return;
	}

	if (!HardCode.itemDownMP(trigger, downMP)) return;

	// 아이템 효과 주기.
	// org 값을 바꾸는 것이 아니고,
	// 재접후에 다시 효과가 나와야 하는 것이 아니기 때문에,
	// terminator 를 쓰지 않고 그냥 스크립트 하나 돌려주고 땡..
	trigger.giveQuestTo("qUseItem1002051_wait", trigger, null);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1001803()				// 주시자의 눈
{
	object target;
	string UserNamed;
	string TeamName;
	string LeaderNamed;
	string UserIpAdd;
	integer MemberType;
	integer GoodWillforUser;
	integer UserEXPValue;
	integer UserSEEDValue;
	integer UserBalanceValue;
	integer MonLevel;
	integer MonHP;
	integer MonMP;
	integer MonSP;
	integer MonMaxHP;
	integer MonMaxMP;
	integer MonMaxSP;
	integer MonSTAB;
	integer MonHACK;
	integer MonINT;
	integer MonDEX;
	integer MonDEF;
	integer MonMR;
	integer	MonAGI;

	target = controller.getObjectArgumentAt(0);

	if (target) {
		if (target.isUser()) {
			if (trigger.getBuilderType() == 1 || trigger.getBuilderType() == 2) {
				trigger.message(TEXT_USABLEITEM_TARGET_ADMIN1, MSG_TYPE__SYSTEM);
			} else {
				UserNamed = target.getName();
				UserIpAdd = target.getIpString();
				MonLevel = target.getLevel();

				UserEXPValue = target.getExp();
				UserSEEDValue = target.getGold();
				UserBalanceValue = target.getBalance();

				if (target.hasTeam()) {
					TeamName = target.getGroupName();
					LeaderNamed = target.getTeamChiefUser().getName();
					MemberType = target.getTeamMemberType();
				} else {
					TeamName = "None";
					LeaderNamed = "None";
					MemberType = 0;
				}

				trigger.message(TEXT_USABLEITEM_ADMINID + UserNamed+TEXT_USABLEITEM_ADMINLV + MonLevel + TEXT_USABLEITEM_ADMINIP + UserIpAdd, MSG_TYPE__SYSTEM);
				trigger.message(TEXT_USABLEITEM_ADMIN5 + UserSEEDValue + TEXT_USABLEITEM_ADMIN6 + UserBalanceValue + TEXT_USABLEITEM_ADMIN_EXP +UserEXPValue, MSG_TYPE__SYSTEM);
				trigger.message(TEXT_USABLEITEM_ADMIN_TEAM+TeamName+TEXT_USABLEITEM_ADMIN_LEADER+LeaderNamed+TEXT_USABLEITEM_ADMIN_TYPE+MemberType, MSG_TYPE__SYSTEM);
			}
		} else if (target.isMerchant()) {
			GoodWillforUser = target.getGoodwillFor(trigger);
			trigger.message(TEXT_USABLEITEM_ADMIN_GOODWILL1+GoodWillforUser+TEXT_USABLEITEM_ADMIN_GOODWILL2, MSG_TYPE__SYSTEM);
		} else if (target.isMonster()) {
			MonLevel = target.getLevel();
			MonHP = target.getHP();
			MonMP = target.getMP();
			MonSP = target.getSP();
			MonMaxHP = target.getMaxHP();
			MonMaxMP = target.getMaxMP();
			MonMaxSP = target.getMaxSP();
			MonSTAB = target.getInt();
			MonHACK = target.getHack();
			MonINT = target.getStab();
			MonDEX = target.getDex();
			MonDEF = target.getDefence();
			MonMR = target.getMagicResist();
			MonAGI = target.getAgi();

			trigger.message(TEXT_USABLEITEM_MESSAGE_TARGET_LV1+MonLevel+TEXT_USABLEITEM_MESSAGE_MON, MSG_TYPE__SYSTEM);
			trigger.message(TEXT_USABLEITEM_MESSAGE_HP+MonHP+TEXT_USABLEITEM_MESSAGE_SLASH+MonMaxHP+TEXT_USABLEITEM_MESSAGE_MP+MonMP+TEXT_USABLEITEM_MESSAGE_SLASH+MonMaxMP+TEXT_USABLEITEM_MESSAGE_SP+MonSP+TEXT_USABLEITEM_MESSAGE_SLASH+MonMaxSP, MSG_TYPE__SYSTEM);
			trigger.message(TEXT_USABLEITEM_MESSAGE_STAB+MonSTAB+TEXT_USABLEITEM_MESSAGE_HACK+MonHACK+TEXT_USABLEITEM_MESSAGE_INT+MonINT+TEXT_USABLEITEM_MESSAGE_DEX+MonDEX+TEXT_USABLEITEM_MESSAGE_DEF+MonDEF+TEXT_USABLEITEM_MESSAGE_MR+MonMR+TEXT_USABLEITEM_MESSAGE_AGI+MonAGI, MSG_TYPE__SYSTEM);
		} else {
			trigger.message(TEXT_USABLEITEM_MESSAGE_UNKNOWN, MSG_TYPE__SYSTEM);
			return;
		}

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		controller.effectBy(target);
	}
}

quest
qUseItem1002168()				// 용자의 보물상자
{
	string itemID;
	integer selection;
	integer item_num = 1;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 50) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(0, 100);

	if (selection >= 80) {			// 20 %	레드허브 50개
		itemID = "1000013";
		item_num = 50;
	} else if (selection >= 62) {		// 18 % 그린허브 50개
		itemID = "1000026";
		item_num = 50;
	} else if (selection >= 47) {		// 15 % 블루베리 4개
		itemID = "1001049";
		item_num = 4;
	} else if (selection >= 37) {		// 10 % 레드베리 3개
		itemID = "1001050";
		item_num = 3;
	} else if (selection >= 27) {		// 10 % 화이트베리 2개
		itemID = "1001051";
		item_num = 2;
	} else if (selection >= 17) {		// 10 % 망각초
		itemID = "1001887";
	} else if (selection >= 12) {		// 5 % 푸른장미
		itemID = "1002032";
	} else if (selection >= 9) {		// 3 % 스쿠프 고철
		itemID = "1001864";
	} else if (selection >= 8) {		// 1 % 천사의가호(소)
		itemID = "1000102";
	} else if (selection >= 7) {		// 1 % 키닝키트
		itemID = "1000090";
	} else if (selection >= 6) {		// 1 % 스트랩
		itemID = "1000092";
	} else if (selection >= 5) {		// 1 % 마.강(소)
		itemID = "1000098";
	} else if (selection >= 4) {		// 1 % 탄성 (소)
		itemID = "1000095";
	} else if (selection >= 3) {		// 1 % 샤프너
		itemID = "1000089";
	} else if (selection >= 2) {		// 1 % 숫돌
		itemID = "1000093";
	} else if (selection >= 1) {		// 1 % 탄성 (중)
		itemID = "1000096";
	} else {				// 1 % 마.강(중)
		itemID = "1000099";
	}

	// 아이템을 준다.
	trigger.addItemClassNamed(itemID, item_num);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002169()				// 최강 클럽의 증표
{
	boolean	bUsed=false;

	if (!NormalItemCanBeUsed()) return;

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 120)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 120)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// mp 20 회복
	if (HardCode.itemUpMP(trigger, 20)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	if(bUsed == false) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002170()				// 도전 클럽의 증표
{
	boolean	bUsed=false;

	if (!NormalItemCanBeUsed()) return;

	// hp 30 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 30)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 30)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 30);
	}

	// mp 10 회복
	if (HardCode.itemUpMP(trigger, 10)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 10);

	if(bUsed == false) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002329()				// 백섭 드라이버
{
	if (!NormalItemCanBeUsed()) return;

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 120)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 120)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002330()				// 작은 벌레
{
	if (!NormalItemCanBeUsed()) return;

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 120)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 120)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002331()				// 렉 스톤
{
	if (!NormalItemCanBeUsed()) return;

	// hp 120 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 120)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 120)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 120);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002332()				// 운영 교본
{
	if (!NormalItemCanBeUsed()) return;

	// mp 20 회복
	if (!HardCode.itemUpMP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002333()				// 비매너 교본
{
	if (!NormalItemCanBeUsed()) return;

	// mp 20 회복
	if (!HardCode.itemUpMP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002334()				// 해킹 교본
{
	if (!NormalItemCanBeUsed()) return;

	// mp 20 회복
	if (!HardCode.itemUpMP(trigger, 20)) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 20);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002335()				// 파란 선물 상자
{
	string itemID;
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 3) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 65) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 10000);

	if (selection == 1 || selection == 2) {
		if (trigger.getDBID()==2000000) itemID = "1000328";		//물복 루시안
		else if (trigger.getDBID()==2000001) itemID = "1000412";	//물복 보리스
		else if (trigger.getDBID()==2000002) itemID = "1000412";	//물복 막시민
		else if (trigger.getDBID()==2000003) itemID = "1000433";	//스탭 시벨린
		else if (trigger.getDBID()==2000007) itemID = "1000475";	//핵 밀라
		else if (trigger.getDBID()==2000008) itemID = "1000664";	//공격형 티치엘
		else if (trigger.getDBID()==2000009) itemID = "1000307";	//스탭 이스핀
		else if (trigger.getDBID()==2000010) itemID = "1000286";	//스탭 나야트레이
		else if (trigger.getDBID()==2000014) itemID = "1000391";	//핵 루시안
		else if (trigger.getDBID()==2000015) itemID = "1000391";	//핵 보리스
		else if (trigger.getDBID()==2000016) itemID = "1000391";	//핵 막시민
		else if (trigger.getDBID()==2000017) itemID = "1000454";	//물복 시벨린
		else if (trigger.getDBID()==2000021) itemID = "1000622";	//물복 밀라
		else if (trigger.getDBID()==2000022) itemID = "1000685";	//보조형 티치엘
		else if (trigger.getDBID()==2000023) itemID = "1000328";	//물복 이스핀
		else if (trigger.getDBID()==2000024) itemID = "1000370";	//물복 나야트레이
		else if (trigger.getDBID()==2000028) itemID = "1000307";	//스탭 루시안
		else if (trigger.getDBID()==2000029) itemID = "1000349";	//마검사 보리스
		else if (trigger.getDBID()==2000030) itemID = "1000349";	//마검사 막시민
		else if (trigger.getDBID()==2000031) itemID = "1000454";	//핵 시벨린
		else if (trigger.getDBID()==2000035) itemID = "1000622";	//스탭 밀라
		else if (trigger.getDBID()==2000036) itemID = "1000706";	//전투 티치엘
		else if (trigger.getDBID()==2000037) itemID = "1000391";	//핵 이스핀
		else if (trigger.getDBID()==2000038) itemID = "1000643";	//핵 나야트레이

		// 아이템을 준다.
		trigger.addItemClassNamed(itemID, 1);
		trigger.addItemClassNamed("1000961", 1);

		if(selection == 1)	// 렙 75 무기 + 피닉스 윙 + 윙 슈즈
			trigger.addItemClassNamed("1002658", 1);
		else if(selection ==2)	// 렙 75 무기 + 크로우 윙 + 윙슈즈
			trigger.addItemClassNamed("1002659", 1);
	}

	//vahma - japan setting
	else if(selection == 3 || selection == 4)
		trigger.addItemClassNamed("1002660", 1);	//d
	else if(selection == 5 || selection == 6)
		trigger.addItemClassNamed("1002661", 1);	// XH
	else if(selection == 7 || selection == 8)
		trigger.addItemClassNamed("1002693", 1);	//HXq
	else if(selection == 9 || selection == 10)
		trigger.addItemClassNamed("1002694", 1);	//H!?
	else if(selection == 11 || selection == 12)
		trigger.addItemClassNamed("1002690", 1);	//?
	else if(selection == 13 || selection == 14)
		trigger.addItemClassNamed("1002212", 1);	//!?H
	else if(selection == 15 || selection == 16)
		trigger.addItemClassNamed("1002213", 1);	//!?
	else if(selection == 17 || selection == 18)
		trigger.addItemClassNamed("1002214", 1);	//!?S[O
	else if(selection == 19 || selection == 20)
		trigger.addItemClassNamed("1002215", 1);	//!????
	else if(selection == 21 || selection == 22)
		trigger.addItemClassNamed("1002216", 1);	//!?w
	else if(selection == 23 || selection == 24)
		trigger.addItemClassNamed("1002217", 1);	//!?r
	else if(selection == 25 || selection == 26)
		trigger.addItemClassNamed("1002869", 1);	//_
	else if(selection == 27 || selection == 28)
		trigger.addItemClassNamed("1003853", 1);	//Vo[A[
	else if(selection == 29 || selection == 30)
		trigger.addItemClassNamed("1002922", 1);	//WAoh
	else if(selection == 31 || selection == 32)
		trigger.addItemClassNamed("1002923", 1);	//VNooh
	else if(selection == 33 || selection == 34)
		trigger.addItemClassNamed("1000947", 1);	//zCgEBO(s)
	else if(selection == 35 || selection == 36)
		trigger.addItemClassNamed("1000948", 1);	//_[NEBO(s)
	else trigger.addItemClassNamed("1000156", 1);		//nY???(

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002336()				// 노란 선물 상자
{
	string itemID = "";
	integer selection;

	if (!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection	= Util.random(1, 100);

	if (selection == 1) {			// 탄성로션(대)
		itemID	= "1000097";
	} else if (selection == 2) {		// 제련키트
		itemID	= "1000091";
	} else if (selection == 3) {		// 그라인더
		itemID	= "1000094";
	} else if (selection == 4) {		// 마력강화제(대)
		itemID	= "1000100";
	} else if (selection == 5) {		// 여신의 가호
		itemID	= "1000103";
	} else if (selection == 6) {		// 경화제(대)
		itemID	= "1000106";
	} else if (selection == 7) {		// 내구성 스프레이(대)
		itemID	= "1000088";
	} else if (selection == 8) {		// 뽀글머리
		itemID	= "1002649";
	} else if (selection == 9) {		// 별모래 머리핀
		itemID	= "1001205";
	} else if (selection == 10) {		// 별모양 귀걸이
		itemID	= "1002653";
    } else if (selection == 11) {		//vahma japan setting
	itemID	= "1000807";
    } else if (selection == 12) {	
	itemID	= "1002324";
    } else if (selection == 13) {	
	itemID	= "1002911";
    } else if (selection == 14) {	
	itemID	= "1002912";
    } else if (selection == 15) {	
	itemID	= "1002913";
    } else if (selection == 16) {	
	itemID	= "1002914";
    } else if (selection == 17) {	
	itemID	= "1002915";
    } else if (selection == 18) {	
	itemID	= "1002916";
    } else if (selection == 19) {	
	itemID	= "1002917";
    } else if (selection == 20) {	
	itemID	= "1002918";
    } else if (selection == 21) {	
	itemID	= "1002919";
    } else if (selection == 22) {	
	itemID	= "1002920";
    } else if (selection == 23) {	
	itemID	= "1002651";
    } else {
	itemID	= "1000156";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);

}

quest
qUseItem1002337()				// 초록 선물 상자
{
	// 아이템을 준다.
	trigger.addItemClassNamed("1000013", 999);		// 레드허브 999개
	trigger.addItemClassNamed("1000024", 999);		// 그린허브 999개

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002348()				// 개발자의 눈물
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 350 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 350)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 350)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 350);
	}

	// sp 250 회복
	if (ItemUpSP(trigger, 250)) bUsed = true;

	if (bUsed == false) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002349()				// 운영자의 마음
{
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// mp 60 회복
	if (HardCode.itemUpMP(trigger, 60)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 60);

	// sp 250 회복
	if (ItemUpSP(trigger, 250)) bUsed = true;

	if (bUsed == false) return;

	// decrease number
	if (controller.canBeExhausted()) {
	controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002350()				// 테일즈위버 스톤
{
	boolean	bUsed = false;
	if (!NormalItemCanBeUsed()) return;

	// hp 350 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, 350)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, 350)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 350);
	}

	// mp 60 회복
	if (HardCode.itemUpMP(trigger, 60)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 60);

	// sp 250 회복
	if (ItemUpSP(trigger, 250)) bUsed = true;

	if (bUsed == false) return;

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002669()				// 캡틴 호크의 길잡이 지도
{
	if (!NormalItemCanBeUsed())
		return;

	trigger.message(TEXT_USABLEITEM_PATH_MAP_OF_CAPTAIN_HAWK1 , MSG_TYPE__SYSTEM);
	trigger.message(TEXT_USABLEITEM_PATH_MAP_OF_CAPTAIN_HAWK2 , MSG_TYPE__SYSTEM);
}

quest
qUseItem1002672()				// 캡틴 호크의 보물 지도
{
	if (!NormalItemCanBeUsed())
		return;

	trigger.message(TEXT_USABLEITEM_TREASURE_MAP_OF_CAPTAIN_HAWK , MSG_TYPE__SYSTEM);
}

quest
qUseItem1002755()				// 눈 폭죽
{
	if (!NormalItemCanBeUsed()) return;

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002760()				// (소) 세뱃돈
{
	integer number,gold;

	if (!NormalItemCanBeUsed()) return;

	gold = trigger.getGold();
	number	= Util.random(1, 300);

	// 아이템을 준다.
	trigger.setGold(gold + number);

	trigger.message(TEXT_USABLEITEM_SEBAETDON , MSG_TYPE__SYSTEM);
	trigger.message(TEXT_USABLEITEM_SEBAETDON_MONEY1 + number + TEXT_USABLEITEM_SEBAETDON_MONEY2, MSG_TYPE__SYSTEM);

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002761()				// (대) 세뱃돈
{
	integer number,gold;

	if (!NormalItemCanBeUsed()) return;

	gold = trigger.getGold();
	number = Util.random(300, 1000);

	// 아이템을 준다.
	trigger.setGold(gold + number);

	trigger.message(TEXT_USABLEITEM_SEBAETDON , MSG_TYPE__SYSTEM);
	trigger.message(TEXT_USABLEITEM_SEBAETDON_MONEY1 + number + TEXT_USABLEITEM_SEBAETDON_MONEY2, MSG_TYPE__SYSTEM);

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002765()				// 교환권 C
{
	if (!NormalItemCanBeUsed()) return;

	// 아이템을 준다.
	trigger.addItemClassNamed("1002212", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002766()				// 교환권 D
{
	if (!NormalItemCanBeUsed()) return;

	// 아이템을 준다.
	trigger.addItemClassNamed("1000961", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002767()				// 교환권 E
{
	if (!NormalItemCanBeUsed()) return;

	// 아이템을 준다.
	trigger.addItemClassNamed("1000095", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}



quest
qUseItem1002777()				// 체험 스크롤 : 경험치 10000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(10000);
	trigger.updateAttr();
}

quest
qUseItem1002778()				// 체험 스크롤 : 경험치 100000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(100000);
	trigger.updateAttr();
}

quest
qUseItem1002779()				// 체험 스크롤 : 경험치 500000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(500000);
	trigger.updateAttr();
}

quest
qUseItem1002780()				// 체험 스크롤 : 경험치 1000000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(1000000);
	trigger.updateAttr();
}

quest
qUseItem1002781()				// 체험 스크롤 : 경험치 5000000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(5000000);
	trigger.updateAttr();
}

quest
qUseItem1002782()				// 체험 스크롤 : 경험치 10000000 상승
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addExp(10000000);
	trigger.updateAttr();
}

quest
qUseItem1002784()				// 초코 가루
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, 50)) return;
	} else {
		if (!HardCode.itemUpHP(trigger, 50)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 50);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002785()				// 고백 초콜렛
{
	if (!NormalItemCanBeUsed()) return;

	if (controller.checkAttribute("LOVE_MESSAGE") == true)
//	윈도우 출력방식 수정에 맞춰 조정 by stsoul 2004.02.04
		trigger.message("<c1>" + TEXT_LOVE_CONFESSION_CHOCOLATE__TEST + "</n></c1><c8>" + controller.getAttribute("LOVE_MESSAGE"), MSG_TYPE__AUTOHIDE_WINDOW);
	else trigger.sendSelectQuestMessage(TEXT_LOVE_CONFESSION_USE, "LOVE_INPUT", "LOVE_CANCEL", controller);
}

quest
qUseItem1002786()				// 젤라틴
{
	if (!NormalItemCanBeUsed()) return;

	// mp 30 회복
	if (!HardCode.itemUpMP(trigger, 30)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 30);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002787()				// 고백 사탕
{
	if (!NormalItemCanBeUsed()) return;

	if (controller.checkAttribute("LOVE_MESSAGE") == true)
//		trigger.message(TEXT_LOVE_CONFESSION_CANDY_PREFIX + controller.getAttribute("LOVE_MESSAGE") + TEXT_LOVE_CONFESSION_SUFFIX, MSG_TYPE__AUTOHIDE_WINDOW);
//	윈도우 출력방식 수정에 맞춰 조정 by stsoul 2004.02.04
		trigger.message("<c1>" + TEXT_LOVE_CONFESSION_CANDY__TEST + "</n></c1><c8>" + controller.getAttribute("LOVE_MESSAGE"), MSG_TYPE__AUTOHIDE_WINDOW);
	else trigger.sendSelectQuestMessage(TEXT_LOVE_CONFESSION_USE, "LOVE_INPUT", "LOVE_CANCEL", controller);
}


quest
WriteFMessage()
{
	if (trigger.getCarryingItemInventory().getCountClassNamed("1001809") < 1) {
		trigger.message(TEXT_USABLEITEM_CANT_EXHAUST, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getBuilderType() == 1 || trigger.getBuilderType() == 2) {
//	if (trigger.isBuilder()) {
		trigger.getWorld().broadcast("<c8>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);
	} else {
		trigger.getWorld().broadcast("<c8>" + Util.filterCurse(trigger.getQuestArgument()) + " </n></n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
	}
	trigger.removeItemClassNamed("1001809", 1);
}


quest
qUseItem1001809()				// 필드 메시지 스크롤
{
	integer chkResult, bType;

	if (!NormalItemCanBeUsed()) return;
	chkResult = trigger.getWorld().getNumber();
	bType = trigger.getBuilderType();

	if (bType != 1 && bType != 2 && bType != 3 && bType != 5) {
		if (chkResult == 120 || chkResult == 324 || chkResult == 326) {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	}

	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE, "WriteFMessage", controller);
}


quest
WriteFMessage1()
{
	// trigger.setCookie("Item_Message", "<c8>" + Util.filterCurse(trigger.getQuestArgument()), 0);
	trigger.setStringValue(3, "<c8>" + Util.filterCurse(trigger.getQuestArgument()));
	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE2, "WriteFMessage2", controller);
}

quest
WriteFMessage2()
{

	if (trigger.getCarryingItemInventory().getCountClassNamed("1001810") < 1) {
		trigger.message(TEXT_USABLEITEM_CANT_EXHAUST, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getBuilderType() == 1 || trigger.getBuilderType() == 2) {
//	if (trigger.isBuilder()) {
//		trigger.getWorld().broadcast("</n>" + trigger.getCookie("Item_Message") + "</n>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);
		trigger.getWorld().broadcast("</n>" + trigger.getStringValue(3) + "</n>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);

	} else {
//		trigger.getWorld().broadcast(trigger.getCookie("Item_Message") + "</n>" + Util.filterCurse(trigger.getQuestArgument()) + " </n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
		trigger.getWorld().broadcast(trigger.getStringValue(3) + "</n>" + Util.filterCurse(trigger.getQuestArgument()) + " </n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
	}
	trigger.resetStringValue(3);
	trigger.removeItemClassNamed("1001810", 1);
}


quest
qUseItem1001810()				// 필드 메시지 스크롤 2줄짜리 테스트용
{
	integer chkResult, bType;

	if (!NormalItemCanBeUsed()) return;
	chkResult = trigger.getWorld().getNumber();
	bType = trigger.getBuilderType();

	if (bType != 1 && bType != 2 && bType != 3 && bType != 5) {
		if (chkResult == 120 || chkResult == 324 || chkResult == 326) {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	}

	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE1, "WriteFMessage1", controller);
}


quest
WriteConfession()
{
	controller.setAttribute("LOVE_MESSAGE", Util.filterCurse(trigger.getQuestArgument()) + " </n></n><c9></r>[From " + trigger.getName() + "]");
	trigger.message(TEXT_CONFESSION_CARD_INPUT, MSG_TYPE__SYSTEM);
}

quest
CARD_INPUT()					// 고백 쓰기
{
	trigger.sendDescribeQuestMessage(TEXT_CONFESSION_INPUT, "WriteConfession", controller);
}

quest
qUseItem1001927()				// 축복의 엽서
{
	if (!NormalItemCanBeUsed()) return;

	if (controller.checkAttribute("LOVE_MESSAGE") == true)
		trigger.message("<c1>" + TEXT_CONFESSION_CARD + "</n></c1><c8>" + controller.getAttribute("LOVE_MESSAGE"), MSG_TYPE__AUTOHIDE_WINDOW);
	else trigger.sendSelectQuestMessage(TEXT_LOVE_CONFESSION_USE, "CARD_INPUT", "null", controller);
}


quest
qUseItem1002788()				// 커플 탐지기?
{
	integer mapChk;

	if (!NormalItemCanBeUsed()) return;

	mapChk = trigger.getWorld().getNumber();

	if (mapChk == 21) {
		trigger.message(TEXT_COUPLE_CHECKTEXT1, MSG_TYPE__AUTOHIDE_WINDOW);
	} else if (mapChk == 91 || mapChk == 1) {
		trigger.message(TEXT_COUPLE_CHECKTEXT2, MSG_TYPE__AUTOHIDE_WINDOW);
	} else {
		trigger.message(TEXT_COUPLE_CHECKTEXT3, MSG_TYPE__AUTOHIDE_WINDOW);
	}
}

quest
qUseItem1002800()	//	비너스의 눈물
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if(castedSpellInven.getCount()>0)
		castedSpellInven.finalizeAll();

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
}

quest
qUseItem1002801()	//	비너스의 가발
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if(castedSpellInven.getCount()>0)
		castedSpellInven.finalizeAll();

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
}

quest
qUseItem1002802()	//	비너스의 하트
{
	object castedSpellInven;

	if (!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();
	if(castedSpellInven.getCount()>0)
		castedSpellInven.finalizeAll();

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
}

quest
qUseItem1002803()	//	월하노인의 붉은 실
{
	if(trigger.getWorld().canPK())
	{
  		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
  		return;
	}

	if (trigger.isState(CREATURE_STATE__BLESS))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING, MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000210",60);
}

quest
qUseItem1002804()	//	월하노인의 백색 가발
{
	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isState(CREATURE_STATE__BLESS))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING, MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000210",60);
}

quest
qUseItem1002805()	//	월하노인의 하트
{
	if(trigger.getWorld().canPK())
	{
		trigger.message(TEXT_USABLEITEM_ENDURANCE_MESSAGE_PK , MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.isState(CREATURE_STATE__BLESS))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING, MSG_TYPE__SYSTEM);
		return;
	}

	UseSkill(trigger,"3000210",60);
}

quest
qUseItem1002870()   // 서왕모의 반도
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 완전 회복
	Up = trigger.getMaxHP();
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
	}

	// mp 완전 회복
	Up = trigger.getMaxMP();
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// sp 완전 회복
	Up = trigger.getMaxSP();
	if (ItemUpSP(trigger, Up)) bUsed = true;

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002871()   // 태을진인의 선단
{
	integer	Up;
	boolean bUsed = false;

	if (!NormalItemCanBeUsed()) return;

	// hp 300 회복
	Up = 300;
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (HardCode.itemDownHP(trigger, Up)) bUsed = true;
	} else {
		if (HardCode.itemUpHP(trigger, Up)) bUsed = true;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, Up);
	}

	// mp 100 회복
	Up = 100;
	if (HardCode.itemUpMP(trigger, Up)) bUsed = true;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, Up);

	if (!bUsed) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002877()			// 경서
{
	object rank;
	integer maxnum, Rvalue, tickTime, rCount, mType, iBirth;
	string cName, rName, timestamp;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	Rvalue = Util.random(1, 200);

	if (Rvalue <= 2) {			// 1002878		성광지회
		rName = "SEOYUKI_ITEM_1";
		rank = Rank.select(rName);
		maxnum = 5;	//하루에 나올 수 있는 최대의 아이템 수
		mType = 1;
		rCount = rank.getCount();
	} else if (Rvalue <= 4) {		// 1002897		사증 모자
		rName = "SEOYUKI_ITEM_2";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 2;
		rCount = rank.getCount();
	} else if (Rvalue <= 6) {		// 1002864		여래지이
		rName = "SEOYUKI_ITEM_3";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 3;
		rCount = rank.getCount();
	} else if (Rvalue <= 7) {		// 1002879		건곤 배낭
		rName = "SEOYUKI_ITEM_4";
		rank = Rank.select(rName);
		maxnum = 20;
		mType = 4;
		rCount = rank.getCount();
	} else if (Rvalue <= 9) {		// 1002868		여래불의 장심
		rName = "SEOYUKI_ITEM_5";
		rank = Rank.select(rName);
		maxnum = 20;
		mType = 5;
		rCount = rank.getCount();
	} else if (Rvalue <= 11) {		// 1002861		제사장의 투구
		rName = "SEOYUKI_ITEM_6";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 6;
		rCount = rank.getCount();
	} else if (Rvalue <= 12) {		// 1002863		우마왕의 뿔투구
		rName = "SEOYUKI_ITEM_7";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 7;
		rCount = rank.getCount();
	} else if (Rvalue <= 14) {		// 1002865		천봉코
		rName = "SEOYUKI_ITEM_8";
		rank = Rank.select(rName);
		maxnum = 20;
		mType = 8;
		rCount = rank.getCount();
	} else if (Rvalue <= 15) {		// 1002866		우마왕 처의 파초선
		rName = "SEOYUKI_ITEM_9";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 9;
		rCount = rank.getCount();
	} else if (Rvalue <= 17) {		// 1002869		근두운
		rName = "SEOYUKI_ITEM_10";
		rank = Rank.select(rName);
		maxnum = 20;
		mType = 10;
		rCount = rank.getCount();
	} else if (Rvalue <= 19) {		// 1002862		금색 투구
		rName = "SEOYUKI_ITEM_11";
		rank = Rank.select(rName);
		maxnum = 5;
		mType = 11;
		rCount = rank.getCount();
	} else if (Rvalue <= 20) {		// 1002867		금은각의 호로병
		rName = "SEOYUKI_ITEM_12";
		rank = Rank.select(rName);
		maxnum = 3;
		mType = 12;
		rCount = rank.getCount();
	} else if (Rvalue <= 100) {		// 1002870		서왕모의 반도
		mType = 13;
	} else {				// 1002871		태을진인의 선단
		mType = 14;
	}

	// decrease number
	if (controller.canBeExhausted())
	      controller.decreaseNumber(1);

	cName = trigger.getName();
	tickTime = Util.getTick();

	iBirth = trigger.getBirthTime();

	if(rCount < maxnum)
	{
		timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
		Util.log("### SeoYuKi Event Item UserName[" + cName + "] getItem #" + rCount + "/" + maxnum + " On time = [" + timestamp + "] [" + rName + " ###");
		rank.add(cName,0, 0, 0, iBirth, "null");

		if (mType == 1)
		{
			trigger.addItemClassNamed("1002878", 1); // 성광지회
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM1, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 2)
		{
			trigger.addItemClassNamed("1002897", 1); // 사증모자
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM2, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 3)
		{
			trigger.addItemClassNamed("1002864", 1); // 여래지이
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM3, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 4)
		{
			trigger.addItemClassNamed("1002879", 1); // 건곤배낭
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM4, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 5)
		{
			trigger.addItemClassNamed("1002868", 1); // 여래불의 장심
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM5, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 6)
		{
			trigger.addItemClassNamed("1002861", 1); // 제사장의 투구
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM6, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 7)
		{
			trigger.addItemClassNamed("1002863", 1); // 우마왕 뿔투구
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM7, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 8)
		{
			trigger.addItemClassNamed("1002865", 1); // 천봉코
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM8, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 9)
		{
			trigger.addItemClassNamed("1002866", 1); // 우마왕 처의 파초선
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM9, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 10)
		{
			trigger.addItemClassNamed("1002869", 1); // 근두운
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM10, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 11)
		{
			trigger.addItemClassNamed("1002862", 1); // 금색 투구
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM11, MSG_TYPE__AUTOHIDE_WINDOW);
		}
		else if (mType == 12)
		{
			trigger.addItemClassNamed("1002867", 1); // 금은각의 호로병
			trigger.message("<c8>" + TEXT_SEOYUKI_ITEM12, MSG_TYPE__AUTOHIDE_WINDOW);
		}
	}
	if(mType==13)
	{
		trigger.addItemClassNamed("1002870", 5); // 서왕모의 반도
		trigger.message("<c8>" + TEXT_SEOYUKI_ITEM13, MSG_TYPE__AUTOHIDE_WINDOW);
	}

	if(mType==14)
	{
		trigger.addItemClassNamed("1002871", 10); // 태을진인의 선단
		trigger.message("<c8>" + TEXT_SEOYUKI_ITEM14, MSG_TYPE__AUTOHIDE_WINDOW);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1002883()			// 현란한 보물상자
{
	integer slot, Rvalue, tickTime;
	string cName, rName, timestamp;
	object give_item;
	string itemID = "";

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	Rvalue = Util.random(1, 12);

	if (Rvalue == 1) {				// 1002884		솜브레로
		itemID = "1002884";
		rName = TEXT_TAIWAN_200404_NAME01;
	} else if (Rvalue == 2) {		// 1002885		삐에로 모자
		itemID = "1002885";
		rName = TEXT_TAIWAN_200404_NAME02;
	} else if (Rvalue == 3) {		// 1002886		봉인된 검
		itemID = "1002886";
		rName = TEXT_TAIWAN_200404_NAME03;
	} else if (Rvalue == 4) {		// 1002887		무사 투구
		itemID = "1002887";
		rName = TEXT_TAIWAN_200404_NAME04;
	} else if (Rvalue == 5) {		// 1002888		물동이
		itemID = "1002888";
		rName = TEXT_TAIWAN_200404_NAME05;
	} else if (Rvalue == 6) {		// 1002889		날개 모자
		itemID = "1002889";
		rName = TEXT_TAIWAN_200404_NAME06;
	} else if (Rvalue == 7) {		// 1002890		날개 가방
		itemID = "1002890";
		rName = TEXT_TAIWAN_200404_NAME07;
	} else if (Rvalue == 8) {		// 1002891		사또모자
		itemID = "1002891";
		rName = TEXT_TAIWAN_200404_NAME08;
	} else if (Rvalue == 9) {		// 1002892		불멸의 왕의 뿔
		itemID = "1002892";
		rName = TEXT_TAIWAN_200404_NAME09;
	} else if (Rvalue == 10) {		// 1002893		연인모자(붉은색)
		itemID = "1002893";
		rName = TEXT_TAIWAN_200404_NAME10;
	} else if (Rvalue == 11) {		// 1002894		연인날개(붉은색)
		itemID = "1002894";
		rName = TEXT_TAIWAN_200404_NAME11;
	} else if (Rvalue == 12) {		// 1002895		연인신발(붉은색)
		itemID = "1002895";
		rName = TEXT_TAIWAN_200404_NAME12;
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	cName = trigger.getName();
	tickTime = Util.getTick();
	timestamp = Util.getYear(tickTime) + "/" + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime);
	Util.log("[" + timestamp + "] [GetFormActivity] + ITEM [" + itemID + "] TO [" + cName + "] [" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]");

	for (slot = trigger.getFirstItemSlot(); slot; slot = trigger.getNextItemSlot(slot)) {
		give_item = trigger.getCarryingItemInventory().at(slot);

		if (give_item.getClassName() == itemID) {
			give_item.setExpireTime(1209600);               // 14일 간 해당 아이템이 유지됨.
		}
	}
	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1002957()		// 짠 떡
{
	if (!NormalItemCanBeUsed()) return;

	// mp 150 회복
	if (!HardCode.itemUpMP(trigger, 150)) return;

	// 태극기 회복 처리. 임시
	if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
		ItemBalloonUpMP(trigger, 150);

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003012()   // 클럽 경험치 스크롤
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addGuildExp(100);		// guild exp 100 증가
	trigger.updateAttr();

	trigger.message("Nuo1l500 ??! B", MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003013()   // 클럽 경험치 스크롤2 ; xyzin 2004.10.4
{
	// 기존 클럽 경험치 스크롤 1003012 가 경치를 올려주는 양이 턱없이 부족하여 제작함.
	// 또한 위의 함수는 메시지안내와 실제 증가량이 500과 100으로 서로 다른데, 걍 둔다.

	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addGuildExp(1000000);		// guild exp 1000000 증가
	trigger.updateAttr();

	trigger.message("Nuo1l1000000 ??! B", MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003014()   // 클럽 경험치 스크롤3 ; xyzin 2004.10.4
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	trigger.addGuildExp(100000000);		// guild exp 100000000 증가
	trigger.updateAttr();

	trigger.message("Nuo1l100000000 ??! B", MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003045()   // 부화 단축의 스크롤
{
	object	petInventory;

	petInventory = trigger.getPetInventory();

	if (!NormalItemCanBeUsed()) return;
	if (trigger.hasPet()) return;

	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	//petInventory.setRemainTime(petInventory.remainTime()-36000);
	petInventory.setRemainTime(10);

	//trigger.message("?? Q?b??10b??f?_??", MSG_TYPE__SYSTEM);
	trigger.message(TEXT_PET_INCUBATION_SHORT_EXT1, MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003046()   // 부화 단축의 스크롤
{
	object	petInventory;

	if (!NormalItemCanBeUsed()) return;
	if (trigger.hasPet()) return;

	petInventory = trigger.getPetInventory();
	if(petInventory.remainTime()<=3600)
		return;


	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	petInventory.setRemainTime(petInventory.remainTime()-3600);

	trigger.message(TEXT_PET_INCUBATION_SHORT_EXT2, MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003047()   // 부화 단축의 스크롤
{
	object	petInventory;

	if (!NormalItemCanBeUsed()) return;
	if (trigger.hasPet()) return;

	petInventory = trigger.getPetInventory();
	if(petInventory.remainTime()<=600)
		return;


	// decrease number
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	petInventory.setRemainTime(petInventory.remainTime()-600);

	trigger.message(TEXT_PET_INCUBATION_SHORT_EXT3, MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

// qUseItem1003049()				// 플링의 꿈 퀘스트 파일에 있음. 내용 관리상 어쩔 수 없이 분리


quest
WritePUserID()
{
	string uID;
	uID = trigger.getQuestArgument();

	if (!trigger.hasTeam()) return;
	if (!trigger.isMemberNamedOfGroup(uID)) {
		trigger.message(uID + TEXT_RECALL_CANCEL, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getWorld().getNumber() < 391 || trigger.getWorld().getNumber() > 405) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getCarryingItemInventory().getCountClassNamed("1003050") < 1)
	{
		trigger.message(TEXT_DREAM_OF_PLING_NOT_USE, MSG_TYPE__SYSTEM);
		return;
	}
	else
	{
		// 대기실에 진입한 유저만 호출 가능
		trigger.recallAt(uID, 5);
		trigger.message(uID + TEXT_RECALL_TARGET, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_RECALL_TARGET_HELP, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
			controller.sweepNumbered(1);
	}
}


quest
qUseItem1003050()				// 환몽 스크롤
{
	if (!NormalItemCanBeUsed()) return;
	if (!trigger.isUser() || !trigger.isAlive())	return;

/*
	if (!trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
*/
	if (trigger.getWorld().getNumber() < 391 || trigger.getWorld().getNumber() > 405) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	trigger.sendDescribeQuestMessage(TEXT_DREAM_OF_PLING_USE, "WritePUserID", controller);
}


quest
WriteUserID()
{
	string uID;
	uID = trigger.getQuestArgument();

	if (!trigger.hasTeam()) return;
	if (!trigger.isMemberNamedOfGroup(uID)) {
		trigger.message(uID + TEXT_RECALL_CANCEL, MSG_TYPE__SYSTEM);
		return;
	}
	trigger.recall(uID);
	trigger.message(uID + TEXT_RECALL_TARGET, MSG_TYPE__SYSTEM);
	trigger.message(CANT_USE_TELEPORT_ITEM_SHORT_LEVEL, MSG_TYPE__SYSTEM);
	trigger.removeItemClassNamed("1003051", 1);
}

quest
qUseItem1003051()				// 팀원 소환 스크롤 (미구현)
{
	if (!NormalItemCanBeUsed()) return;
	if (!trigger.isUser() || !trigger.isAlive())	return;

	trigger.sendDescribeQuestMessage(TEXT_DREAM_OF_PLING_USE, "WriteUserID", controller);
}



quest
qUseItem1003052()				// 클럽원 소환 스크롤 (미구현)
{
	if (!NormalItemCanBeUsed()) return;
	if (!trigger.isUser() || !trigger.isAlive())	return;

	trigger.sendDescribeQuestMessage(TEXT_DREAM_OF_PLING_USE, "WriteUserID", controller);
}


quest
qUseItem1003053()				// 아미티스 요새 워프 카드
{
	string cName;
	object oUserClub, castle, loc;

	if (!NormalItemCanBeUsed()) return;
	if (!trigger.isUser() || !trigger.isAlive())	return;

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	oUserClub = trigger.getGuild(1);
	if (!oUserClub) return;

	cName = trigger.getName();
	if (oUserClub.getMemberType(cName) == GM_TYPE_VOLUNTEER) return;

//	castle = Castle.getNumbered(trigger.getWorld().getCastleNumber());
	castle = Castle.getNumbered(1);
	loc = Location.create();

	if (!castle) {
		return;
	}

	// 1번 요새 소지 상태인지 확인. 추후 요새 개수 늘어나면 수정하거나 다시 만들어야 한다.
	if (oUserClub.getName() != castle.getRulingGuildName()) {
//		trigger.message(CANT_GO_CASTLE_NO_HAVE, MSG_TYPE__SYSTEM);
		trigger.message(GO_CASTLE_1_FRONT, MSG_TYPE__SYSTEM);
		// 1번 요새 앞으로 이동
		loc.set(20, 610, 116);
		trigger.teleportTo(loc);
		return;
	}
	trigger.message(GO_CASTLE_1, MSG_TYPE__SYSTEM);

	// 1번 요새 워프의 방으로 이동
	loc.set(348, 120, 96);
	trigger.teleportTo(loc);
}

quest
qUseItem1003817()				// 칼데아 요새 워프 카드
{
	string cName;
	object oUserClub, castle, loc;

	if (!NormalItemCanBeUsed()) return;
	if (!trigger.isUser() || !trigger.isAlive())	return;

	if (!trigger.getWorld().canUseCustomWarp())
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().allowedWarpGroup() == 1)
	{
		trigger.message(CANT_USE_TELEPORT_ITEM_NOT_GROUP, MSG_TYPE__SYSTEM);
		return;
	}

	oUserClub = trigger.getGuild(1);
	if (!oUserClub) return;

	cName = trigger.getName();
	if (oUserClub.getMemberType(cName) == GM_TYPE_VOLUNTEER) return;

//	castle = Castle.getNumbered(trigger.getWorld().getCastleNumber());
	castle = Castle.getNumbered(2);
	loc	= Location.create();

	if (!castle)
	{
		return;
	}

	// 2번 요새 소지 상태인지 확인.
	if (oUserClub.getName() != castle.getRulingGuildName())
	{
//		trigger.message(CANT_GO_CASTLE_NO_HAVE, MSG_TYPE__SYSTEM);
		trigger.message(GO_CASTLE_1_FRONT, MSG_TYPE__SYSTEM);
		// 2번 요새 앞으로 이동
		loc.set(17, 800, 708);
		trigger.teleportTo(loc);
		return;
	}
	trigger.message(GO_CASTLE_2, MSG_TYPE__SYSTEM);

	// 2번 요새 워프의 방으로 이동
	loc.set(289, 120, 96);
	trigger.teleportTo(loc);
}


// 대만 5월 이벤트 (2004)
// 2004. 4. 10, 11, 12
// Written by mssi

quest
qUseItem1002926()			// 빨간 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
    	return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 100)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	rval = Util.random(0, 10000);

	// 1만 SEED	5%
	if(rval >= 9500)
	{
		trigger.setGold(trigger.getGold() + 10000);

		Item_Info = "From Red Present Box : +SEED [ 10000 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "10000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 2만 SEED	5%
	else if(rval >= 9000)
	{
		trigger.setGold(trigger.getGold() + 20000);

		Item_Info = "From Red Present Box : +SEED [ 20000 ] ";
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "20000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 3만 SEED	5%
	else if(rval >= 8500)
	{
		trigger.setGold(trigger.getGold() + 30000);
		Item_Info = "From Red Present Box : +SEED [ 30000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "30000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 5만 SEED	2%
	else if(rval >= 8300)
	{
		trigger.setGold(trigger.getGold() + 50000);
		Item_Info = "From Red Present Box : +SEED [ 50000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "50000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 8만 SEED	2%
	else if(rval >= 8100)
	{
		trigger.setGold(trigger.getGold() + 80000);
		Item_Info = "From Red Present Box : +SEED [ 80000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "80000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 20만 SEED	0.5%
	else if(rval >= 8050)
	{
		trigger.setGold(trigger.getGold() + 200000);
		Item_Info = "From Red Present Box : +SEED [ 200000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "200000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 힐릴포션(대) 100병	60%
	else if(rval >= 2050)
	{
		trigger.addItemClassNamed("1000018", 100);
		Item_Info = "From Red Present Box : +ITEM 100 [ 1000018 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 견습사 로브	2.5%
	else if(rval >= 1800)
	{
		trigger.addItemClassNamed("1000844", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1000844 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 중급 닌자복	2.5%
	else if(rval >= 1550)
	{
		trigger.addItemClassNamed("1002100", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002100 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 하프 아머	2.5%
	else if(rval >= 1300)
	{
		trigger.addItemClassNamed("1002080", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002080 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 스톤 아머	2.5%
	else if(rval >= 1050)
	{
		trigger.addItemClassNamed("1000823", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1000823 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 코튼 로브	2.5%
	else if(rval >= 800)
	{
		trigger.addItemClassNamed("1000845", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1000845 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 상급 닌자복	2.5%
	else if(rval >= 550)
	{
		trigger.addItemClassNamed("1002101", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002101 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 라이트 플레이트	2.5%
	else if(rval >= 300)
	{
		trigger.addItemClassNamed("1002081", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002081 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 코인 아머	2.5%
	else if(rval >= 50)
	{
		trigger.addItemClassNamed("1000824", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1000824 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 삐에로 모자	0.5%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1002689", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002689 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}


quest
qUseItem1002927()			// 주황색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 40)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	rval = Util.random(0, 10000);

	// 5만	5%
	if(rval >= 9500)
	{
		trigger.setGold(trigger.getGold() + 50000);
		Item_Info = "From Orange Present Box : +SEED [ 50000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "50000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 10만		5%
	else if(rval >= 9000)
	{
		trigger.setGold(trigger.getGold() + 100000);
		Item_Info = "From Orange Present Box : +SEED [ 100000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "100000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 15만		5%
	else if(rval >= 8500)
	{
		trigger.setGold(trigger.getGold() + 150000);
		Item_Info = "From Orange Present Box : +SEED [ 150000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "150000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 20만		1%
	else if(rval >= 8400)
	{
		trigger.setGold(trigger.getGold() + 200000);
		Item_Info = "From Orange Present Box : +SEED [ 200000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "200000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 40만		1%
	else if(rval >= 8300)
	{
		trigger.setGold(trigger.getGold() + 400000);
		Item_Info = "From Orange Present Box : +SEED [ 400000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "400000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 60만		0.5%
	else if(rval >= 8250)
	{
		trigger.setGold(trigger.getGold() + 600000);
		Item_Info = "From Orange Present Box : +SEED [ 600000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "600000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 키닝 키트	8%
	else if(rval >= 7450)
	{
		trigger.addItemClassNamed("1000090", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000090 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 샤프너	8%
	else if(rval >= 6650)
	{
		trigger.addItemClassNamed("1000089", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000089 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 스트랩	8%
	else if(rval >= 5850)
	{
		trigger.addItemClassNamed("1000092", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000092 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 경화제(소)	8%
	else if(rval >= 5050)
	{
		trigger.addItemClassNamed("1000104", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000104 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 마력강화제(소)	8%
	else if(rval >= 4250)
	{
		trigger.addItemClassNamed("1000098", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000098 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 탄성 로션(소)	8%
	else if(rval >= 3450)
	{
		trigger.addItemClassNamed("1000095", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000095 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 요정의 가호	8%
	else if(rval >= 2650)
	{
		trigger.addItemClassNamed("1000101", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000101 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 리저드 로브	2%
	else if(rval >= 2450)
	{
		trigger.addItemClassNamed("1000847", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000847 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 하이퍼 고기동 슈츠	1%
	else if(rval >= 2350)
	{
		trigger.addItemClassNamed("1002103", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1002103 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 세라믹 아머	1%
	else if(rval >= 2250)
	{
		trigger.addItemClassNamed("1002083", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1002083 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 브리간딘	1%
	else if(rval >= 2150)
	{
		trigger.addItemClassNamed("1000826", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000826 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 브리트라	1%
	else if(rval >= 2050)
	{
		trigger.addItemClassNamed("1000386", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000386 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 다마스커스	1%
	else if(rval >= 1950)
	{
		trigger.addItemClassNamed("1000365", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000365 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 아르마다	1%
	else if(rval >= 1850)
	{
		trigger.addItemClassNamed("1000344", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000344 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 어쌔신 대거	1%
	else if(rval >= 1750)
	{
		trigger.addItemClassNamed("1000281", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000281 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 크리사오르	1%
	else if(rval >= 1650)
	{
		trigger.addItemClassNamed("1000323", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000323 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 사이드 와인더	1%
	else if(rval >= 1550)
	{
		trigger.addItemClassNamed("1000470", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000470 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 장봉	1%
	else if(rval >= 1450)
	{
		trigger.addItemClassNamed("1000449", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000449 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 백열창	1%
	else if(rval >= 1350)
	{
		trigger.addItemClassNamed("1000428", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000428 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 월화도	1%
	else if(rval >= 1250)
	{
		trigger.addItemClassNamed("1000407", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000407 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 카빌라카	1%
	else if(rval >= 1150)
	{
		trigger.addItemClassNamed("1000638", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000638 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 스콜피언 테일	1%
	else if(rval >= 1050)
	{
		trigger.addItemClassNamed("1000472", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000472 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 이터널 스태프	1%
	else if(rval >= 950)
	{
		trigger.addItemClassNamed("1000659", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000659 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 실버 로드	1%
	else if(rval >= 850)
	{
		trigger.addItemClassNamed("1000680", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000680 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 아크 메이스	1%
	else if(rval >= 750)
	{
		trigger.addItemClassNamed("1000701", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000701 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 카산드라	1%
	else if(rval >= 650)
	{
		trigger.addItemClassNamed("1000302", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000302 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 중절모	2%
	else if(rval >= 450)
	{
		trigger.addItemClassNamed("1000800", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000800 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 턱시도 모자	2%
	else if(rval >= 250)
	{
		trigger.addItemClassNamed("1000804", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000804 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 문어모자	2%
	else if(rval >= 50)
	{
		trigger.addItemClassNamed("1000808", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1000808 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 날개 모자	0.5%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1002693", 1);
		Item_Info = "From Orange Present Box : +ITEM [ 1002693 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}

quest
qUseItem1002928()			// 노란색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;
	integer mx, my;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 6)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 10000);

	// 미스틱 스워드	10%
	if(rval >= 9000)
	{
		trigger.getWorld().genMonster("2100097", 1, "twSword.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100097 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 크노헨	7%
	else if(rval >= 8300)
	{
		trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100026 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 도플갱어 티치엘	10%
	else if(rval >= 7300)
	{
		trigger.getWorld().genMonster("2100050", 1, "twTichielD.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100050 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 포운	10%
	else if(rval >= 6300)
	{
		trigger.getWorld().genMonster("2100213", 1, "twFaun.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100213 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 파이어 엘리멘탈	10%
	else if(rval >= 5300)
	{
		trigger.getWorld().genMonster("2100096", 1, "twElemental.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100096 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 이머전시 아레네	10%
	else if(rval >= 4300)
	{
		trigger.getWorld().genMonster("2100126", 1, "twEAraene.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100126 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 스웜프 트럼프 돌	10%
	else if(rval >= 3300)
	{
		trigger.getWorld().genMonster("2100125", 1, "twDollSwamp.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100125 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 무투백호	10%
	else if(rval >= 2300)
	{
		trigger.getWorld().genMonster("2100124", 1, "twMutuhoWhite.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100124 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 그리폰	10%
	else if(rval >= 1300)
	{
		trigger.getWorld().genMonster("2100211", 1, "twGriffon.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100211 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 피콕	10%
	else if(rval >= 300)
	{
		trigger.getWorld().genMonster("2100093", 1, "twPicok.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Yellow Present Box : MONSTER [ 2100093 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 봉인된 검	0.1%
	else if(rval >= 290)
	{
		trigger.addItemClassNamed("1002690", 1);
		Item_Info = "From Yellow Present Box : +ITEM [ 1002690 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 무사 투구	2.5%
	else if(rval >= 40)
	{
		trigger.addItemClassNamed("1002691", 1);
		Item_Info = "From Yellow Present Box : +ITEM [ 1002691 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 윙 슈즈	0.4%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1000961", 1);
		Item_Info = "From Yellow Present Box : +ITEM [ 1000961 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}

quest
qUseItem1002929()			// 흰색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;
	integer mx, my;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 6)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 10000);

	// 젤리삐	10%
	if(rval >= 9000)
	{
		trigger.getWorld().genMonster("2100009", 1, "twJellypi.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100009 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 미라꿀	10%
	else if(rval >= 8000)
	{
		trigger.getWorld().genMonster("2100069", 1, "twBearPig.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100069 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 허니베어	10%
	else if(rval >= 7000)
	{
		trigger.getWorld().genMonster("2100004", 1, "twHoneyBear.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100004 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 크레미노	10%
	else if(rval >= 6000)
	{
		trigger.getWorld().genMonster("2100042", 1, "twCramino.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100042 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}

	// 포이즌 스콜피노	10%
	else if(rval >= 5000)
	{
		trigger.getWorld().genMonster("2100061", 1, "twGrScorpion.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100061 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 샤피어	10%
	else if(rval >= 4000)
	{
		trigger.getWorld().genMonster("2100141", 1, "twSyaPeer.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100141 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 레드 위키드	10%
	else if(rval >= 3000)
	{
		trigger.getWorld().genMonster("2100089", 1, "twRedWiKid.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100089 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 무스챠파	10%
	else if(rval >= 2000)
	{
		trigger.getWorld().genMonster("2100156", 1, "twStelmeto.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From White Present Box : MONSTER [ 2100156 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 1만	10%
	else if(rval >= 1000)
	{
		trigger.setGold(trigger.getGold() + 10000);
		Item_Info = "From White Present Box : +SEED [ 10000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "10000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 2만	5%
	else if(rval >= 500)
	{
		trigger.setGold(trigger.getGold() + 20000);
		Item_Info = "From White Present Box : +SEED [ 20000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "20000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 3만	3%
	else if(rval >= 200)
	{
		trigger.setGold(trigger.getGold() + 30000);
		Item_Info = "From White Present Box : +SEED [ 30000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "30000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 5만	1.9%
	else if(rval >= 10)
	{
		trigger.setGold(trigger.getGold() + 50000);
		Item_Info = "From White Present Box : +SEED [ 50000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "50000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 윙 슈즈	0.1%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1000961", 1);
		Item_Info = "From White Present Box : +ITEM [ 1000961 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}

quest
qUseItem1002930()			// 파란색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 42)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	rval = Util.random(0, 10000);

	// 20만 시드	40%
	if(rval >= 6000)
	{
		trigger.setGold(trigger.getGold() + 200000);
		Item_Info = "From Blue Present Box : +SEED [ 200000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "200000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 30만	30%
	else if(rval >= 3000)
	{
		trigger.setGold(trigger.getGold() + 300000);
		Item_Info = "From Blue Present Box : +SEED [ 300000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "300000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 50만	10%
	else if(rval >= 2000)
	{
		trigger.setGold(trigger.getGold() + 500000);
		Item_Info = "From Blue Present Box : +SEED [ 500000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "500000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 고스트 로브	2%
	else if(rval >= 1800)
	{
		trigger.addItemClassNamed("1000850", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000850 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 미라쥬 슈츠	1%
	else if(rval >= 1700)
	{
		trigger.addItemClassNamed("1002106", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1002106 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 스플린트 메일	2%
	else if(rval >= 1500)
	{
		trigger.addItemClassNamed("1000829", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000829 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 일진문자	1%
	else if(rval >= 1400)
	{
		trigger.addItemClassNamed("1000389", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000389 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 쿠사이	1%
	else if(rval >= 1300)
	{
		trigger.addItemClassNamed("1000368", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000368 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 시엔 브레이커	1%
	else if(rval >= 1200)
	{
		trigger.addItemClassNamed("1000347", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000347 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 팅 에디아	1%
	else if(rval >= 1100)
	{
		trigger.addItemClassNamed("1000284", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000284 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 블러드 소드	1%
	else if(rval >= 1000)
	{
		trigger.addItemClassNamed("1000326", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000326 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 다이아 히트	1%
	else if(rval >= 900)
	{
		trigger.addItemClassNamed("1000473", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000473 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 문 라이트 스틱	1%
	else if(rval >= 800)
	{
		trigger.addItemClassNamed("1000452", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000452 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 라바 스피어	1%
	else if(rval >= 700)
	{
		trigger.addItemClassNamed("1000431", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000431 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 도성도	1%
	else if(rval >= 600)
	{
		trigger.addItemClassNamed("1000410", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000410 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 리버 액스	1%
	else if(rval >= 500)
	{
		trigger.addItemClassNamed("1000641", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000641 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 파이어 쇼크	1%
	else if(rval >= 400)
	{
		trigger.addItemClassNamed("1000620", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000620 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 안켈로시나 티어	1%
	else if(rval >= 300)
	{
		trigger.addItemClassNamed("1000662", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000662 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 프린세스 로드	1%
	else if(rval >= 200)
	{
		trigger.addItemClassNamed("1000683", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000683 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 레인보우	1%
	else if(rval >= 100)
	{
		trigger.addItemClassNamed("1000704", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000704 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 벨모어	1%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1000305", 1);
		Item_Info = "From Blue Present Box : +ITEM [ 1000305 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}

quest
qUseItem1002931()			// 녹색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;
	integer mx, my;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 43)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 10000);

	// 30만 시드	20%
	if(rval >= 8000)
	{
		trigger.setGold(trigger.getGold() + 300000);
		Item_Info = "From Green Present Box : +SEED [ 300000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "300000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 50만	5%
	else if(rval >= 7500)
	{
		trigger.setGold(trigger.getGold() + 500000);
		Item_Info = "From Green Present Box : +SEED [ 500000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "500000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 70만	5%
	else if(rval >= 7000)
	{
		trigger.setGold(trigger.getGold() + 700000);
		Item_Info = "From Green Present Box : +SEED [ 700000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "700000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 80만	5%
	else if(rval >= 6500)
	{
		trigger.setGold(trigger.getGold() + 800000);
		Item_Info = "From Green Present Box : +SEED [ 800000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "800000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 90만	5%
	else if(rval >= 6000)
	{
		trigger.setGold(trigger.getGold() + 900000);
		Item_Info = "From Green Present Box : +SEED [ 900000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "900000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 100만	5%
	else if(rval >= 5500)
	{
		trigger.setGold(trigger.getGold() + 1000000);
		Item_Info = "From Green Present Box : +SEED [ 1000000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "1000000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 크노헨	0.8%
	else if(rval >= 5420)
	{
		trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Green Present Box : MONSTER [ 2100026 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 윙 오브 피닉스	0.1%
	else if(rval >= 5410)
	{
		trigger.addItemClassNamed("1002658", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002658 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 윙 오브 크로우	0.1%
	else if(rval >= 5400)
	{
		trigger.addItemClassNamed("1002659", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002659 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 체험 스크롤 (10000경험치) 9%
	else if(rval >= 4500)
	{
		trigger.addItemClassNamed("100277", 1);
		Item_Info = "From Green Present Box : +ITEM [ 100277 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 엔젤릭 이어링	5%
	else if(rval >= 4000)
	{
		trigger.addItemClassNamed("1000901", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000901 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 고양이 가면	5%
	else if(rval >= 3500)
	{
		trigger.addItemClassNamed("1002164", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002164 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 여우 가면	5%
	else if(rval >= 3000)
	{
		trigger.addItemClassNamed("1002165", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002165 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 늑대 가면	5%
	else if(rval >= 2500)
	{
		trigger.addItemClassNamed("1002166", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002166 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 악마의 뿔	5%
	else if(rval >= 2000)
	{
		trigger.addItemClassNamed("1001204", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1001204 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 프로텍터	2%
	else if(rval >= 1800)
	{
		trigger.addItemClassNamed("1000851", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000851 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 하이퍼 미라쥬 슈츠	2%
	else if(rval >= 1600)
	{
		trigger.addItemClassNamed("1002107", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1002107 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 밴디드 메일	1%
	else if(rval >= 1500)
	{
		trigger.addItemClassNamed("1000830", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000830 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 붉은 바람	1%
	else if(rval >= 1400)
	{
		trigger.addItemClassNamed("1000390", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000390 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 애취설	1%
	else if(rval >= 1300)
	{
		trigger.addItemClassNamed("1000369", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000369 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 노토스	1%
	else if(rval >= 1200)
	{
		trigger.addItemClassNamed("1000348", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000348 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 오팔	1%
	else if(rval >= 1100)
	{
		trigger.addItemClassNamed("1000285", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000285 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 레번테인	1%
	else if(rval >= 1000)
	{
		trigger.addItemClassNamed("1000327", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000327 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 섀도우 댄서	1%
	else if(rval >= 900)
	{
		trigger.addItemClassNamed("1000474", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000474 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 실버 라이팅	1%
	else if(rval >= 800)
	{
		trigger.addItemClassNamed("1000453", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000453 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 볼케이토스	1%
	else if(rval >= 700)
	{
		trigger.addItemClassNamed("1000432", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000432 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 파화도	1%
	else if(rval >= 600)
	{
		trigger.addItemClassNamed("1000411", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000411 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 부로바	1%
	else if(rval >= 500)
	{
		trigger.addItemClassNamed("1000642", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000642 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 잰	1%
	else if(rval >= 400)
	{
		trigger.addItemClassNamed("1000621", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000621 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 원더윈드 스태프	1%
	else if(rval >= 300)
	{
		trigger.addItemClassNamed("1000663", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000663 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 마도사의 로드	1%
	else if(rval >= 200)
	{
		trigger.addItemClassNamed("1000684", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000684 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 퍼니쉬먼트	1%
	else if(rval >= 100)
	{
		trigger.addItemClassNamed("1000705", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000705 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 잉카로즈	1%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1000306", 1);
		Item_Info = "From Green Present Box : +ITEM [ 1000306 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}

quest
qUseItem1002932()			// 무지개색 선물상자 (2004 대만 5월)
{
	integer rval;
	integer wNum;
	integer tickTime;
	integer mx, my;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 사용 불가능 지역 처리
	// 싸움 가능 지역이 아닌 경우 체크
	if(trigger.getWorld().canFight() == false)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 6)
	{
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 10000);

	// 윙 오브 피닉스	0.1%
	if(rval >= 9990)
	{
		trigger.addItemClassNamed("1002658", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002658 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 윙 오브 크로우	0.1%
	else if(rval >= 9980)
	{
		trigger.addItemClassNamed("1002659", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002659 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 유치원 가방	4%
	else if(rval >= 9580)
	{
		trigger.addItemClassNamed("1002324", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002324 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 5만	15%
	else if(rval >= 8080)
	{
		trigger.setGold(trigger.getGold() + 50000);
		Item_Info = "From Rainbow Present Box : +SEED [ 50000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "50000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 10만	7%
	else if(rval >= 7380)
	{
		trigger.setGold(trigger.getGold() + 100000);
		Item_Info = "From Rainbow Present Box : +SEED [ 100000 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "100000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
	}
	// 리프 머리띠	15%
	else if(rval >= 5880)
	{
		trigger.addItemClassNamed("1000907", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1000907 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 고양이 귀	10%
	else if(rval >= 4880)
	{
		trigger.addItemClassNamed("1000908", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1000908 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 뚜뚜 더듬이 머리띠	10%
	else if(rval >= 3880)
	{
		trigger.addItemClassNamed("1000909", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1000909 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 날개 가방	0.8%
	else if(rval >= 3800)
	{
		trigger.addItemClassNamed("1002694", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002694 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 토끼 풀꽃 화관	10%
	else if(rval >= 2800)
	{
		trigger.addItemClassNamed("1002161", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002161 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 검투사 투구	2%
	else if(rval >= 2600)
	{
		trigger.addItemClassNamed("1002223", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002223 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 괴도 샤르 가면	2%
	else if(rval >= 2400)
	{
		trigger.addItemClassNamed("1002233", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002233 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 뱅뱅 안경	4%
	else if(rval >= 2000)
	{
		trigger.addItemClassNamed("1002235", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002235 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 빨간 코	4%
	else if(rval >= 1600)
	{
		trigger.addItemClassNamed("1002656", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002656 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 뽀글머리	4%
	else if(rval >= 1200)
	{
		trigger.addItemClassNamed("1002649", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002649 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 응가 모자	4%
	else if(rval >= 800)
	{
		trigger.addItemClassNamed("1002226", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002226 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 학사모	4%
	else if(rval >= 400)
	{
		trigger.addItemClassNamed("1002227", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002227 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 군밤모자	4%
	else if(rval >= 0)
	{
		trigger.addItemClassNamed("1002228", 1);
		Item_Info = "From Rainbow Present Box : +ITEM [ 1002228 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
}


quest
qUseItem1002171()			// 축복받은 선물상자 (2004 5월 운영 이벤트 by stsoul)
{
	object rank;
	integer rval, mx, my;
	integer tickTime;
	integer wNum, rCount, wDay, rType, iBirth;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 싸움 가능 지역이 아닌 경우 체크
	if(!trigger.getWorld().canFight()) {
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 초보자 던전에서 사용 불가능
	if (wNum == 422 || wNum == 423 || wNum == 424)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 길이 좁은 연결통 맵
	if(wNum == 91 || wNum == 92 || wNum == 48 || wNum == 51 || wNum == 114 || wNum == 124)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 90) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	tickTime = Util.getTick();
	wDay = Util.getWday(tickTime);

	// 중국 대응 추가 작업. 공용 사용할 수 있게 구조 변경
	rType = Util.getRealNationType();

	if (rType == KOREA || rType == JAPAN)
	{
		// Log Info
	
		userName = trigger.getName();

		time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
		world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

		mx =  trigger.getX();
		my =  trigger.getY();

		rval = Util.random(0, 100);

		// 1만 SEED		5%
		if(rval >= 95) {
			trigger.setGold(trigger.getGold() + 10000);

			Item_Info = "From Red Present Box : +SEED [ 10000 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "10000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}

		// 2만 SEED		4%
		else if(rval >= 91) {
			trigger.setGold(trigger.getGold() + 20000);

			Item_Info = "From Red Present Box : +SEED [ 20000 ] ";
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "20000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}

		// 4만 SEED		3%
		else if(rval >= 88) {
			trigger.setGold(trigger.getGold() + 40000);
			Item_Info = "From Red Present Box : +SEED [ 40000 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "40000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}

		// 8만 SEED		2%
		else if(rval >= 86) {
			trigger.setGold(trigger.getGold() + 80000);
			Item_Info = "From Red Present Box : +SEED [ 80000 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "80000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}

		// 10만 SEED	1%
		else if(rval >= 85) {
			trigger.setGold(trigger.getGold() + 100000);
			Item_Info = "From Red Present Box : +SEED [ 100000 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "100000" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}

		// 블러디 돌	3%
		else if(rval >= 82) {
			trigger.getWorld().genMonster("2100221", 1, "twMechanic.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100221 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 크노헨		3%
		else if(rval >= 79) {
			trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100026 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 진아지다하카	5%
		else if(rval >= 74) {
			trigger.getWorld().genMonster("2100119", 1, "twAzidahaka_J.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100119 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 데스프레타	5%
		else if(rval >= 69) {
			trigger.getWorld().genMonster("2100118", 1, "twFretaDeath.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100118 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 젤리킹	7%
		else if(rval >= 62) {
			trigger.getWorld().genMonster("2100239", 1, "twJellyKing_Dark.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100239 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 뚜뚜퀸	7%
		else if(rval >= 55) {
			trigger.getWorld().genMonster("2100195", 1, "twDduQueen.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100195 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 뚜뚜킹	7%
		else if(rval >= 48) {
			trigger.getWorld().genMonster("2100194", 1, "twDduKing.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100195 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 엔피니온	7%
		else if(rval >= 41) {
			trigger.getWorld().genMonster("2100109", 1, "twEnvinion.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100109 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 포세이른	8%
		else if(rval >= 33) {
			trigger.getWorld().genMonster("2100193", 1, "twPoseidon.ptn", 1, mx-10, my-10, mx+10, my+10);
			Item_Info = "From White Present Box : MONSTER [ 2100193 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}

		// 괴도 샤른 가면	1%
		else if(rval >= 32) {
			trigger.addItemClassNamed("1002233", 1);
			Item_Info = "From Rainbow Present Box : +ITEM [ 1002233 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 제련키트	4%
		else if(rval >= 28) {
			trigger.addItemClassNamed("1000091", 1);
			Item_Info = "From Red Present Box : +ITEM 1 [ 1000091 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 그라인더	4%
		else if(rval >= 24) {
			trigger.addItemClassNamed("1000094", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1000094 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 마력강화제(대)	4%
		else if(rval >= 20) {
			trigger.addItemClassNamed("1000100", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1000100 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 여신의가호	4%
		else if(rval >= 16) {
			trigger.addItemClassNamed("1000103", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1000103 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 탄성로션(대)	4%
		else if(rval >= 12) {
			trigger.addItemClassNamed("1000097", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1000097 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 윙 슈즈	2%
		else if(rval >= 10) {
			trigger.addItemClassNamed("1000961", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1000961 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		// 체험 스크롤	10% 1만짜리...
		else {
			trigger.addItemClassNamed("1002777", 1);
			Item_Info = "From Red Present Box : +ITEM [ 1002777 ] ";

			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}

		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		Util.log(time_Info + Item_Info + world_Info);
		controller.effectBy(trigger);
	}
	else if (rType == CHINA)
	{
		// Log Info
		tickTime = Util.getTick();
		userName = trigger.getName();

		mx =  trigger.getX();
		my =  trigger.getY();

		rval = Util.random(0, 10000);

		iBirth = trigger.getBirthTime();

		// 주말 보정 기능
		if (Util.getWday(tickTime) == 0)	{
			if (rval > 4400)		rval = rval - 200;
		} else if (Util.getWday(tickTime) == 1)	{
			if (rval > 4400)		rval = rval - 100;
		}

		// 5%	크노헨(혼란동굴9층)
		if(rval >= 9500)
		{
			trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// 5%	진 아지다하카
		else if(rval >= 9000)
		{
			trigger.getWorld().genMonster("2100119", 1, "twAzidahaka_J.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// 5%	데스 프레타
		else if(rval >= 8500)
		{
			trigger.getWorld().genMonster("2100118", 1, "twFretaDeath.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// 5%	뚜뚜킹
		else if(rval >= 8000)
		{
			trigger.getWorld().genMonster("2100194", 1, "twDduKing.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// 5%	호검희
		else if(rval >= 7500)
		{
			trigger.getWorld().genMonster("2100557", 1, "twFeb22_SwordShaman.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// 5%	스어삐
		else if(rval >= 7000)
		{
			trigger.getWorld().genMonster("2100499", 1, "twNov04_Saerpi.ptn", 1, mx-10, my-10, mx+10, my+10);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
		}
		// ***********************************************************************************************
		// 여기서부터 아이템~
		// ***********************************************************************************************
		// 3%	샤크바리두건
		else if(rval >= 6700)
		{
			trigger.addItemClassNamed("1002923", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
		// 3%	죠안두건
		else if(rval >= 6400)
		{
			trigger.addItemClassNamed("1002922", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
		// 3%	밍밍
		else if(rval >= 6100)
		{
			trigger.addItemClassNamed("1002924", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
		// 1%	마도사 리본
		else if(rval >= 6000)
		{
			rank = Rank.select("CHI_EVENT1_ITEM");
			rCount = rank.getCount();

			if(rCount < 1)
		   	{
		   	    rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1002908", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			} else {
				trigger.addItemClassNamed("1000033", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			}
		}
		// 1%	홍염의 갑옷
		else if(rval >= 5900)
		{
			rank = Rank.select("CHI_EVENT2_ITEM");
			rCount = rank.getCount();

			if(rCount < 1)
		   	{
		   	    rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000989", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			} else {
				trigger.addItemClassNamed("1000033", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			}
		}
		// 1%	홍염의 날개
		else if(rval >= 5800)
		{
		    rank = Rank.select("CHI_EVENT3_ITEM");
			rCount = rank.getCount();

			if(rCount < 1)
		   	{
		   	    rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000988", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			} else {
				trigger.addItemClassNamed("1000033", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			}
		}
		// 1%	홍염의 팔찌
		else if(rval >= 5700)
		{
		    trigger.addItemClassNamed("1000990", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		// 1%	홍염의 투구
		else if(rval >= 5600)
		{
		    trigger.addItemClassNamed("1000987", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		// 1%	홍염의 슈즈
		else if(rval >= 5500)
		{
			trigger.addItemClassNamed("1000991", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		// 1%	빙한의 갑옷
		else if(rval >= 5400)
		{
			rank = Rank.select("CHI_EVENT4_ITEM");
			rCount = rank.getCount();

			if(rCount < 1)
		   	{
		   	    rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000994", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			} else {
				trigger.addItemClassNamed("1000033", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			}
		}
		// 1%	빙한의 날개
		else if(rval >= 5300)
		{
			rank = Rank.select("CHI_EVENT5_ITEM");
			rCount = rank.getCount();

			if(rCount < 1)
		   	{
		   	    rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000993", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			} else {
				trigger.addItemClassNamed("1000033", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			}
		}
		// 1%	빙한의 팔찌
		else if(rval >= 5200)
		{
			trigger.addItemClassNamed("1000995", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		// 1%	빙한의 투구
		else if(rval >= 5100)
		{
			trigger.addItemClassNamed("1000992", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		// 1001809	1%	빙한의 슈즈
		else if(rval >= 5000)
		{
			trigger.addItemClassNamed("1000996", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
		}
		//	25%	6001 SEED
		else if(rval >= 2500)
		{
			trigger.setGold(trigger.getGold() + 6001);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_SEED1 + "6001" + TEXT_USABLEITEM_BOX_IN_SEED2, trigger);
		}
		// 1001808	25%	인크립트 스크롤
		else
		{
			trigger.addItemClassNamed("1001808", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
}


quest
qUseItem1002953()				// OX 이벤트 제어 상자
{
	// 사용시 클럽장 OX맵 대기실로 이동 처리. 끄고나서 이동할 수 있다.
	object loc;

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	loc = Location.create();
	loc.set(340, 110, 150);
	trigger.teleportTo(loc);
}


quest
qUseItem1003021()			// 큐피트의 선물 (2004 6월 운영 이벤트 by stsoul)
{
	integer rval, mx, my;
	integer tickTime;

	string userName;
	string time_Info, world_Info, Item_Info;

	// 싸움 가능 지역이 아닌 경우 체크
	if(!trigger.getWorld().canFight()) {
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 슬롯 체크
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
	if (trigger.getAvailInvenWeight() < 90) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	mx =  trigger.getX();
	my =  trigger.getY();

	rval = Util.random(0, 100);

	// 인크립트 스크롤	3%
	if(rval >= 97) {
		trigger.addItemClassNamed("1001808", 1);
		Item_Info = "From Present Box : +ITEM 1 [ 1001808 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 제련키트	5%
	else if(rval >= 92) {
		trigger.addItemClassNamed("1000091", 1);
		Item_Info = "From Present Box : +ITEM 1 [ 1000091 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 그라인더	5%
	else if(rval >= 87) {
		trigger.addItemClassNamed("1000094", 1);
		Item_Info = "From Present Box : +ITEM [ 1000094 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 마력강화제(대)	5%
	else if(rval >= 82) {
		trigger.addItemClassNamed("1000100", 1);
		Item_Info = "From Present Box : +ITEM [ 1000100 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 크노헨		3%
	else if(rval >= 79) {
		trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100026 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 진아지다하카	5%
	else if(rval >= 74) {
		trigger.getWorld().genMonster("2100119", 1, "twAzidahaka_J.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100119 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 데스프레타	5%
	else if(rval >= 69) {
		trigger.getWorld().genMonster("2100118", 1, "twFretaDeath.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100118 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 젤리킹	6%
	else if(rval >= 63) {
		trigger.getWorld().genMonster("2100239", 1, "twJellyKing_Dark.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100239 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 뚜뚜퀸	6%
	else if(rval >= 57) {
		trigger.getWorld().genMonster("2100195", 1, "twDduQueen.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100195 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 뚜뚜킹	6%
	else if(rval >= 51) {
		trigger.getWorld().genMonster("2100194", 1, "twDduKing.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100195 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 엔피니온	6%
	else if(rval >= 45) {
		trigger.getWorld().genMonster("2100109", 1, "twEnvinion.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100109 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 포세이른	6%
	else if(rval >= 39) {
		trigger.getWorld().genMonster("2100193", 1, "twPoseidon.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100193 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 블러디 돌	3%
	else if(rval >= 36) {
		trigger.getWorld().genMonster("2100221", 1, "twMechanic.ptn", 1, mx-10, my-10, mx+10, my+10);
		Item_Info = "From Present Box : MONSTER [ 2100221 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 여신의가호	5%
	else if(rval >= 31) {
		trigger.addItemClassNamed("1000103", 1);
		Item_Info = "From Present Box : +ITEM [ 1000103 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 탄성로션(대)	5%
	else if(rval >= 26) {
		trigger.addItemClassNamed("1000097", 1);
		Item_Info = "From Present Box : +ITEM [ 1000097 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 투구	3%
	else if(rval >= 23) {
		trigger.addItemClassNamed("1003265", 1);
		Item_Info = "From Present Box : +ITEM 1 [ 1002793 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 방패	3%
	else if(rval >= 20) {
		trigger.addItemClassNamed("1003266", 1);
		Item_Info = "From Present Box : +ITEM [ 1002794 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 비녀	3%
	else if(rval >= 17) {
		trigger.addItemClassNamed("1003267", 1);
		Item_Info = "From Present Box : +ITEM [ 1002795 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 날개	3%
	else if(rval >= 14) {
		trigger.addItemClassNamed("1003268", 1);
		Item_Info = "From Present Box : +ITEM [ 1002796 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 갑옷	3%
	else if(rval >= 11) {
		trigger.addItemClassNamed("1003269", 1);
		Item_Info = "From Present Box : +ITEM [ 1002797 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 슈즈	3%
	else if(rval >= 8) {
		trigger.addItemClassNamed("1003270", 1);
		Item_Info = "From Present Box : +ITEM [ 1002798 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 큐피트 장갑	3%
	else if(rval >= 5) {
		trigger.addItemClassNamed("1003271", 1);
		Item_Info = "From Present Box : +ITEM [ 1002799 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 체험 스크롤	5% 1만짜리...
	else {
		trigger.addItemClassNamed("1002777", 1);
		Item_Info = "From Red Present Box : +ITEM [ 1002777 ] ";

		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	Util.log(time_Info + Item_Info + world_Info);
	controller.effectBy(trigger);
}


quest
qPickItemTimer()							// 아이템 집었을 때 소멸 시간 설정하는 아이템.
{
	controller.setExpireTime(86400);				// 24시간 동안 해당 아이템이 유지됨.
	trigger.message(TEXT_EXPIRE_START, MSG_TYPE__SYSTEM);
}


quest
qDropItemLost()								// 몬스터가 아이템 떨구면 소멸 처리.
{
	controller.sweep();
}


quest
qCanDropItemLost()							// 유저가 아이템 떨구기만 금지.
{
	if (trigger.isUser())
		Machine.setBooleanReturn(false);
	else
		Machine.setBooleanReturn(true);
}


/* 너무너무 비효율적인 방식이라서 사용하지 않기로 했다 -_- by stsoul
function
boolean
fOXAuto(object targetMap, object TelLoc)
{
	integer endX, endY;
	integer countX, countY;
	object loc;

	endX = targetMap.getXSize();
	endY = targetMap.getYSize();

	for (countX = 0; countX < endX; ++countX) {
	    for (countY = 0; countY < endY; ++countY) {
		    loc = Visible.at(countX, countY);
			// 속도 문제가 있지만 유저 몽땅 내보내기 위해서...
			if (loc && loc.isPortal()) continue;
			while (loc && loc.isUser() && loc != trigger) {
				// loc.teleportTo(loc.lastVisitedVillageLoc());
				loc.teleportTo(TelLoc);
			    loc = Visible.at(countX, countY);
			}
		}
	}
	return true;
}
*/


quest
qUseItem1003054()				// 정답 처리 아이템 (O)
{
	integer bType, mType;
	object targetMap;

	bType = trigger.getBuilderType();
	mType = trigger.getWorld().getNumber();

	if (bType == 1 || bType == 2 || bType == 3 || bType == 5) {
		if (mType == 120 || mType == 324 || mType == 326) {
			// 대기실 유저 내쫓기
			targetMap = World.getNumbered(326);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
			// X맵의 오답 유저 내쫓기
			targetMap = World.getNumbered(324);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
//			targetMap.moveAllUserTo(82, 190, 190);
			// O맵의 정답 유저 대기실로 이동
			targetMap = World.getNumbered(120);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_GOOD, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(326, 110, 150);
		} else {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	} else if (trigger.getCarryingItemInventory().getCountClassNamed("1002953") >= 1) {
		if (mType == 336 || mType == 339 || mType == 340) {
			// 대기실 유저 내쫓기
			targetMap = World.getNumbered(340);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
			// X맵의 오답 유저 내쫓기
			targetMap = World.getNumbered(339);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
//			targetMap.moveAllUserTo(82, 190, 190);
			// O맵의 정답 유저 대기실로 이동
			targetMap = World.getNumbered(336);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_O + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_GOOD, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(340, 110, 150);
		} else {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	}
}


quest
qUseItem1003055()				// 정답 처리 아이템 (X)
{
	integer bType, mType;
	object targetMap;

	bType = trigger.getBuilderType();
	mType = trigger.getWorld().getNumber();

	if (bType == 1 || bType == 2 || bType == 3 || bType == 5) {
		if (mType == 120 || mType == 324 || mType == 326) {
			// 대기실 유저 내쫓기
			targetMap = World.getNumbered(326);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
			// O맵의 오답 유저 내쫓기
			targetMap = World.getNumbered(120);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
//			targetMap.moveAllUserTo(82, 190, 190);
			// X맵의 정답 유저 대기실로 이동
			targetMap = World.getNumbered(324);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_GOOD, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(326, 110, 150);
		} else {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	} else if (trigger.getCarryingItemInventory().getCountClassNamed("1002953") >= 1) {
		if (mType == 336 || mType == 339 || mType == 340) {
			// 대기실 유저 내쫓기
			targetMap = World.getNumbered(340);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
			// O맵의 오답 유저 내쫓기
			targetMap = World.getNumbered(336);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_SORRY, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(1, 300, 300);
//			targetMap.moveAllUserTo(82, 190, 190);
			// X맵의 정답 유저 대기실로 이동
			targetMap = World.getNumbered(339);
			targetMap.broadcast("<c8>" + TEXT_USABLEITEM_OX_ANSWER_X + "</n></n>" + TEXT_USABLEITEM_OX_ANSWER_GOOD, MSG_TYPE__AUTOHIDE_WINDOW);
			Util.sleep(1);
			targetMap.moveAllUserTo(340, 110, 150);
		} else {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return;
		}
	}
}


quest
qUseItem1003056()				// OX 추방 아이템
{
	object target;
	object loc;

	target = controller.getObjectArgumentAt(0);

	if (!target)	return;

	if (!target.isAlive()) {
	    trigger.message(GHOST_CANT_USE, MSG_TYPE__SYSTEM);
	    return;
	}

	if(target.getWorld().getNumber() == 336 || target.getWorld().getNumber() == 339 || target.getWorld().getNumber() == 340) {
		loc = Location.create();
		loc.set(82, 190, 190);
		target.teleportTo(loc);
	} else {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
}


//*********************************************************************************
// 이 아래로 잘라서 리액터 연동 아이템.
//*********************************************************************************
// 던지는 이펙트는 아이템 사용 이펙트로... 서버에서 좌표가 오지 않으면 클라이언트가 아는 데이터로 처리


quest
qUseItem1001991()				// 지뢰제거기. 지뢰 종류 추가 되면 여기서 체크하는 리스트를 확장해야 함.
{
	integer	indexnumber, tile, dnd;
	integer startX, startY, endX, endY;
	integer defX, defY, countX, countY, cntChk;
	object loc;

	if (!NormalItemCanBeUsed()) return;

	loc = Visible.at(trigger.getX(), trigger.getY());

	startX = trigger.getX() - 2;
	startY = trigger.getY() - 2;
	endX = trigger.getX() + 2;
	endY = trigger.getY() + 2;
	defX = startX;
	defY = startY;
	cntChk = 3;
	dnd = 0;

	for (countX = 0; countX < cntChk; ++countX) {
		for (countY = 0; countY < cntChk; ++countY) {
			loc = Visible.at(defX, defY);
			if (loc && loc.isReactor()) {
				tile = loc.getTile();
				if (tile >= 9000274 && tile <= 9000287) {
					if (dnd == 0) {
						trigger.message(TEXT_USABLEITEM_DEL_BOMB, MSG_TYPE__SYSTEM);
						indexnumber = loc.getIndexNumber();
						trigger.getWorld().setReactorDuration(indexnumber, 0);
						dnd = 99;
					}
				}
			}
			defY = defY + 1;
		}
		defY = startY;
		defX = defX + 1;
	}

	if (dnd != 99) {
		trigger.message(TEXT_USABLEITEM_CANT_DEL_BOMB, MSG_TYPE__SYSTEM);
		return;
	}

	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	controller.effectBy(trigger);
}


function
boolean
qFireItem(string PKR, string NPKR, integer S_LV, integer cntChk)
{
	integer	duration;
	integer startX, startY, endX, endY;
	integer defX, defY, countX, countY, DMG;
	object target, loc;

	target = controller.getPointArgumentAt(0);
	if (!target) return false;

	// 3*3, 2*2 로 레벨당 증가
	startX = target.getX() - S_LV;
	startY = target.getY() - S_LV;
	endX = target.getX() + S_LV;
	endY = target.getY() + S_LV;
	defX = startX;
	defY = startY;

	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	for (countX = 0; countX < cntChk; ++countX) {
		for (countY = 0; countY < cntChk; ++countY) {
			loc = Visible.at(defX, defY);
			if (loc && loc.isPortal()) {
				trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR, MSG_TYPE__SYSTEM);
				return false;								// 포탈에는 리액터를 생성할 수 없다.
			}
			if (loc && loc.isReactor()) {
				trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR, MSG_TYPE__SYSTEM);
				return false;								// 리액터에는 리액터를 생성할 수 없다.
			}
			if (loc && loc.isMonster() && !loc.isPet()) {
				// 화이어 플라스크 무시 체크
				if (loc.getCarryingItemInventory().getCountClassNamed("1001995") < 1) {
					DMG = (S_LV * 100 - loc.getDefence()) * 5;
					if (DMG < 1) DMG = 1;
					loc.setHP(loc.getHP() - DMG);
					// 발화 설정해주기. 발화 시간은 10초
					if (loc.canBeCasted(CREATURE_STATE__FIRE))
						loc.castNamedWithDuration("3000194",10);
					loc.updateAttr();
					loc.updateShape();
					loc.broadcastDamage(DMG);
				}
			}
			defY = defY + 1;
		}
		defY = startY;
		defX = defX + 1;
	}

	duration = (6 - S_LV) * 5 + 5;

	if (trigger.getWorld().canPK()) {
		// PK 필드용 화염병 설치
		trigger.getWorld().createReactor(PKR, startX, startY, endX, endY, trigger, cntChk, duration);
	} else {
		// 일반 필드용 화염병 설치
		trigger.getWorld().createReactor(NPKR, startX, startY, endX, endY, trigger, cntChk, duration);
	}

	controller.effectBy(trigger);
	return true;
}

quest
qUseItem1002934()				// 파이어 플라스크 (나야트레이 인술 투폭)
{
	integer	S_LV, cntChk;
	object skill_obj;

	if (!trigger.getWorld().canFight()) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_TOWN, MSG_TYPE__SYSTEM);
		return;
	}
	if (!NormalItemCanBeUsed()) return;

	if (trigger.getCharacterType() != CHAR_TYPE10) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_NAYA, MSG_TYPE__SYSTEM);
		return;
	}

	skill_obj = trigger.getSkillActionInventory().getNamed("3001009");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL2_NAYA, MSG_TYPE__SYSTEM);
		return;								// 인술 투폭 습득 여부 체크
	}
	S_LV = skill_obj.getLevel();
	cntChk = S_LV * 2 + 1;

	if (cntChk == 3) {
		// 3X3 PK & NPK
		qFireItem("9000236", "9000235", S_LV, cntChk);
	} else if (cntChk == 5) {
		// 5X5 PK & NPK
		qFireItem("9000307", "9000306", S_LV, cntChk);
	} else if (cntChk == 7) {
		// 7X7 PK & NPK
		qFireItem("9000309", "9000308", S_LV, cntChk);
	} else if (cntChk == 9) {
		// 9X9 PK & NPK
		qFireItem("9000311", "9000310", S_LV, cntChk);
	} else {
		// 11X11 PK & NPK
		qFireItem("9000313", "9000312", S_LV, cntChk);
	}
}


function
boolean
qMineItem(string PKR, string NPKR)
{
	integer	S_LV;
	integer startX, startY, endX, endY;
	integer defX, defY, countX, countY, cntChk;
	object skill_obj;
	object loc;

	if (!trigger.getWorld().canFight()) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_TOWN, MSG_TYPE__SYSTEM);
		return false;
	}
	if (!NormalItemCanBeUsed()) return false;
	if (trigger.getCharacterType() != CHAR_TYPE10) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_NAYA, MSG_TYPE__SYSTEM);
		return false;
	}

	skill_obj = trigger.getSkillActionInventory().getNamed("3001008");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL1_NAYA, MSG_TYPE__SYSTEM);
		return false;									// 인술 은폭 습득 여부 체크
	}
	S_LV = skill_obj.getLevel();
	startX = trigger.getX() - 2;
	startY = trigger.getY() - 2;
	endX = trigger.getX() + 2;
	endY = trigger.getY() + 2;
	defX = startX;
	defY = startY;
	cntChk = 3;

	for (countX = 0; countX < cntChk; ++countX) {
		for (countY = 0; countY < cntChk; ++countY) {
			loc = Visible.at(defX, defY);
			if (loc && loc.isPortal()) {
				trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR, MSG_TYPE__SYSTEM);
				return false;								// 포탈에는 리액터를 생성할 수 없다.
			}
			if (loc && loc.isReactor()) {
				trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR, MSG_TYPE__SYSTEM);
				return false;								// 리액터에는 리액터를 생성할 수 없다.
				/*
				for (rcount = 9000274; rcount < 9000287; ++rcount) {
					if (loc.getTile() == rcount) {
						trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR2, MSG_TYPE__SYSTEM);
						return;						// 리액터에는 동일계열 리액터를 중복할 수 없다.
					}
				}
				*/
			}
			defY = defY + 1;
		}
		defY = startY;
		defX = defX + 1;
	}

	if (trigger.getWorld().canPK()) {
		// PK 필드전용 지뢰 설치 -> PK 장소에서의 지뢰 유지시간 60초에서 55초로 하향
		trigger.getWorld().createReactor(PKR, startX, startY, endX, endY, trigger, S_LV, 55);
	} else {
		// 일반 필드용 지뢰 설치 -> 일반 필드는 그대로 유지
		trigger.getWorld().createReactor(NPKR, startX, startY, endX, endY, trigger, S_LV, 60);
	}

	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	controller.effectBy(trigger);
	return true;
}

quest
qUseItem1002935()				// 기본 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000275", "9000274");
}


quest
qUseItem1002936()				// 감전 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000277", "9000276");
}

quest
qUseItem1002937()				// 발화 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000279", "9000278");
}

quest
qUseItem1002938()				// 중독 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000281", "9000280");
}

quest
qUseItem1002939()				// 빙결 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000283", "9000282");
}

quest
qUseItem1002940()				// 암흑 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000285", "9000284");
}

quest
qUseItem1002941()				// 마비 지뢰 (나야트레이 인술 은폭)
{
	qMineItem("9000287", "9000286");
}


quest
UseBinding()				// 바인딩 스톤 사용 처리
{
	integer cMap, cX, cY, useCnt;
	string binding, temp, temp2;
	object loc, itemObj;

	itemObj = trigger.getCarryingItemInventory().at(trigger.getIntValue(3));
	binding	= trigger.getStringValue(1);

	cMap = String.toInteger(String.split(" ", 0, binding));
	temp = String.split(" ", 1, binding);
	cX = String.toInteger(String.split(" ", 0, temp));
	temp2 = String.split(" ", 1, temp);
	cY = String.toInteger(String.split("*", 0, temp2));
	useCnt = String.toInteger(String.split("*", 1, temp2));

	// 임시로 요새 안에선 각인 못하게 방지함. 2004.10.18 stsoul
	if (World.getNumbered(cMap).getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

//	로컬 서버 다를 경우 문제되는 거 막는 땜빵. 아미티스만 막는다. by stsoul
	if (cMap == 46 || cMap == 53 || cMap == 59 || cMap == 93 || cMap == 98
	 || cMap == 115 || cMap == 116 || cMap == 348 || cMap == 387 || cMap == 388
	 || cMap == 389 || cMap == 390 || cMap == 417) {
		trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getLevel() < 45) {
		if (cMap == 42 || cMap == 43 || cMap == 209 || cMap == 215) {
			trigger.message(CANT_USE_TELEPORT_ITEM_SHORT_LEVEL, MSG_TYPE__SYSTEM);
			return;
		}
	}

	// 임시 주석. 이벤트 기간 동안엔 이 필드로 갈 수 없다.
	if (cMap == 176 || cMap == 189 || cMap == 418) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SHORT_LEVEL, MSG_TYPE__SYSTEM);
		return;
	}



	useCnt = useCnt - 1;
	trigger.message("[" + trigger.getStringValue(2) + TEXT_WARP_TARGET_SUFFIX, MSG_TYPE__SYSTEM);
	if (useCnt < 1) {
		itemObj.sweep();
		trigger.message(TEXT_USABLEITEM_CANT_EXHAUST, MSG_TYPE__SYSTEM);
	} else {
		trigger.message(TEXT_USECOUNT_PREFIX + useCnt + TEXT_USECOUNT_SUFFIX, MSG_TYPE__SYSTEM);
		binding = cMap + " " + cX + " " + cY + "*" + useCnt;
		itemObj.setAttribute("BINDING", binding);

		temp = trigger.getStringValue(2) + " / " + useCnt + TEXT_USABLEITEM_COUNT;
//		Util.log("*** 이름 재설정 ***");
	   	itemObj.setUserDefinedName(temp);
	}
//	Util.log("*** 이름 재설정 완료 ***");
	trigger.resetStringValue(1);
	trigger.resetStringValue(2);
	trigger.setIntValue(3, 0);

	loc = Location.create();

	//jaewook if you try to go to castle, the scroll doesn:t work and disappear
	if (cMap == 46 || cMap == 53 || cMap == 59 || cMap == 93 || cMap == 98 || cMap == 115 ||
		cMap == 116 || cMap == 348 || cMap == 387 || cMap == 388 || cMap == 389 ||
		cMap == 390 || cMap == 417) {
			trigger.message("v2?!'!!!?BoChXg[!?! B", MSG_TYPE__SYSTEM);
		itemObj.sweep();
		return;
	}	//
	loc.set(cMap, cX, cY);
	trigger.teleportTo(loc);
}

quest
NoUseBinding()
{
	trigger.message(TEXT_USABLEITEM_CANCEL_USE, MSG_TYPE__SYSTEM);
}

function
boolean
fBinding(string cValue)
{
	integer slot, cMap;
	string binding, temp;
	object skill_obj, chk_obj;
	integer testvalue;

//	체크용. 검증해보고 정리하기. 일단은 적용하지 말기.
//	trigger.suspend();
//	trigger.resume();

	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}
	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}
	if (!trigger.getWorld().canUseMeet()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}
	if (trigger.getWorld().canPK()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}
	if (!trigger.isAlive()) return false;
	if (!NormalItemCanBeUsed()) return false;

//	버그 땜빵용으로 추가 작업 진행하기. 이미 메모라이즈 한 경우에 대비... by stsoul
	cMap = trigger.getWorld().getNumber();
	if (cMap == 409 || cMap == 410 || cMap == 415 || cMap == 416 || cMap == 103 || cMap == 120
//	 || cMap == 324 || cMap == 326 || cMap == 336 || cMap == 339 || cMap == 340) {
	// 초보자 문제 때문에 임시로 추가 by stsoul
	 || cMap == 324 || cMap == 326 || cMap == 336 || cMap == 339 || cMap == 340
	 || cMap == 421 || cMap == 422 || cMap == 423 || cMap == 424) {
		trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
		return false;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
		return false;
	}

	if (controller.checkAttribute("BINDING") == true) {
		binding	= controller.getAttribute("BINDING");
		temp = controller.getAttribute("BINDUSER") + TEXT_USABLEITEM_USE_BINDING1 + controller.getAttribute("BINDMAP") + TEXT_USABLEITEM_USE_BINDING2 + String.toInteger(String.split("*", 1, binding)) + TEXT_USABLEITEM_USE_BINDING3;

		// User StringValue 1 = 바인딩 스톤에 기록된 좌표 정보 및 사용 회수 데이터
		// User StringValue 2 = 바인딩 스톤에 기록된 이동 좌표 명칭
		trigger.setStringValue(1, binding);
		trigger.setStringValue(2, controller.getAttribute("BINDMAP"));

		for (slot = trigger.getFirstItemSlot(); slot; slot = trigger.getNextItemSlot(slot)) {
			chk_obj = trigger.getCarryingItemInventory().at(slot);
			if (chk_obj == controller) {
				// User intValue 3 = 핸들링할 아이템의 슬롯 번호
				trigger.setIntValue(3, slot);
				testvalue = testvalue + 1;
			}
		}

		if (testvalue == 0) {
			trigger.message(TEXT_USABLEITEM_EXT_MSG1, MSG_TYPE__SYSTEM);
		}

		trigger.sendSelectQuestMessage(temp, "UseBinding", "NoUseBinding", controller);
		return true;
	} else if (trigger.getCharacterType() != CHAR_TYPE8) {
		trigger.message(TEXT_USABLEITEM_CANT_BINDING, MSG_TYPE__SYSTEM);
		return false;
	} else {
		// 티치엘의 아이템 등록 처리
		skill_obj = trigger.getSkillActionInventory().getNamed("3000275");
		if (skill_obj == null) {
			trigger.message(TEXT_USABLEITEM_CANT_SKILL1_TICH, MSG_TYPE__SYSTEM);
			return false;
		}

		if (trigger.getWorld().getCastleNumber() != 0) {
			trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
			return false;
		}

		chk_obj = Visible.at(trigger.getX(), trigger.getY());
		if (chk_obj && chk_obj.isPortal()) {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return false;
		}
		if (chk_obj && chk_obj.isReactor()) {
			trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
			return false;
		}

		if (skill_obj.getLevel() == 15) {
			binding = trigger.getWorld().getNumber() + " " + trigger.getX() + " " + trigger.getY() + "*" + cValue;
			controller.setAttribute("BINDING", binding);
			controller.setAttribute("BINDMAP", trigger.getWorld().getName());
			controller.setAttribute("BINDUSER", trigger.getName());
//			temp = trigger.getWorld().getName() + " " + controller.getDescClassNamed(controller.getName());
//			temp = trigger.getWorld().getName() + " " + String.split(" ", 0, controller.getDescClassNamed(controller.getName()));
//			binding = String.split(" ", 0, controller.getDescClassNamed(controller.getName()));
//			temp = trigger.getWorld().getName() + " " + binding;
			temp = trigger.getWorld().getName() + " / " + cValue + TEXT_USABLEITEM_COUNT;
	    	controller.setUserDefinedName(temp);
			trigger.message("[" + trigger.getWorld().getName() + TEXT_WARP_SETUP_SUFFIX, MSG_TYPE__SYSTEM);
			return true;
		} else {
			trigger.message(TEXT_CANT_USE_LOW_LEVEL, MSG_TYPE__SYSTEM);
			return false;
		}
	}
	return false;
}

quest
qUseItem1002952()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (5회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("5");
}

quest
qUseItem1002991()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (10회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("10");
}

quest
qUseItem1002992()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (15회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("15");
}

quest
qUseItem1002993()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (20회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("20");
}

quest
qUseItem1002994()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (25회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("25");
}

quest
qUseItem1002995()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (30회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("30");
}

quest
qUseItem1002996()				// 바인딩 스톤 : 티치엘 각인 후 누구나 사용 가능 (40회)
{
	if (trigger.isLimited())
	{
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_EKION_NEW_CHAR_NOT_MOVE2, MSG_TYPE__SYSTEM);
		return;
	}

	fBinding("40");
}


quest
qUseItem1002954()				// 이스케이프 카드 : 루시안 전용 스킬 아이템
{
	integer	S_LV;
	integer startX, startY, endX, endY;
	integer defX, defY, count, retry;
	object skill_obj;
	object loc;

	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;

	if (!NormalItemCanBeUsed()) return;

	if (trigger.getCharacterType() != CHAR_TYPE0) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_RUCI, MSG_TYPE__SYSTEM);
		return;
	}

	// 랜덤 워프 습득 여부 체크
	skill_obj = trigger.getSkillActionInventory().getNamed("3000539");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL1_RUCI, MSG_TYPE__SYSTEM);
		return;
	}
	S_LV = skill_obj.getLevel();

	if (S_LV >= 1 && S_LV <= 9) {
		startX = trigger.getX() - (13 * S_LV + 20);
		startY = trigger.getY() - (11 * S_LV + 24);
		endX = trigger.getX() + (11 * S_LV + 24);
		endY = trigger.getY() + (13 * S_LV + 20);
		retry = S_LV / 2 + 2;
	} else if (S_LV == 10) {
		startX = 42;
		startY = 42;
		endX = trigger.getWorld().getXSize() - 42;
		endY = trigger.getWorld().getYSize() - 42;
		retry = 7;
	}

	if (endX >= trigger.getWorld().getXSize() - 41) {
		endX = trigger.getWorld().getXSize() -42;
	} else if (startX < 41) {
		startX = 42;
	}

	if (endY >= trigger.getWorld().getYSize() - 41) {
		endY = trigger.getWorld().getYSize() -42;
	} else if (startY < 41) {
		startY = 42;
	}

	if (startX >= endX || startY >= endY) {
		// 맵이 사기적으로 적어 실패
		trigger.message(TEXT_USABLEITEM_CANT_MAPSIZE, MSG_TYPE__SYSTEM);
		// 못하게 하는게 낫겠지?
		return;
	}

	loc = Location.create();
	for (count = 0; count < retry; ++count) {
		defX = Util.random(startX, endX);
		defY = Util.random(startY, endY);
		if (trigger.getWorld().canPutObject(defX, defY)) {
			controller.decreaseNumber(1);
			controller.effectBy(trigger);
			loc.set(trigger.getWorld().getNumber(), defX, defY);
			trigger.teleportTo(loc);
			return;
		}
	}
	controller.decreaseNumber(1);
	controller.effectBy(trigger);

	loc.set(trigger.getWorld().getNumber(), trigger.getX(), trigger.getY());
	trigger.teleportTo(loc);
}


function
boolean
TeleportationInput(string RID)				// 티치엘 전용 스킬 아이템
{
	integer	S_LV;
	integer startX, startY, endX, endY;
	integer defX, defY, count, cntChk;
	integer rTimer, rCount;
	object skill_obj;
	object target;
	object loc;

	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return false;
	}

	if (!trigger.isAlive()) return false;

	if (!NormalItemCanBeUsed()) return false;

	if (trigger.getCharacterType() != CHAR_TYPE8) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_TICH, MSG_TYPE__SYSTEM);
		return false;
	}

	// 워프 습득 여부 체크
	skill_obj = trigger.getSkillActionInventory().getNamed("3000275");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL1_TICH, MSG_TYPE__SYSTEM);
		return false;
	}

	S_LV = skill_obj.getLevel();

	if (S_LV == 1) {
		rTimer = 3;
		rCount = 1;
	} else if (S_LV == 2) {
		rTimer = 4;
		rCount = 2;
	} else if (S_LV == 3) {
		rTimer = 4;
		rCount = 3;
	} else if (S_LV == 4) {
		rTimer = 5;
		rCount = 4;
	} else if (S_LV == 5) {
		rTimer = 5;
		rCount = 5;
	} else if (S_LV == 6) {
		rTimer = 6;
		rCount = 6;
	} else if (S_LV == 7) {
		rTimer = 6;
		rCount = 7;
	} else if (S_LV == 8) {
		rTimer = 7;
		rCount = 8;
	} else if (S_LV == 9) {
		rTimer = 7;
		rCount = 9;
	} else if (S_LV == 10) {
		rTimer = 8;
		rCount = 10;
	} else if (S_LV == 11) {
		rTimer = 8;
		rCount = 11;
	} else if (S_LV == 12) {
		rTimer = 9;
		rCount = 12;
	} else if (S_LV == 13) {
		rTimer = 9;
		rCount = 13;
	} else if (S_LV == 14) {
		rTimer = 10;
		rCount = 14;
	} else if (S_LV == 15) {
		rTimer = 10;
		rCount = 15;
	}

	target = controller.getPointArgumentAt(0);
	if (!target) return false;

	startX = target.getX() - 5;
	startY = target.getY() - 5;
	endX = target.getX() + 4;
	endY = target.getY() + 4;
	defX = startX;
	defY = startY;
	cntChk = 10;

	for (count = 0; count < cntChk; ++count) {
		loc = Visible.at(defX, defY);
		if (loc && loc.isPortal()) {
			trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR, MSG_TYPE__SYSTEM);
			return false;							// 포탈에는 리액터를 생성할 수 없다.
		}
		if (loc && loc.isReactor()) {
			trigger.message(TEXT_USABLEITEM_CANT_SKILL_REACTOR2, MSG_TYPE__SYSTEM);
			return false;							// 리액터에는 동일 리액터를 중복할 수 없다.
		}
		defX = defX + 1;
		defY = defY + 1;
	}

	trigger.getWorld().createReactor(RID, startX, startY, endX, endY, trigger, rCount + 10, rTimer);
	return true;
}


quest
qUseItem1002972()				// 클라드 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	// 임시로 요새 안에선 각인 못하게 방지함. 2004.08.18 stsoul
	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000260")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1002973()				// 나르비크 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000261")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1002974()				// 라이디아 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000262")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1002975()				// 카울 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000263")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1002976()				// 아드셀 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getLevel() < 45) return;

	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000264")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}

quest
qUseItem1002977()				// 타운 텔레포트 스크롤 : 티치엘 전용 스킬 아이템
{
	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	if (!TeleportationInput("9000265")) return;

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);

	controller.effectBy(trigger);
}


quest
qUseItem1001804()		// 메모라이즈 스크롤 (티치엘 전용, 좌표 기억 및 체크용)
{
	integer S_LV;
	integer rTime;
	string memorize;
	object skill_obj;

	integer cMap;

	cMap = trigger.getWorld().getNumber();

	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.getWorld().canUseMeet()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getWorld().canPK()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.isAlive()) return;
	if (!NormalItemCanBeUsed()) return;

	if (trigger.getCharacterType() != CHAR_TYPE8) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_TICH, MSG_TYPE__SYSTEM);
		return;
	}

	// 워프 습득 여부 체크
	skill_obj = trigger.getSkillActionInventory().getNamed("3000275");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL1_TICH, MSG_TYPE__SYSTEM);
		return;
	}
	S_LV = skill_obj.getLevel();

	if (S_LV < 10) {
		trigger.message(TEXT_CANT_USE_LOW_LEVEL, MSG_TYPE__SYSTEM);
		return;
	} else if (S_LV == 10) {
		rTime = 86400;
	} else if (S_LV == 11) {
		rTime = 259200;
	} else if (S_LV == 12) {
		rTime = 432000;
	} else if (S_LV == 13) {
		rTime = 604800;
	} else if (S_LV == 14 || S_LV == 15) {
		rTime = 0;
	}

	// 임시로 요새 안에선 각인 못하게 방지함. 2004.07.21 stsoul
	if (trigger.getWorld().getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (cMap == 609 || cMap == 627 || cMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

/*
	} else {
		trigger.message("x1??! B", MSG_TYPE__SYSTEM);
		return;
	}
*/
	if (trigger.getCookie("Teleport1") != null) {
		trigger.message("["+ trigger.getCookie("Teleport_Name") + TEXT_WARP_RECORD_SUFFIX, MSG_TYPE__SYSTEM);
	}

	memorize = trigger.getWorld().getNumber() + " " + trigger.getX() + " " + trigger.getY();
	trigger.setCookie("Teleport1", memorize, rTime);
	trigger.setCookie("Teleport1_Name", trigger.getWorld().getName(), rTime);

	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	trigger.message(TEXT_WARP_SETUP_COMPLETE, MSG_TYPE__SYSTEM);
	controller.effectBy(trigger);
	// 포탈 스크롤이나 포탈 생성 스킬 사용시 이동될 장소를 설정하는 아이템
}


quest
qUseItem1001805()		// 텔레포트 스크롤 (티치엘 전용)
{
	integer cMap, cX, cY, S_LV, clubCnt, chker;
	integer prob, rValue, tmpCnt, Item_Check1;
	string memorize, temp;
	object target, clubObject;
	object loc, skill_obj, castedSpellInven;

	integer chkMap;

	chkMap = trigger.getWorld().getNumber();

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3000259")) {
		trigger.message(TEXT_USABLEITEM_CANT_USE_HIDE + TEXT_USABLEITEM_CANT_MSG, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getWorld().isEventWorld()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}
	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!trigger.isAlive()) return;
	if (!NormalItemCanBeUsed()) return;

	if (trigger.getCharacterType() != CHAR_TYPE8) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL_TICH, MSG_TYPE__SYSTEM);
		return;
	}

	// 워프 습득 여부 체크
	skill_obj = trigger.getSkillActionInventory().getNamed("3000275");
	if (skill_obj == null) {
		trigger.message(TEXT_USABLEITEM_CANT_SKILL1_TICH, MSG_TYPE__SYSTEM);
		return;
	}
	S_LV = skill_obj.getLevel();

	if (S_LV < 10) {
		trigger.message(TEXT_CANT_USE_LOW_LEVEL, MSG_TYPE__SYSTEM);
		return;
	}
/*
	} else if (S_LV > 15) {
		trigger.message("레벨 설정에 오류가 있습니다.", MSG_TYPE__SYSTEM);
		return;
	}
*/
	memorize = trigger.getCookie("Teleport1");
	if (memorize == null) {
		trigger.message(TEXT_CANT_WARP_NO_POINT1, MSG_TYPE__SYSTEM);
		trigger.message(TEXT_CANT_WARP_NO_POINT2, MSG_TYPE__SYSTEM);
		return;
	}

	target = controller.getObjectArgumentAt(0);
	if (!target) return;

	rValue = 0;
	cMap = String.toInteger(String.split(" ", 0, memorize));
	temp = String.split(" ", 1, memorize);
	cX = String.toInteger(String.split(" ", 0, temp));
	cY = String.toInteger(String.split(" ", 1, temp));

	// 임시로 요새 안에선 각인 못하게 방지함. 2004.10.18 stsoul
	if (World.getNumbered(cMap).getCastleNumber() != 0) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}

	// 통곡의 탑 대기실 사용불가
	if (chkMap == 609 || chkMap == 627 || chkMap == 644) {
		trigger.message(TEXT_USABLEITEM_CANT_BIND_CASTLE, MSG_TYPE__SYSTEM);
		return;
	}
/*
	if (target.isMonster())
	{
		if (trigger.getWorld().getMonsterCountClassNamed("2100094") >= 1 ||
			trigger.getWorld().getMonsterCountClassNamed("2100373") >= 1 ||
			trigger.getWorld().getMonsterCountClassNamed("2100374") >= 1 ||
			trigger.getWorld().getMonsterCountClassNamed("2100375") >= 1)
		{
			trigger.message(TEXT_CANT_WARP_MONSTER_BLOCK, MSG_TYPE__SYSTEM);
			return;
		}
	}
*/
	if (target.isUser()) {
		if (target.getLevel() < 45) {
			if (cMap == 42 || cMap == 43 || cMap == 209 || cMap == 215) {
				trigger.message(CANT_USE_TELEPORT_ITEM_SHORT_LEVEL, MSG_TYPE__SYSTEM);
				return;
			}
		}
		clubObject = trigger.getGuild(GD_TYPE_NORMAL);

		if (target != trigger && !target.isMemberOfGroup(trigger)) {
			if (clubObject != null) {
				if (trigger.getMemberType(target.getName()) == 4) {
					trigger.message(target.getName() + TEXT_RECALL_CANCEL, MSG_TYPE__SYSTEM);
					return;
				}

				clubCnt = clubObject.getMemberType(target.getName());
				if (clubCnt == 0 || clubCnt == 4) {
					trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
					return;
				}
			} else if (target != trigger) {
				trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
				return;
			}
		}

		if (trigger.getWorld().canPK()) {
			tmpCnt = trigger.getWorld().getNumber();
			if (tmpCnt == 331 || tmpCnt == 332 || tmpCnt != 333) {
				trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
				return;
			}
		}
		trigger.message("["+ target.getName() + TEXT_TARGET_WARP_USER_PREFIX + trigger.getCookie("Teleport1_Name") +TEXT_TARGET_WARP_USER_SUFFIX, MSG_TYPE__SYSTEM);
		target.message("["+ trigger.getName() + TEXT_OBJECT_WARP_USER_PREFIX + trigger.getCookie("Teleport1_Name") + TEXT_OBJECT_WARP_USER_SUFFIX, MSG_TYPE__SYSTEM);
	}
	else if (target.isMonster())
	{
		if (trigger.getWorld().getNumber() != cMap)
		{
			if (controller.canBeExhausted())
			{
				controller.decreaseNumber(1);
			}
			trigger.message(TEXT_CANT_WARP_MONSTER, MSG_TYPE__SYSTEM);
			return;
		}
		else
		{
			// 성공률 = 몬스터 레벨 - 유저 레벨 + 80
			prob = target.getLevel() - trigger.getLevel() + 80;
			if (prob < 1 || prob < Util.random(1,99))
			{
				if (controller.canBeExhausted())
				{
					controller.decreaseNumber(1);
				}
				trigger.message(TEXT_CANT_WARP_MONSTER_LV, MSG_TYPE__SYSTEM);
				return;
			}
		}
		chker = trigger.getIntValue(9);
		if (chker >= Util.getTick())
		{
			trigger.message(TEXT_USABLEITEM_CANT_USE_DELAY + TEXT_USABLEITEM_CANT_MSG, MSG_TYPE__SYSTEM);
			return;
		}
		Item_Check1 = target.getCarryingItemInventory().getCountClassNamed("1001993");  // 텔레포트 금지
		chker = Util.getTick() + 22;	// 8.3 * 22 = 약 3분
		trigger.setIntValue(9, chker);

		if (Item_Check1 >= 1)
		{
			if (controller.canBeExhausted())
			{
				controller.decreaseNumber(1);
			}
			trigger.message(TEXT_CANT_WARP_MONSTER_BLOCK, MSG_TYPE__SYSTEM);
			return;
		}
		trigger.message("["+ target.getName() + TEXT_WARP_COMPLETE, MSG_TYPE__SYSTEM);
	} else return;

	// 버그 땜빵용으로 추가 작업 진행하기. 이미 메모라이즈 한 경우에 대비... by stsoul
	if (cMap == 409 || cMap == 410 || cMap == 415 || cMap == 416 || cMap == 103 || cMap == 120
//	 || cMap == 324 || cMap == 326 || cMap == 336 || cMap == 339 || cMap == 340) {
	// 초보자 문제 때문에 임시로 추가 by stsoul
	 || cMap == 324 || cMap == 326 || cMap == 336 || cMap == 339 || cMap == 340
	 || cMap == 421 || cMap == 422 || cMap == 423 || cMap == 424) {
		trigger.message(TEXT_CANT_WARP_NOWARP, MSG_TYPE__SYSTEM);
		return;
	}

	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	loc = Location.create();
	loc.set(cMap, cX, cY);
	target.teleportTo(loc);
	// controller.effectBy(trigger);
	// 메모라이즈 스크롤로 설정된 장소로 이동 가능한 포탈을 생성하는 아이템. 메모라이즈 안하면 사용 불가.
}


function boolean
ItemUpMPMaster(object target, integer value)
{
	integer oldValue;
	integer newValue;

	if (target.isState(CREATURE_STATE__NO_MP_REGEN)) {
		target.message(CANT_USE_FOR_NO_MP_REGEN_STATE, MSG_TYPE__SYSTEM);
		return false;
	}

	value = value + value * target.getMagicResist() / 4 / 100;

	if (value <= 0) {
		Util.log("! invalid mp value " + value + " in ItemUpMP()");
		return false;
	} else if (target.getMaxMP() == target.getMP()) {
		target.message(MP_UP_MESSAGE_PREFIX + FULL_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return false;
	} else {
		oldValue = target.getMP();

		if (target.getMaxMP() < oldValue + value) target.setMP(target.getMaxMP());
		else target.setMP(oldValue + value);

		newValue = target.getMP();

		target.updateAttr();

		// send message
		target.message(MP_UP_MESSAGE_PREFIX + (newValue - oldValue) + MP_UP_MESSAGE_SUFFIX, MSG_TYPE__SYSTEM);
		return true;
	}
}

quest						// 테스트용 마나 포션 (대)
qUseItem1002988()
{
	trigger.setLimited(true);
/*
// 타겟 HP 1만들기 -_-

	integer	duration;
	object target;

	target = controller.getObjectArgumentAt(0);
	if (!target) return;

	duration = target.getHP();
	target.setHP(1);
	target.updateAttr();
	//target.updateShape();
	target.broadcastDamage(duration);

	// send using effect
	controller.effectBy(trigger);
*/

/*
	integer endX, endY;
	integer countX, countY;
	object loc;

	endX = trigger.getWorld().getXSize();
	endY = trigger.getWorld().getYSize();

	for (countX = 0; countX < endX; ++countX) {
		for (countY = 0; countY < endY; ++countY) {
			loc = Visible.at(countX, countY);
			if (loc && loc.isMerchant()) {
				loc.hide();
			}
		}
	}
*/
}



quest						// 요새 쟁탈전 강제 시작
qUseItem1002942()
{
	object castle;
	castle = Castle.getNumbered(trigger.getWorld().getCastleNumber());
    	if(castle) castle.setState(1);
    	Util.log("######castle State End= ["+castle.getState()+"]");
    	return;
}
quest						// 요새 쟁탈전 강제 종료
qUseItem1002943()
{
	// end
	object castle;
	castle = Castle.getNumbered(trigger.getWorld().getCastleNumber());
	if(castle) castle.setState(3);
	Util.log("######castle State End= ["+castle.getState()+"]");
	return;
}
quest						// 요새 정보 초기화
qUseItem1003354()
{
	object castle;

	castle = Castle.getNumbered(trigger.getWorld().getCastleNumber());

	castle.reset(1);

	return;
}

quest						// 테라노 소환 주문서
qUseItem1003289()
{
        object guardian;
        string Ruling;
        object castle;
        string GuildName;
        object guild;
        string challenging;
	string cName;
	object world;
	integer mapcheck;
	string sValue;
	//integer xPoint = 0;
	//integer yPoint = 0;

        integer x = trigger.getX();
        integer y = trigger.getY();

	cName = trigger.getName();
	guild = trigger.getGuild(GD_TYPE_NORMAL);
    	GuildName = guild.getName();
        castle = Castle.getNumbered(1);
        Ruling = castle.getRulingGuildName();
        challenging = castle.getChallengingGuildName();
	world = trigger.getWorld();
	mapcheck = world.getNumber();
	sValue = trigger.getCookie("Guardian_R");

	if (!NormalItemCanBeUsed()) return;

	if (!guild.hasGuardian()) {
		// 신수를 소유하고 있지 않은 경우
		Util.log("## " + GuildName + " doesn`t have Guardian_R.");
		//메시지를 뿌려주고
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		//아이템을 파괴한다.
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}
	if(!castle.isInSiegeWar()) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_IS_INSIEGEWAR, MSG_TYPE__SYSTEM);
		return;
     	}
	if(guild.getMemberType(cName) != 1) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MEMBER_TYPE, MSG_TYPE__SYSTEM);
		return;
       	}
       	if(mapcheck != 53) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MAP_CHECK, MSG_TYPE__SYSTEM);
		return;
	}
	if(sValue == "R_Success") {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_COOKIE, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
	    	controller.decreaseNumber(1);
		return;
	}
	/*
	if (!(x > 300 && x < 350 && y > 300 && y < 350)) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## can`t Put Guardian_R");
		return;
	}
	*/
	if(GuildName == challenging) {
		guardian = Guardian.summonByNumber(GuildName, 1, 53, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else if(GuildName == Ruling){
		guardian = Guardian.summonByNumber(GuildName, 1, 53, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else {
		// 도전길드도 수성길드도 아닌 경우
		Util.log("## " + GuildName + " doesn`t related with castle.");
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}

	if (guardian) {
		// 신수가 제대로 생성 된 경우
		Util.log("## Guardian_R Summon Success");
		trigger.setCookie("Guardian_R","R_Success", 3600);
		if (controller.canBeExhausted())
		controller.decreaseNumber(1);
		return;
	} else{
		// 생성이 제대로 되지 않은 경우
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		Util.log("## Guardian_R Summon Fail");
		return;
      	}
}
quest						// 베레시스 소환 주문서
qUseItem1003288()
{
        object guardian;
        string Ruling;
        object castle;
        string GuildName;
        object guild;
        string challenging;
	object world;
        integer mapcheck;
	string cName;
	string sValue;
	//integer xPoint = 0;
	//integer yPoint = 0;

        integer x = trigger.getX();
        integer y = trigger.getY();

	cName = trigger.getName();
	guild = trigger.getGuild(GD_TYPE_NORMAL);
    	GuildName = guild.getName();
        castle = Castle.getNumbered(1);
        Ruling = castle.getRulingGuildName();
        challenging = castle.getChallengingGuildName();
	world = trigger.getWorld();
	mapcheck = world.getNumber();
	sValue = trigger.getCookie("Guardian_B");

	if (!NormalItemCanBeUsed()) return;

	if (!guild.hasGuardian()) {
		// 신수를 소유하고 있지 않은 경우
		Util.log("## " + GuildName + " doesn`t have Guardian_B.");
		//메시지를 뿌려주고
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		//아이템을 파괴한다.
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}
	if(!castle.isInSiegeWar()){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_IS_INSIEGEWAR, MSG_TYPE__SYSTEM);
		return;
    	}
	if(guild.getMemberType(cName) != 1){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MEMBER_TYPE, MSG_TYPE__SYSTEM);
		return;
       	}
       	if(mapcheck != 53){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MAP_CHECK, MSG_TYPE__SYSTEM);
		return;
	}
	if(sValue == "B_Success"){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_COOKIE, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
	    	controller.decreaseNumber(1);
		return;
	}
/*
	if (!(x > 300 && x < 350 && y > 300 && y < 350)) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## can`t Put Guardian_B");
		return;
	}
*/
	if(GuildName == challenging){
		guardian = Guardian.summonByNumber(GuildName, 2, 53, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else if(GuildName == Ruling){
		guardian = Guardian.summonByNumber(GuildName, 2, 53, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
	} else {
		// 도전길드도 수성길드도 아닌 경우
		Util.log("## " + GuildName + " doesn`t related with castle.");
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}

	if (guardian) {
		// 신수가 제대로 생성 된 경우
		Util.log("## Guardian_B Summon Success");
		trigger.setCookie("Guardian_B","B_Success", 3600);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	} else {
		// 생성이 제대로 되지 않은 경우
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## Guardian_B Summon Fail");
		return;
	}
}

quest						// 기가스 소환 주문서
qUseItem1003352()
{
        object guardian;
        string Ruling;
        object castle;
        string GuildName;
        object guild;
        string challenging;
	string cName;
	object world;
	integer mapcheck;
	string sValue;
	//integer xPoint = 0;
	//integer yPoint = 0;

        integer x = trigger.getX();
        integer y = trigger.getY();

	cName = trigger.getName();
	guild = trigger.getGuild(GD_TYPE_NORMAL);
    	GuildName = guild.getName();
        castle = Castle.getNumbered(2);
        Ruling = castle.getRulingGuildName();
        challenging = castle.getChallengingGuildName();
	world = trigger.getWorld();
	mapcheck = world.getNumber();
	sValue = trigger.getCookie("Guardian_G");

	if (!NormalItemCanBeUsed()) return;

	if (!guild.hasGuardian()) {
		// 신수를 소유하고 있지 않은 경우
		Util.log("## " + GuildName + " doesn`t have Guardian_G.");
		//메시지를 뿌려주고
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		//아이템을 파괴한다.
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}
	if(!castle.isInSiegeWar()) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_IS_INSIEGEWAR, MSG_TYPE__SYSTEM);
		return;
     	}
	if(guild.getMemberType(cName) != 1) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MEMBER_TYPE, MSG_TYPE__SYSTEM);
		return;
       	}
       	if(mapcheck != 283) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MAP_CHECK, MSG_TYPE__SYSTEM);
		return;
	}
	if(sValue == "G_Success") {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_COOKIE, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
	    	controller.decreaseNumber(1);
		return;
	}
	/*
	if (!(x > 300 && x < 350 && y > 300 && y < 350)) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## can`t Put Guardian_R");
		return;
	}
	*/
	if(GuildName == challenging) {
		guardian = Guardian.summonByNumber(GuildName, 3, 283, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else if(GuildName == Ruling){
		guardian = Guardian.summonByNumber(GuildName, 3, 283, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else {
		// 도전길드도 수성길드도 아닌 경우
		Util.log("## " + GuildName + " doesn`t related with castle.");
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}

	if (guardian) {
		// 신수가 제대로 생성 된 경우
		Util.log("## Guardian_G Summon Success");
		trigger.setCookie("Guardian_G","G_Success", 3600);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	} else{
		// 생성이 제대로 되지 않은 경우
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		Util.log("## Guardian_G Summon Fail");
		return;
      	}
}
quest						// 쿠스토 소환 주문서
qUseItem1003353()
{
        object guardian;
        string Ruling;
        object castle;
        string GuildName;
        object guild;
        string challenging;
	object world;
        integer mapcheck;
	string cName;
	string sValue;
	//integer xPoint = 0;
	//integer yPoint = 0;

        integer x = trigger.getX();
        integer y = trigger.getY();

	cName = trigger.getName();
	guild = trigger.getGuild(GD_TYPE_NORMAL);
    	GuildName = guild.getName();
        castle = Castle.getNumbered(2);
        Ruling = castle.getRulingGuildName();
        challenging = castle.getChallengingGuildName();
	world = trigger.getWorld();
	mapcheck = world.getNumber();
	sValue = trigger.getCookie("Guardian_C");

	if (!NormalItemCanBeUsed()) return;

	if (!guild.hasGuardian()) {
		// 신수를 소유하고 있지 않은 경우
		Util.log("## " + GuildName + " doesn`t have Guardian_C.");
		//메시지를 뿌려주고
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		//아이템을 파괴한다.
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}
	if(!castle.isInSiegeWar()){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_IS_INSIEGEWAR, MSG_TYPE__SYSTEM);
		return;
    	}
	if(guild.getMemberType(cName) != 1){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MEMBER_TYPE, MSG_TYPE__SYSTEM);
		return;
       	}
       	if(mapcheck != 283){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_MAP_CHECK, MSG_TYPE__SYSTEM);
		return;
	}
	if(sValue == "C_Success"){
		trigger.message(TEXT_USABLEITEM_GUARDIAN_COOKIE, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
	    	controller.decreaseNumber(1);
		return;
	}
/*
	if (!(x > 300 && x < 350 && y > 300 && y < 350)) {
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## can`t Put Guardian_B");
		return;
	}
*/
	if(GuildName == challenging){
		guardian = Guardian.summonByNumber(GuildName, 4, 283, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
      	} else if(GuildName == Ruling){
		guardian = Guardian.summonByNumber(GuildName, 4, 283, x+5, y+5, x+5, y+5, GDN_PTN_DEFAULT);
	} else {
		// 도전길드도 수성길드도 아닌 경우
		Util.log("## " + GuildName + " doesn`t related with castle.");
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN1, MSG_TYPE__SYSTEM);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	}

	if (guardian) {
		// 신수가 제대로 생성 된 경우
		Util.log("## Guardian_C Summon Success");
		trigger.setCookie("Guardian_C","C_Success", 3600);
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
		return;
	} else {
		// 생성이 제대로 되지 않은 경우
		trigger.message(TEXT_USABLEITEM_GUARDIAN_HASGUARDIAN2, MSG_TYPE__SYSTEM);
		Util.log("## Guardian_C Summon Fail");
		return;
	}
}

// 2004. 08. 26 Written by Han
// 추석 이벤트 아이템

quest
qUseItem1003513()				// 돼지고기 산적
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 250)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 250)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 250);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003514()				// 물고기 산적
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 250)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 250)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 250);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003515()				// 떡
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 250)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 250)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 250);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003516()				// 월병
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 250)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 250)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 250);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003517()				// 돼지고기
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 50)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 50)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 50);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003518()				// 물고기
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 50)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 50)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 50);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003519()				// 쌀가루
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 50)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 50)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 50);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003520()				// 밀가루
{
	if (!NormalItemCanBeUsed()) return;

	// hp 50 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 50)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 50)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 50);
	}

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1003671()		// 혼란의 깃털
{
	object target;
	target = controller.getPointArgumentAt(0);
	if (!target) return;

	target.changePattern("twEventPig.ptn");
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1003672()		// 혼돈의 깃털
{
	object target;
	target = controller.getPointArgumentAt(0);
	if (!target) return;

	target.changePattern("twEventChicken.ptn");
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

//===================================
// 2004. 09. 22 Written by Han
//===================================
quest
qUseItem1002986()		// 낡은 상자 (1~5월의 탄생석)
{
	trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX1, MSG_TYPE__AUTOHIDE_WINDOW);
}

quest
qUseItem1003285()		// 낡은 상자 (1~6월의 탄생석)
{
	trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX2, MSG_TYPE__AUTOHIDE_WINDOW);
}

quest
qUseItem1003660()		// 낡은 상자 (1~7월의 탄생석)
{
	trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX3, MSG_TYPE__AUTOHIDE_WINDOW);
}

quest
qUseItem1003751()		// 낡은 상자 (1~8월의 탄생석)
{
	integer nValue1, nValue2, nValue3;

	integer episode		= 1;
	integer gSwitch1	= 20;	// 챕터10 글로벌 스위치
	integer gSwitch2	= 21;	// 챕터11 글로벌 스위치
	integer gSwitch3	= 22;	// 챕터12 글로벌 스위치

	nValue1 = trigger.getGlobalSwitch(episode, gSwitch1);
	nValue2 = trigger.getGlobalSwitch(episode, gSwitch2);
	nValue3 = trigger.getGlobalSwitch(episode, gSwitch3);

	if(nValue3 >= 30)
	{
		trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX8, MSG_TYPE__AUTOHIDE_WINDOW);
		return;
	}
	else if(nValue2 >= 37)
	{
		trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX7, MSG_TYPE__AUTOHIDE_WINDOW);
		return;
	}
	else
	{
		if(nValue1 >= 31)
		{
			trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX6, MSG_TYPE__AUTOHIDE_WINDOW);
			return;
		}
		else if(nValue1 == 30)
		{
			trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX5, MSG_TYPE__AUTOHIDE_WINDOW);
			return;
		}
		else
		{
			trigger.message("<c8>" + TEXT_USABLEITEM_BIRTH_STONE_BOX4, MSG_TYPE__AUTOHIDE_WINDOW);
			return;
		}
	}
}

//======================================
// 챕터7 보상 아이템
// 2004. 10.01 Written by Han
//======================================
quest
qUseItem1003715()				// 도플갱어 혼의 조각(STAB + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgStab(trigger.getOrgStab() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_STAB_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003716()				// 도플갱어 혼의 조각(HACK + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgHack(trigger.getOrgHack() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_HACK_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003717()				// 도플갱어 혼의 조각(DEF + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgDefence(trigger.getOrgDefence() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEFENSE_DEF_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003718()				// 도플갱어 혼의 조각(INT + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgInt(trigger.getOrgInt() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_ATTACK_INT_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003719()				// 도플갱어 혼의 조각(MR + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgMagicResist(trigger.getOrgMagicResist() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEFENSE_MR_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003720()				// 도플갱어 혼의 조각(DEX + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgDex(trigger.getOrgDex() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_DEX_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003721()				// 도플갱어 혼의 조각(AGI + 2)
{
	if (!NormalItemCanBeUsed()) return;

	// decrease number
	if (controller.canBeExhausted())
	controller.decreaseNumber(1);

	trigger.setOrgAgi(trigger.getOrgAgi() + 2);
	trigger.updateAttr();

	trigger.message(TEXT_USABLEITEM_AGI_UP2 , MSG_TYPE__SYSTEM);

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItem1003859()				// 크리스마스 선물상자
{
	object rank;
	integer iMaxNum, iCount, iRandom;
	string strRankName, strUserName;

	if (!NormalItemCanBeUsed())	return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 25) {		// jaewook japan setting
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	//jaewooks japan version
/*	iRandom = Util.random(1, 50000);
	
	if	(iRandom <= 24455) trigger.addItemClassNamed("1000013", 1);
	else if	(iRandom <= 26455) trigger.addItemClassNamed("1002755", 1);
	else if	(iRandom <= 28455) trigger.addItemClassNamed("1000014", 1);
	else if	(iRandom <= 30455) trigger.addItemClassNamed("1000015", 1);
	else if	(iRandom <= 32455) trigger.addItemClassNamed("1000024", 1);
	else if	(iRandom <= 34455) trigger.addItemClassNamed("1000025", 1);
	else if	(iRandom <= 36455) trigger.addItemClassNamed("1000026", 1);
	else if	(iRandom <= 38455) trigger.addItemClassNamed("1000035", 1);
	else if	(iRandom <= 40455) trigger.addItemClassNamed("1000036", 1);
	else if	(iRandom <= 42455) trigger.addItemClassNamed("1000037", 1);
	else if	(iRandom <= 43455) trigger.addItemClassNamed("1001060", 1);
	else if	(iRandom <= 44155) trigger.addItemClassNamed("1000097", 1);
	else if	(iRandom <= 44855) trigger.addItemClassNamed("1000100", 1);
	else if	(iRandom <= 45555) trigger.addItemClassNamed("1000103", 1);
	else if	(iRandom <= 46055) trigger.addItemClassNamed("1000052", 1);
	else if	(iRandom <= 46555) trigger.addItemClassNamed("1001808", 1);
	else if	(iRandom <= 47055) trigger.addItemClassNamed("1002031", 1);
	else if	(iRandom <= 47555) trigger.addItemClassNamed("1000934", 1);
	else if	(iRandom <= 47955) trigger.addItemClassNamed("1002655", 1);
	else if	(iRandom <= 48355) trigger.addItemClassNamed("1002656", 1);
	else if	(iRandom <= 48755) trigger.addItemClassNamed("1002677", 1);
	else if	(iRandom <= 49155) trigger.addItemClassNamed("1002321", 1);
	else if	(iRandom <= 49555) trigger.addItemClassNamed("1002157", 1);
	else if	(iRandom <= 49955) trigger.addItemClassNamed("1002697", 1);
	else if	(iRandom <= 49965) trigger.addItemClassNamed("1003040", 1);
	else if	(iRandom <= 49975) trigger.addItemClassNamed("1003041", 1);
	else if	(iRandom <= 49985) trigger.addItemClassNamed("1003042", 1);
	else if	(iRandom <= 49995) trigger.addItemClassNamed("1003043", 1);
	else if	(iRandom <= 49996) trigger.addItemClassNamed("1000987", 1);
	else if	(iRandom <= 49997) trigger.addItemClassNamed("1000988", 1);
	else if	(iRandom <= 49998) trigger.addItemClassNamed("1000989", 1);
	else if	(iRandom <= 49999) trigger.addItemClassNamed("1000990", 1);
	else if	(iRandom <= 50000) trigger.addItemClassNamed("1000991", 1); */


	iRandom = Util.random(1, 999);		//jaewook korean version


	strUserName = trigger.getName();

	if(iRandom <= 2) //1004388	신비한 정령석 2/1000
	{
		strRankName = "XMAXS_EVENT1_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 2;

		if(iMaxNum > iCount) //지급 가능 일때
		{
			trigger.addItemClassNamed("1004388", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else //꽝은 존재하지 않으므로 가장 많이 나오는 1000022	생명의 조각 지급
		{
			trigger.addItemClassNamed("1000022", 1);
		}
	}
	else if(iRandom <= 4) //1004390	에이션트 아머 2/1000
	{
		strRankName = "XMAXS_EVENT2_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 2;

		if(iMaxNum > iCount) //지급 가능 일때
		{
			trigger.addItemClassNamed("1004390", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else //꽝은 존재하지 않으므로 가장 많이 나오는 1000022	생명의 조각 지급
		{
			trigger.addItemClassNamed("1000022", 1);
		}
	}
	else if(iRandom <= 6) //1004392	순록옷 2/1000
	{
		strRankName = "XMAXS_EVENT3_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 2;

		if(iMaxNum > iCount) //지급 가능 일때
		{
			trigger.addItemClassNamed("1004392", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else //꽝은 존재하지 않으므로 가장 많이 나오는 1000022	생명의 조각 지급
		{
			trigger.addItemClassNamed("1000022", 1);
		}
	}
	else if(iRandom <= 14) //1004338	보라색 뽀글머리 8/1000
	{
		trigger.addItemClassNamed("1004338", 1);
	}
	else if(iRandom <= 22) //1004339	주황색 뽀글머리 8/1000
	{
		trigger.addItemClassNamed("1004339", 1);
	}
	else if(iRandom <= 30) //1000968	연두색 뽀글머리 8/1000
	{
		trigger.addItemClassNamed("1000968", 1);
	}
	else if(iRandom <= 38) //1005008	황금색 뽀글머리 8/1000
	{
		trigger.addItemClassNamed("1005008", 1);
	}
	else if(iRandom <= 48) //1002008	인크립트 스크롤 10/1000
	{
		trigger.addItemClassNamed("1002008", 1);
	}
	else if(iRandom <= 62) //1000665	숫돌 14/1000
	{
		trigger.addItemClassNamed("1000665", 1);
	}
	else if(iRandom <= 76) //1000392	그라인더 14/1000
	{
		trigger.addItemClassNamed("1000392", 1);
	}
	else if(iRandom <= 90) //1000350	탄성 로션(대) 14/1000
	{
		trigger.addItemClassNamed("1000350", 1);
	}
	else if(iRandom <= 104) //1000329	마력강화제(대) 14/1000
	{
		trigger.addItemClassNamed("1000329", 1);
	}
	else if(iRandom <= 118) //1000686	여신의 가호 14/1000
	{
		trigger.addItemClassNamed("1000686", 1);
	}
	else if(iRandom <= 484) //1001808	마나의 결정 370/100
	{
		trigger.addItemClassNamed("1001808", 1);
	}
	else if(iRandom <= 999) //1000022	생명의 조각 나머지/1000
	{
		trigger.addItemClassNamed("1000022", 1);
	}				//jaewook korean version

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	controller.effectBy(trigger);
}


quest
ShoutMessage()
{
	if (trigger.getCarryingItemInventory().getCountClassNamed("1003873") < 1) {
		trigger.message(TEXT_USABLEITEM_CANT_EXHAUST, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getBuilderType() == 1 || trigger.getBuilderType() == 2) {
		trigger.getWorld().broadcast("<c8>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);
	} else {
		trigger.getWorld().broadcast("<c8>" + Util.filterCurse(trigger.getQuestArgument()) + " </n></n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
	}
	trigger.removeItemClassNamed("1003873", 1);
}


quest
qUseItem1003873()				// 외치기 스크롤
{
	if (!NormalItemCanBeUsed()) return;
	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE, "ShoutMessage", controller);
}


quest
ShoutMessage1()
{
//	trigger.setCookie("S_M", "<c8>" + Util.filterCurse(trigger.getQuestArgument()), 0);
	trigger.setStringValue(3, "<c8>" + Util.filterCurse(trigger.getQuestArgument()));
	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE2, "ShoutMessage2", controller);
}

quest
ShoutMessage2()
{

	if (trigger.getCarryingItemInventory().getCountClassNamed("1003874") < 1) {
		trigger.message(TEXT_USABLEITEM_CANT_EXHAUST, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getBuilderType() == 1 || trigger.getBuilderType() == 2) {
//		trigger.getWorld().broadcast("</n>" + trigger.getCookie("Item_Message") + "</n>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);
		trigger.getWorld().broadcast("</n>" + trigger.getStringValue(3) + "</n>" + Util.filterCurse(trigger.getQuestArgument()), MSG_TYPE__AUTOHIDE_WINDOW);
	} else {
//		trigger.getWorld().broadcast(trigger.getCookie("S_M") + "</n>" + Util.filterCurse(trigger.getQuestArgument()) + " </n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
		trigger.getWorld().broadcast(trigger.getStringValue(3) + "</n>" + Util.filterCurse(trigger.getQuestArgument()) + " </n><c9></r>[From " + trigger.getName() + "]", MSG_TYPE__AUTOHIDE_WINDOW);
	}
	trigger.resetStringValue(3);
	trigger.removeItemClassNamed("1003874", 1);
}

quest
qUseItem1003874()				// 외치기 스크롤 2줄짜리
{
	if (!NormalItemCanBeUsed()) return;
	trigger.sendDescribeQuestMessage(TEXT_USABLEITEM_GET_MESSAGE1, "ShoutMessage1", controller);
}



quest
qUseItem1003872()			// 중국용 즉석복권
{
/*		vahma - for japan setting
	integer rval, tickTime, iBirth;
	integer rCount, cnt, remain;
	string userName, sValue;
	object rank;

	// 복권 1일 사용 회수 제한 -> Cookie 로 변경
	sValue = trigger.getCookie("LOTTERY");
	cnt = String.toInteger(sValue) + 1;
	// cnt = trigger.getIntValue(2) + 1;
	if (cnt > 10) {
		trigger.message(TEXT_LOTTERY_CANT, MSG_TYPE__AUTOHIDE_WINDOW);
		return;
	}

	trigger.setCookie("LOTTERY", Integer.toString(cnt), 86400);
	// trigger.setIntValue(2, cnt);

	rval = Util.random(0, 50000);

	// Log Info
	tickTime = Util.getTick();
	userName = trigger.getName();
	iBirth = trigger.getBirthTime();

	// 금주 복권 당첨 완료 여부 체크
	rank = Rank.select("LOTTERY_5TH");
	rCount = rank.getCount();
	if (rCount >= 111) {
		rank = Rank.select("LOTTERY_4TH");
		rCount = rank.getCount();

		if (rCount >= 10) {
			rank = Rank.select("LOTTERY_3RD");
			rCount = rank.getCount();

			if (rCount >= 4) {
				rank = Rank.select("LOTTERY_2ND");
				rCount = rank.getCount();

				if (rCount >= 2) {
					rank = Rank.select("LOTTERY_1ST");
					rCount = rank.getCount();

					if (rCount >= 1) {
						trigger.message(TEXT_LOTTERY_NULL, MSG_TYPE__AUTOHIDE_WINDOW);
						trigger.message(TEXT_LOTTERY_NULL2, MSG_TYPE__AUTOHIDE_WINDOW);
						return;
					}
				}
			}
		}
	}

	if (rval >= 10000) {	// 꽝
		trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
//		trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__SYSTEM);
	} else if (rval >= 9889) {	// 5등 111명 -> 50명으로 수정
		rank = Rank.select("LOTTERY_5TH");
		rCount = rank.getCount();

		if(rCount < 50) {
			// trigger.setGold(trigger.getGold() + 5000);	//가격은 일단 5000 SEED로 하자.
			Util.log("### LOTTERY UserName[" + userName + "] 5TH " + rCount + " On time = [" + Util.getTimeString("%A %b %d %T") + "] ###");
			if (!Rewards("LOTTERY05")) {
				trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
			} else {
				remain = 49 - rCount;
				rank.add(userName, 0, 0, 0, iBirth, "null");
				// Util.notifyToAllUser(TEXT_LOTTERY_CONG + trigger.getName() + TEXT_LOTTERY_NAME + "5" + TEXT_LOTTERY_CNT);
				Util.notifyToAllUser(TEXT_LOTTERY_CONG);
				Util.notifyToAllUser(trigger.getName() + TEXT_LOTTERY_NAME + "5" + TEXT_LOTTERY_CNT + TEXT_LOTTERY_COUNT + remain + ")");
				if (remain == 0)
					Util.notifyToAllUser(TEXT_LOTTERY_END + "5" + TEXT_LOTTERY_END2);
			}
		} else {
			trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
		}

	} else if (rval >= 9879) {	// 4등 10명
		rank = Rank.select("LOTTERY_4TH");
		rCount = rank.getCount();

		if(rCount < 10) {
			Util.log("### LOTTERY UserName[" + userName + "] 4TH " + rCount + " On time = [" + Util.getTimeString("%A %b %d %T") + "] ###");
			if (!Rewards("LOTTERY04")) {
				trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
			} else {
				remain = 9 - rCount;
				rank.add(userName, 0, 0, 0, iBirth, "null");
				Util.notifyToAllUser(TEXT_LOTTERY_CONG);
				Util.notifyToAllUser(trigger.getName() + TEXT_LOTTERY_NAME + "4" + TEXT_LOTTERY_CNT + TEXT_LOTTERY_COUNT + remain + ")");
				// Util.notifyToAllUser(TEXT_LOTTERY_CONG + trigger.getName() + TEXT_LOTTERY_NAME + "4" + TEXT_LOTTERY_CNT);
				if (remain == 0)
					Util.notifyToAllUser(TEXT_LOTTERY_END + "4" + TEXT_LOTTERY_END2);
			}
		} else {
			trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
		}
	} else if (rval >= 9875) {	// 3등 4명
		rank = Rank.select("LOTTERY_3RD");
		rCount = rank.getCount();

		if(rCount < 4) {
			Util.log("### LOTTERY UserName[" + userName + "] 3RD " + rCount + " On time = [" + Util.getTimeString("%A %b %d %T") + "] ###");
			if (!Rewards("LOTTERY03")) {
				trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
			} else {
				remain = 3 - rCount;
				rank.add(userName, 0, 0, 0, iBirth, "null");
				Util.notifyToAllUser(TEXT_LOTTERY_CONG);
				Util.notifyToAllUser(trigger.getName() + TEXT_LOTTERY_NAME + "3" + TEXT_LOTTERY_CNT + TEXT_LOTTERY_COUNT + remain + ")");
				// Util.notifyToAllUser(TEXT_LOTTERY_CONG + trigger.getName() + TEXT_LOTTERY_NAME + "3" + TEXT_LOTTERY_CNT);
				if (remain == 0)
					Util.notifyToAllUser(TEXT_LOTTERY_END + "3" + TEXT_LOTTERY_END2);
			}
		} else {
			trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
		}
	} else if (rval >= 9873) {	// 2등 2명
		rank = Rank.select("LOTTERY_2ND");
		rCount = rank.getCount();

		if(rCount < 2) {
			// trigger.addItemClassNamed("1000022", 1);
			// trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
			Util.log("### LOTTERY UserName[" + userName + "] 2ND " + rCount + " On time = [" + Util.getTimeString("%A %b %d %T") + "] ###");
			if (!Rewards("LOTTERY02")) {
				trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
			} else {
				remain = 1 - rCount;
				rank.add(userName, 0, 0, 0, iBirth, "null");
				Util.notifyToAllUser(TEXT_LOTTERY_CONG);
				Util.notifyToAllUser(trigger.getName() + TEXT_LOTTERY_NAME + "2" + TEXT_LOTTERY_CNT + TEXT_LOTTERY_COUNT + remain + ")");
				// Util.notifyToAllUser(TEXT_LOTTERY_CONG + trigger.getName() + TEXT_LOTTERY_NAME + "2" + TEXT_LOTTERY_CNT);
				if (remain == 0)
					Util.notifyToAllUser(TEXT_LOTTERY_END + "2" + TEXT_LOTTERY_END2);
			}
		} else {
			trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
		}
	} else if (rval >= 9872) {	// 1등 1명
		rank = Rank.select("LOTTERY_1ST");
		rCount = rank.getCount();

		if(rCount < 1) {
			Util.log("### LOTTERY UserName[" + userName + "] 1ST " + rCount + " On time = [" + Util.getTimeString("%A %b %d %T") + "] ###");
			// 아이템 주는 부분 테이블용으로 수정하기해야 함.
			// trigger.addItemClassNamed("1000126", 1);
			if (!Rewards("LOTTERY01")) {
				trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
			} else {
				remain = 1 - rCount;
				rank.add(userName, 0, 0, 0, iBirth, "null");
				Util.notifyToAllUser(TEXT_LOTTERY_CONG);
				Util.notifyToAllUser(trigger.getName() + TEXT_LOTTERY_NAME + "1" + TEXT_LOTTERY_CNT);
				// Util.notifyToAllUser(TEXT_LOTTERY_CONG + trigger.getName() + TEXT_LOTTERY_NAME + "1" + TEXT_LOTTERY_CNT);
				// trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
				Util.notifyToAllUser(TEXT_LOTTERY_END + "1" + TEXT_LOTTERY_END2);
			}
		} else {
			// 5등으로 처리할지 꽝으로 처리할지 고민 필요. 일단 꽝.
			trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
		}
	} else {	// 꽝
		trigger.message(TEXT_LOTTERY_FAIL, MSG_TYPE__AUTOHIDE_WINDOW);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
*/	// vahma - japan setting
}


quest
qUseItem1003886()		// 횃불
{
	UseSkill(trigger,"3000253",1800);
}


quest
qUseItem1003890()	// 여름 방학 아이템 사용시 수집 상황을 보여주는 메시지 박스.
{
	integer slot, cAll;
	object chk_obj, item2;

	for (slot = trigger.getFirstItemSlot(); slot; slot = trigger.getNextItemSlot(slot)) {
		chk_obj = trigger.getCarryingItemInventory().at(slot);
		if (chk_obj.getClassName() == "1003890") {
			item2 = chk_obj;
			break;
		}
	}
	if (item2.checkAttribute("S3") == true)
		cAll = String.toInteger(item2.getAttribute("S3"));
	else
		cAll = 0;

	trigger.message(SUMMER2005_MSG1 + cAll + SUMMER2005_MSG2, MSG_TYPE__AUTOHIDE_WINDOW);
}

quest
qCanUseRecipe()		// 요리 레시피 아이템 설정 (사용할 수 있는지)
{
	object skill_Cook;
	object skill_Hurb;
	boolean result = true;
	string recipe = Machine.getArgAt(0);
	string recipeLevel = Machine.getArgAt(1);
	integer recipeType = String.toInteger(Machine.getArgAt(2));

	skill_Cook = trigger.getSkillActionInventory().getNamed("3001731");
	skill_Hurb = trigger.getSkillActionInventory().getNamed("3001751");

	if(recipeType == 1)
	{
		if(skill_Cook == null)
		{
			trigger.message(TEXT_USABLEITEM_COOK_NOT2, MSG_TYPE__SYSTEM);
			result = false;
		}
		if(skill_Cook.getLevel() < String.toInteger(recipeLevel))
		{
			trigger.message(TEXT_USABLEITEM_COOK_NOT, MSG_TYPE__SYSTEM);
			result = false;
		}

		if (trigger.hasRecipe(recipe, recipeType))
		{
			trigger.message(TEXT_USABLEITEM_CAN_RECIPE, MSG_TYPE__SYSTEM);
			result = false;
		}
		else if (!trigger.canAddRecipe(recipe, recipeType))
		{
			trigger.message(TEXT_USABLEITEM_RECIPE, MSG_TYPE__SYSTEM);
			result = false;
		}
	}
	else if(recipeType == 2)
	{
		if(skill_Hurb == null)
		{
			trigger.message(TEXT_USABLEITEM_HURB_NOT2, MSG_TYPE__SYSTEM);
			result = false;
		}
		if(skill_Hurb.getLevel() < String.toInteger(recipeLevel))
		{
			trigger.message(TEXT_USABLEITEM_HURB_NOT, MSG_TYPE__SYSTEM);
			result = false;
		}

		if (trigger.hasRecipe(recipe, recipeType))
		{
			trigger.message(TEXT_USABLEITEM_CAN_RECIPE2, MSG_TYPE__SYSTEM);
			result = false;
		}
		else if (!trigger.canAddRecipe(recipe, recipeType))
		{
			trigger.message(TEXT_USABLEITEM_RECIPE2, MSG_TYPE__SYSTEM);
			result = false;
		}
	}
	Machine.setBooleanReturn(result);
	return;
}

quest
qUseRecipe()		// 요리 레시피 아이템 설정 (사용할 수 있다면 실행)
{
	string recipe = Machine.getArgAt(0);
	string cookName = Machine.getArgAt(1);
	integer recipeType = String.toInteger(Machine.getArgAt(2));

	trigger.addRecipe(recipe, recipeType);

	if(recipeType == 1)
		trigger.message(TEXT_USABLEITEM_COOK_LEARN + cookName, MSG_TYPE__SYSTEM);
	else if(recipeType == 2)
		trigger.message(TEXT_USABLEITEM_HURB_LEARN + cookName, MSG_TYPE__SYSTEM);

	controller.decreaseNumber(1);
	return;
}

quest
qUseItem1003925()				// 녹슨 상자
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 100);

	if (selection <= 1) {			// 다이아몬드
		itemID	= "1000256";
	} else if (selection <= 10) {		// 해골반지
		itemID	= "1001867";
	} else if (selection <= 20) {		// 나막신
		itemID	= "1000957";
	} else if (selection <= 40) {		// 반창고
		itemID	= "1000903";
	} else if (selection <= 100) {		// 가드
		itemID	= "1000861";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003926()				// 낡은 상자
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 100);

	if (selection <= 1) {			// 100년 묵은 버섯
		itemID	= "1001252";
	} else if (selection <= 8) {		// 부활의 향수
		itemID	= "1001891";
	} else if (selection <= 17) {		// 칵테일
		itemID	= "1001026";
	} else if (selection <= 35) {		// 가죽장갑
		itemID	= "1000914";
	} else if (selection <= 100) {		// 고양이의 발톱
		itemID	= "1001875";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003927()				// 나무 상자
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 100);

	if (selection <= 1) {			// 와인
		itemID	= "1001027";
	} else if (selection <= 6) {		// 사각 깃발
		itemID	= "1000883";
	} else if (selection <= 14) {		// 꽃잎 머리핀
		itemID	= "1000902";
	} else if (selection <= 30) {		// 정령초
		itemID	= "1001827";
	} else if (selection <= 100) {		// 수선 도구
		itemID	= "1000076";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003928()				// 청동 상자
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 100);

	if (selection <= 1) {			// 근성의 메추리알
		itemID	= "1000138";
	} else if (selection <= 10) {		// 폭탄주
		itemID	= "1001029";
	} else if (selection <= 20) {		// 5급 바인딩 스톤
		itemID	= "1002992";
	} else if (selection <= 40) {		// 멘딩 키트(소)
		itemID	= "1000079";
	} else if (selection <= 100) {		// 힐링 포션(대)
		itemID	= "1000018";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003929()				// 철제 상자
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 50000);					//vahma

	if (selection <= 1) {			// ?????		//vahma
		itemID	= "1000126";						//vahma
	} else if (selection <= 2) {		// Ti??		//vahma
		itemID	= "1000132";						//vahma
	} else if (selection <= 20000) {		// J???@	//vahma
		itemID	= "1001890";						//vahma
	} else if (selection <= 30000) {		// Y苞`?胞U	//vahma
		itemID	= "1001864";						//vahma
	} else if (selection <= 40000) {		// R??i		//vahma
		itemID	= "1000022";						//vahma
	} else if (selection <= 45000) {		// R??i		//vahma
		itemID	= "1003504";						//vahma
	} else if (selection <= 50000) {		// R??i		//vahma
		itemID	= "1000041";						//vahma
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003930()	// 각진 물고기 (녹슨상자)
{
	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 아이템을 준다. (녹슨상자)
	trigger.addItemClassNamed("1003925", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003931()	// 각진 물고기 (낡은상자)
{
	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 아이템을 준다. (낡은상자)
	trigger.addItemClassNamed("1003926", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003932()	// 각진 물고기 (나무상자)
{
	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 아이템을 준다. (나무상자)
	trigger.addItemClassNamed("1003927", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003933()	// 각진 물고기 (청동상자)
{
	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 아이템을 준다. (청동상자)
	trigger.addItemClassNamed("1003928", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1003934()	// 각진 물고기 (철제상자)
{
	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 아이템을 준다. (철제상자)
	trigger.addItemClassNamed("1003929", 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qCookUseItem()		// 요리 회복 아이템 사용
{

	object castedSpellInven;

	string Type = Machine.getArgAt(0);

	castedSpellInven = trigger.getCastedSpellInventory();
	if (castedSpellInven.hasNamed("3001835") || castedSpellInven.hasNamed("3001836")
	 || castedSpellInven.hasNamed("3001837") || castedSpellInven.hasNamed("3001838") 
	 || castedSpellInven.hasNamed("3001839") || castedSpellInven.hasNamed("3001840")
	 || castedSpellInven.hasNamed("3001841") || castedSpellInven.hasNamed("3001842")
	 || castedSpellInven.hasNamed("3001843") || castedSpellInven.hasNamed("3001844")
	 || castedSpellInven.hasNamed("3001845") || castedSpellInven.hasNamed("3001846")
	 || castedSpellInven.hasNamed("3001847") || castedSpellInven.hasNamed("3001848")
	 || castedSpellInven.hasNamed("3001849") || castedSpellInven.hasNamed("3001850")
	 || castedSpellInven.hasNamed("3001851") || castedSpellInven.hasNamed("3001852")
	 || castedSpellInven.hasNamed("3001853") || castedSpellInven.hasNamed("3001854")
	 || castedSpellInven.hasNamed("3001855") || castedSpellInven.hasNamed("3001856")
	 || castedSpellInven.hasNamed("3001857") || castedSpellInven.hasNamed("3001858")
	 || castedSpellInven.hasNamed("3001859") || castedSpellInven.hasNamed("3001860")
	 || castedSpellInven.hasNamed("3001861") || castedSpellInven.hasNamed("3001862")
	 || castedSpellInven.hasNamed("3001863") || castedSpellInven.hasNamed("3001864")
	 || castedSpellInven.hasNamed("3001865") || castedSpellInven.hasNamed("3001866")
	 || castedSpellInven.hasNamed("3001894"))
	{
		trigger.message(TEXT_USABLEITEM_COOKS_ERROR, MSG_TYPE__SYSTEM);
		return;
	}
	if(Type == "1")
	{
		UseSkill(trigger,"3001835", 300);
	}
	else if(Type == "2")
	{
		UseSkill(trigger,"3001836", 300);
	}
	else if(Type == "3")
	{
		UseSkill(trigger,"3001837", 300);
	}
	else if(Type == "4")
	{
		UseSkill(trigger,"3001838", 300);
	}
	else if(Type == "5")
	{
		UseSkill(trigger,"3001839", 300);
	}
	else if(Type == "6")
	{
		UseSkill(trigger,"3001840", 300);
	}
	else if(Type == "7")
	{
		UseSkill(trigger,"3001841", 300);
	}
	else if(Type == "8")
	{
		UseSkill(trigger,"3001842", 300);
	}
	else if(Type == "9")
	{
		UseSkill(trigger,"3001843", 300);
	}
	else if(Type == "10")
	{
		UseSkill(trigger,"3001844", 300);
	}
	else if(Type == "11")
	{
		UseSkill(trigger,"3001845", 300);
	}
	else if(Type == "12")
	{
		UseSkill(trigger,"3001846", 300);
	}
	else if(Type == "13")
	{
		UseSkill(trigger,"3001847", 300);
	}
	else if(Type == "14")
	{
		UseSkill(trigger,"3001848", 300);
	}
	else if(Type == "15")
	{
		UseSkill(trigger,"3001849", 300);
	}
	else if(Type == "16")
	{
		UseSkill(trigger,"3001850", 300);
	}
	else if(Type == "17")
	{
		UseSkill(trigger,"3001851", 300);
	}
	else if(Type == "18")
	{
		UseSkill(trigger,"3001852", 300);
	}
	else if(Type == "19")
	{
		UseSkill(trigger,"3001853", 300);
	}
	else if(Type == "20")
	{
		UseSkill(trigger,"3001854", 300);
	}
	else if(Type == "21")
	{
		UseSkill(trigger,"3001855", 300);
	}
	else if(Type == "22")
	{
		UseSkill(trigger,"3001856", 300);
	}
	else if(Type == "23")
	{
		UseSkill(trigger,"3001857", 300);
	}
	else if(Type == "24")
	{
		UseSkill(trigger,"3001858", 300);
	}
	else if(Type == "25")
	{
		UseSkill(trigger,"3001859", 300);
	}
	else if(Type == "26")
	{
		UseSkill(trigger,"3001860", 300);
	}
	else if(Type == "27")
	{
		UseSkill(trigger,"3001861", 300);
	}
	else if(Type == "28")
	{
		UseSkill(trigger,"3001862", 300);
	}
	else if(Type == "29")
	{
		UseSkill(trigger,"3001863", 300);
	}
	else if(Type == "30")
	{
		UseSkill(trigger,"3001864", 300);
	}
	else if(Type == "31")
	{
		UseSkill(trigger,"3001865", 300);
	}
	else if(Type == "32")
	{
		UseSkill(trigger,"3001866", 300);
	}
	else if(Type == "33")
	{
		UseSkill(trigger,"3001867", 300);
	}
	return;
}

quest
qUseItem1003902()		// 복주머니 (중국 설날 이벤트용)
{
	object rank;
	integer iMaxNum, iCount, iRandom;
	string strRankName, strUserName;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}
	if(Util.getRealNationType() == KOREA)
	{
		return;
	}

	iRandom = Util.random(1, 1000);

	strUserName = trigger.getName();

	if(iRandom == 1)	 // 1000991	홍염슈즈 1/1000
	{
		strRankName = "NEWYEAR_EVENT1_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 1;

		if(iMaxNum > iCount) //지급 가능 일때
		{
			trigger.addItemClassNamed("1000991", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else	// 꽝은 존재하지 않으므로 가장 많이 나오는 1001808 인크립트 스크롤 지급
		{
			trigger.addItemClassNamed("1001808", 1);
		}
	}
	else if(iRandom <= 2)	// 1000990	홍염팔찌 1/1000
	{
		strRankName = "NEWYEAR_EVENT2_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 3;

		if(iMaxNum > iCount) // 지급 가능 일때
		{
			trigger.addItemClassNamed("1000990", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else	// 꽝은 존재하지 않으므로 1001808 인크립트 스크롤 지급
		{
			trigger.addItemClassNamed("1001808", 1);
		}
	}
	else if(iRandom <= 3)	// 1000988	홍염날개 1/1000
	{
		strRankName = "NEWYEAR_EVENT3_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 1;

		if(iMaxNum > iCount) // 지급 가능 일때
		{
			trigger.addItemClassNamed("1000988", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else	// 꽝은 존재하지 않으므로 1001808 인크립트 스크롤 지급
		{
			trigger.addItemClassNamed("1001808", 1);
		}
	}
	else if(iRandom <= 4)	// 1000989	홍염갑옷 1/1000
	{
		strRankName = "NEWYEAR_EVENT4_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 3;

		if(iMaxNum > iCount) // 지급 가능 일때
		{
			trigger.addItemClassNamed("1000989", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else	// 꽝은 존재하지 않으므로 1001808 인크립트 스크롤 지급
		{
			trigger.addItemClassNamed("1001808", 1);
		}
	}
	else if(iRandom <= 5)	// 1000987	홍염투구 1/1000
	{
		strRankName = "NEWYEAR_EVENT5_ITEM";
		rank = Rank.select(strRankName);
		iCount = rank.getCount();
		iMaxNum = 3;

		if(iMaxNum > iCount) // 지급 가능 일때
		{
			trigger.addItemClassNamed("1000987", 1);
			rank.add(strUserName,0, 0, 0, trigger.getBirthTime(), "null");
		}
		else	// 꽝은 존재하지 않으므로 1001808 인크립트 스크롤 지급
		{
			trigger.addItemClassNamed("1001808", 1);
		}
	}
	else if(iRandom <= 30)	// 1000115	네잎 크로버 25/1000
	{
		trigger.addItemClassNamed("1000115", 1);
	}
	else if(iRandom <= 50)	// 1001807	영혼 정화석 20/1000
	{
		trigger.addItemClassNamed("1001807", 1);
	}
	else if(iRandom <= 100)	// 1000093	숫돌 50/1000
	{
		trigger.addItemClassNamed("1000093", 1);
	}
	else if(iRandom <= 150)	// 1000094	그라인더 50/1000
	{
		trigger.addItemClassNamed("1000094", 1);
	}
	else if(iRandom <= 200)	// 1000097	탄성 로션(대) 50/1000
	{
		trigger.addItemClassNamed("1000097", 1);
	}
	else if(iRandom <= 250)	// 1000100	마력강화제(대) 50/1000
	{
		trigger.addItemClassNamed("1000100", 1);
	}
	else if(iRandom <= 300)	// 1000103	여신의 가호 50/1000
	{
		trigger.addItemClassNamed("1000103", 1);
	}
	else if(iRandom <= 600)	// 1001808	인크립트 스크롤 300/1000
	{
		trigger.addItemClassNamed("1001808", 1);
	}
	else if(iRandom <= 1000)// 1000033	888 SEED 400/1000
	{
		trigger.setBalance(trigger.getBalance() + 888);
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	controller.effectBy(trigger);
}

quest
qUseItem1004270()		// 작은 복주머니 (설날 이벤트용)
{
	integer iRandom;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	iRandom = Util.random(1, 1000);

	if(iRandom <= 50)	// 1000038	리저렉션 포션(소) 5/100
	{
		trigger.addItemClassNamed("1000038", 1);
	}
	else if(iRandom <= 100)	// 1000052	만병 통치약 5/100
	{
		trigger.addItemClassNamed("1000052", 1);
	}
	else if(iRandom <= 150)	// 1000019	라이프 포션(소) 5/100
	{
		trigger.addItemClassNamed("1000019", 1);
	}
	else if(iRandom <= 250)	// 1000017	힐링포션(중) 10/100
	{
		trigger.addItemClassNamed("1000017", 1);
	}
	else if(iRandom <= 400)	// 1000036	리바이브 파우더 15/100
	{
		trigger.addItemClassNamed("1000036", 1);
	}
	else if(iRandom <= 600)	// 1000026	키위주스 20/100
	{
		trigger.addItemClassNamed("1000026", 1);
	}
	else if(iRandom <= 800)	// 1000043	해독제 20/100
	{
		trigger.addItemClassNamed("1000043", 1);
	}
	else if(iRandom <= 1000)// 1000035	바이올렛 허브 20/100
	{
		trigger.addItemClassNamed("1000035", 1);
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	controller.effectBy(trigger);
}

quest
qUseItem1004269()		// 큰 복주머니 (설날 이벤트용)
{
	integer iRandom;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	iRandom = Util.random(1, 1000);

	if(iRandom <= 10)	// 1001808	인크립트 스크롤 1/100
	{
		trigger.addItemClassNamed("1001808", 1);
	}
	else if(iRandom <= 100)	// 1001894	적중의 푸딩 9/100
	{
		trigger.addItemClassNamed("1001894", 1);
	}
	else if(iRandom <= 190)	// 1001893	축복의 성수 9/100
	{
		trigger.addItemClassNamed("1001893", 1);
	}
	else if(iRandom <= 280)	// 1001890	질풍의 약초 9/100
	{
		trigger.addItemClassNamed("1001890", 1);
	}
	else if(iRandom <= 370)	// 1001889	신속의 열매 9/100
	{
		trigger.addItemClassNamed("1001889", 1);
	}
	else if(iRandom <= 580)	// 1000028	마나 포션(중) 21/100
	{
		trigger.addItemClassNamed("1000028", 5);
	}
	else if(iRandom <= 790)	// 1000017	힐링 포션(중) 21/100
	{
		trigger.addItemClassNamed("1000017", 5);
	}
	else if(iRandom <= 1000)// 1001003	스테미너 포션(중) 21/100
	{
		trigger.addItemClassNamed("1001003", 5);
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	controller.effectBy(trigger);
}

quest
qUseItem1004289()	// 루모리 특산 포션(소)
{
	if (!NormalItemCanBeUsed()) return;

	// hp 250 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 250)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 250)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 250);
	}

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004290()	// 루모리 특산 포션(중)
{
	if (!NormalItemCanBeUsed()) return;

	// hp 400 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 400)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 400)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 400);
	}
	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004291()	// 루모리 특산 포션(대)
{
	if (!NormalItemCanBeUsed()) return;

	// hp 600 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 600)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 600)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 600);
	}

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004292()	// 루모리 특산 포션(특)
{
	if (!NormalItemCanBeUsed()) return;

	// hp 1000 회복
	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING))
	{
		if (!HardCode.itemDownHP(trigger, 1000)) return;
	}
	else
	{
		if (!HardCode.itemUpHP(trigger, 1000)) return;

		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, 1000);
	}

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004293()	// 활력 포션 (소)
{
	integer maxSP;
	if (!NormalItemCanBeUsed()) return;

	maxSP = trigger.getMaxSP();
	maxSP = (maxSP / 100) * 10;

	// SP 10% 회복
	if (!ItemUpSP(trigger, maxSP)) return;

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004294()	// 활력 포션 (중)
{
	integer maxSP;
	if (!NormalItemCanBeUsed()) return;

	maxSP = trigger.getMaxSP();
	maxSP = (maxSP / 100) * 20;

	// SP 20% 회복
	if (!ItemUpSP(trigger, maxSP)) return;

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

quest
qUseItem1004295()	// 활력 포션 (대)
{
	integer maxSP;
	if (!NormalItemCanBeUsed()) return;

	maxSP = trigger.getMaxSP();
	maxSP = (maxSP / 100) * 30;

	// SP 30% 회복
	if (!ItemUpSP(trigger, maxSP)) return;

	// decrease number
	if (controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


quest
qUseItemFLAG() 				// 로슈 1호 포션 깃발뺏기 전용 염가판
{
	integer value;

	if (!FlagCastle.getObject(trigger.getWorld().getCastleNumber())) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	if (!NormalItemCanBeUsed()) return;

	// HP 140~240 상승 (범위 값)
	value = Util.random(140, 240);

	if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
		if (!HardCode.itemDownHP(trigger, value)) return;
	} else if (!HardCode.itemUpHP(trigger, value)) {
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
			ItemBalloonUpHP(trigger, value);
	}
	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
	controller.effectBy(trigger);
}

// 2005. 04. 19 조제 아이템 by Han

quest
qUseItem1004455()		// 암흑마법 중화제 (저주, 중독, 암흑, 언데드, 물리방어 약화)
{
	object castedSpellInven;

	if(!NormalItemCanBeUsed()) return;

	castedSpellInven = trigger.getCastedSpellInventory();

	if(castedSpellInven.hasNamed("3000190") || castedSpellInven.hasNamed("3000198") || castedSpellInven.hasNamed("3000199") ||
	   castedSpellInven.hasNamed("3000201") || castedSpellInven.hasNamed("3000233") || castedSpellInven.hasNamed("3000898") ||
	   castedSpellInven.hasNamed("3000899") || castedSpellInven.hasNamed("3000896") || castedSpellInven.hasNamed("3000900") ||
	   castedSpellInven.hasNamed("3000903"))
	{
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

		// finalize
		if(castedSpellInven.hasNamed("3000190"))
			castedSpellInven.finalizeNamed("3000190");
		if(castedSpellInven.hasNamed("3000198"))
			castedSpellInven.finalizeNamed("3000198");
		if(castedSpellInven.hasNamed("3000199"))
			castedSpellInven.finalizeNamed("3000199");
		if(castedSpellInven.hasNamed("3000201"))
			castedSpellInven.finalizeNamed("3000201");
		if(castedSpellInven.hasNamed("3000233"))
			castedSpellInven.finalizeNamed("3000233");
		if(castedSpellInven.hasNamed("3000898"))
			castedSpellInven.finalizeNamed("3000898");
		if(castedSpellInven.hasNamed("3000899"))
			castedSpellInven.finalizeNamed("3000899");
		if(castedSpellInven.hasNamed("3000896"))
			castedSpellInven.finalizeNamed("3000896");
		if(castedSpellInven.hasNamed("3000900"))
			castedSpellInven.finalizeNamed("3000900");
		if(castedSpellInven.hasNamed("3000903"))
			castedSpellInven.finalizeNamed("3000903");

		// send using effect
		controller.effectBy(trigger);
	}
}

quest
qUseItem1006424()		// 정화의 포션(소)
{
	object castedSpellInven;

	castedSpellInven = trigger.getCastedSpellInventory();

	if(!NormalItemCanBeUsed()) return;

	if(castedSpellInven.hasNamed("3000072") || castedSpellInven.hasNamed("3000899") || castedSpellInven.hasNamed("3001106") ||
	   castedSpellInven.hasNamed("3001604") || castedSpellInven.hasNamed("3000198") )
	{
		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);

			// finalize
			if(castedSpellInven.hasNamed("3000072"))
				castedSpellInven.finalizeNamed("3000072");
			if(castedSpellInven.hasNamed("3000899"))
				castedSpellInven.finalizeNamed("3000899");
			if(castedSpellInven.hasNamed("3001106"))
				castedSpellInven.finalizeNamed("3001106");
			if(castedSpellInven.hasNamed("3001604"))
				castedSpellInven.finalizeNamed("3001604");
			if(castedSpellInven.hasNamed("3000198"))
				castedSpellInven.finalizeNamed("3000198");
		

		// send using effect
		controller.effectBy(trigger);
	}
	else
	{
		trigger.message(TEXT_UNUSABLEITEM_CLEANUP_ERROR, MSG_TYPE__SYSTEM);
		return;
	}
}



quest
qUseItem1004462_wait()
{
	trigger.message(TEXT_USABLEITEM_CANT_TIMEPA + "20" + TEXT_USABLEITEM_CANT_TIMEPB, MSG_TYPE__SYSTEM);
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	Machine.setSavable();

	// 20분간 기다림
   	// Event.timedWaitFor(EVENT_GET, 1200);
	Util.sleep(1200);
	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qUseItem1004462()		// 각성의 비약 (버서크 상태 5분간 지속)
{
	if(!NormalItemCanBeUsed()) return;

	if (trigger.hasQuest("qUseItem1004462_wait")) {
		trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
		return;
	}

	if (UseSkill(trigger,"3000990",300))
		trigger.giveQuestTo("qUseItem1004462_wait", trigger, null);
}


quest
qUseItem1004473()				// 아이템 제거용. 휴지통.
{
    /*
	object item;
	string iName;

	if (!NormalItemCanBeUsed()) return;
	return;					// vahma - disable waste tray for japan setting

	trigger.message(TEXT_USABLEITEM_WILL_BREAK, MSG_TYPE__SYSTEM);
	item = controller.getObjectArgumentAt(0);
	// 유저상점 올라간 아이템인지 체크
	if (item == null) return;

	if (item.isLocked()) {
		trigger.message(TEXT_USABLEITEM_CANT_LOCKED, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getBuilderType() >= 1 && trigger.getBuilderType() <=5) {
		iName = Item.getDescClassNamed(item.getClassName());
		item.sweepNumbered(1);
		trigger.message(TEXT_USABLEITEM_BREAK_CPL + iName, MSG_TYPE__SYSTEM);
		controller.effectBy(trigger);

	} else {
		if (item.isCashItem()) {
			trigger.message(TEXT_CASHITEM_NOT_USE, MSG_TYPE__SYSTEM);
			return;
		}

		iName = Item.getDescClassNamed(item.getClassName());
		item.sweepNumbered(1);	// 번들 여부 체크 필요... 일단 날리자.

		trigger.message(TEXT_USABLEITEM_BREAK_CPL + iName, MSG_TYPE__SYSTEM);
		controller.effectBy(trigger);

		// decrease number
		if (controller.canBeExhausted())
			controller.decreaseNumber(1);
	}
    */		// vahma - japan setting
}

quest
qUseItem1003887()		// vahma - for pet test
{
    object a;

    a = trigger.getPetInventory();
    a.setSanitation(100);
    trigger.message("Set Sanitation : 1%", MSG_TYPE__SYSTEM);
    a.setNutrition(100);
    trigger.message("Set Nutrition : 1%", MSG_TYPE__SYSTEM);
}

quest
qUseItem1004509()			// 희망 상자 (2005 6월 이벤트 by Han)
{
	object rank;
	integer rval, mx, my;
//	integer tickTime;
	integer wNum, rCount, iBirth, rand;

	string userName;

//	tickTime = Util.getTick();
	userName = trigger.getName();

	mx =  trigger.getX();
	my =  trigger.getY();

/*
	// 2005년 6월 3일 ~ 6월 10일까지 진행 가능
	if (Util.getYear(tickTime) != 2005)	{
		trigger.message(TEXT_JUNE_EVENT_END, MSG_TYPE__SYSTEM);
		return;
	} else if (Util.getMonth(tickTime) != 6) {
		trigger.message(TEXT_JUNE_EVENT_END, MSG_TYPE__SYSTEM);
		return;
	} else if (Util.getDay(tickTime) > 10) {
		trigger.message(TEXT_JUNE_EVENT_END, MSG_TYPE__SYSTEM);
		return;
	}
*/

	// 싸움 가능 지역이 아닌 경우 체크즈
	if(!trigger.getWorld().canFight()) {
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
    	return;
	}

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 초보자 던전에서 사용 불가능
	if (wNum == 422 || wNum == 423 || wNum == 424)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 크라이덴 1, 7, 페나인 숲 4
	if(wNum == 4 || wNum == 10 || wNum == 85)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 셀바스 평원 1, 6, 7, 8
	if(wNum == 67 || wNum == 19 || wNum == 20 || wNum == 21)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 길이 좁은 연결통 맵
	if(wNum == 91 || wNum == 92 || wNum == 48 || wNum == 51 || wNum == 114 || wNum == 124)
	{
		trigger.sayTo(TEXT_USABLEITEM_NOT_USE_FIELD, trigger);
		trigger.message(trigger.getWorld().getName(), MSG_TYPE__SYSTEM);
		return;
	}

	// 슬롯 체크
    if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
    }

	// 무게 체크
	// 제공 아이템의 최대 무게로 설정
    if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
    }

	rval = Util.random(1, 1000);

	iBirth = trigger.getBirthTime();

	// 5%	크노헨(혼란동굴9층)
	if(rval >= 950)
	{
		trigger.getWorld().genMonster("2100026", 1, "twKnohen.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 5%	애쉴트
	else if(rval >= 900)
	{
		trigger.getWorld().genMonster("2100588", 1, "twCH10_EChimera.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 12%	블러디돌
	else if(rval >= 780)
	{
		trigger.getWorld().genMonster("2100221", 1, "twMechanic.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 12%	흑랑
	else if(rval >= 660)
	{
		trigger.getWorld().genMonster("2100578", 1, "twApr14_HadesEnvoy.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 12%	독각귀
	else if(rval >= 540)
	{
		trigger.getWorld().genMonster("2100593", 1, "twMay18_DoggaebiBoss.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// 12%	금령시
	else if(rval >= 420)
	{
		trigger.getWorld().genMonster("2100596", 1, "twMay23_KangSheeBoss.ptn", 1, mx-10, my-10, mx+10, my+10);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_MONSTER, trigger);
	}
	// ***********************************************************************************************
	// 여기서부터 아이템~
	// ***********************************************************************************************
	// 5%	빙한세트
	else if(rval >= 370)
	{
		rank = Rank.select("KOR_JUNE_ITEM1");
		rCount = rank.getCount();

		rand = Util.random(0,4);

		if(rCount < 5)
	   	{
	   		if(rand == 0)			// 1%	빙한의 투구
	   		{
				rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000992", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			}
			else if (rand == 1)		// 1%	빙한의 날개
			{
				rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000993", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			}
			else if (rand == 2)		// 1%	빙한의 갑옷
			{
				rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000994", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			}
			else if (rand == 3)		// 1%	빙한의 팔찌
			{
				rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000995", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			}
			else					// 1%	빙한의 슈즈
			{
				rank.add(userName, 0, 0, 0, iBirth, "null");
				trigger.addItemClassNamed("1000996", 1);
				trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
			}
		}
		else
		{
			trigger.addItemClassNamed("1000033", 1);
			trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
		}
	}
	// 1%	메카귀
	else if(rval >= 360)
	{
		trigger.addItemClassNamed("1002903", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
	}
	// 1%	빨강선글라스
	else if(rval >= 350)
	{
		trigger.addItemClassNamed("1002904", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
	}
	// 1%	코걸이안경
	else if(rval >= 340)
	{
		trigger.addItemClassNamed("1002905", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM_COOL, trigger);
	}
	// 1%	안대
	else if(rval >= 330)
	{
		trigger.addItemClassNamed("1002906", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	괴도Z가면
	else if(rval >= 320)
	{
		trigger.addItemClassNamed("1002907", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	마도사의 리본
	else if(rval >= 310)
	{
		trigger.addItemClassNamed("1002908", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	장식용 나뭇가지
	else if(rval >= 300)
	{
		trigger.addItemClassNamed("1002909", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	빨간머플러
	else if(rval >= 290)
	{
		trigger.addItemClassNamed("1002910", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	날개귀
	else if(rval >= 280)
	{
		trigger.addItemClassNamed("1002921", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	죠안두건
	else if(rval >= 270)
	{
		trigger.addItemClassNamed("1002922", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	샤크바리두건
	else if(rval >= 260)
	{
		trigger.addItemClassNamed("1002923", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 1%	밍밍
	else if(rval >= 250)
	{
		trigger.addItemClassNamed("1002924", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	
	// 5%	생명의 조각 5개
	else if(rval >= 200)
	{
		trigger.addItemClassNamed("1000022", 5);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 5%	마나의 결정 5개
	else if(rval >= 150)
	{
		trigger.addItemClassNamed("1000033", 5);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 5%	괴력의 햄
	else if(rval >= 100)
	{
		trigger.addItemClassNamed("1001892", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 5%	축복의 성수
	else if(rval >= 50)
	{
		trigger.addItemClassNamed("1001893", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}
	// 5%	리스토어세트
	else
	{
		trigger.addItemClassNamed("1000085", 1);
		trigger.sayTo(TEXT_USABLEITEM_BOX_IN_ITEM, trigger);
	}

	if (controller.canBeExhausted())
		controller.decreaseNumber(1);
}

quest
qUseItem1004622()				// 대만 발렌타인 이벤트 상자 (2005.07.20 by Han)
{
	string itemID = "";
	integer selection;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 5) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	selection = Util.random(1, 99);

	if (selection <= 33) {			// Caribou hat
		itemID	= "1004623";
	} else if (selection <= 66) {		// Whale hat
		itemID	= "1004624";
	} else if (selection <= 99) {		// Shark hat
		itemID	= "1004625";
	}

	// 아이템을 준다.
	if (itemID != "") trigger.addItemClassNamed(itemID, 1);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}


// 2005.12.07 크리스마스 이벤트 지급 성냥
quest qUseItem1004771()
{
	if (!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 50) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getRandomItem(13))		// vahma - japan setting
	{
		// decrease number
		if (controller.canBeExhausted()) {
			controller.decreaseNumber(1);
		}

		// send using effect
		controller.effectBy(trigger);
	}
	else
	{
		trigger.message(TEXT_USABLEITEM_NOT_GET, MSG_TYPE__SYSTEM);
		return;
	}
}

quest qUseItem1004781()		// 알 수 없는 씨앗 (트리 이벤트용)
{
	integer randValue;

	randValue = Util.random(0,9);

	if (!NormalItemCanBeUsed()) return;

	if (randValue >= 7)
	{
		// HP 300 회복
		if (trigger.isState(CREATURE_STATE__UNDEAD) || trigger.isState(CREATURE_STATE__FOOD_POISONING)) {
			if (!HardCode.itemDownHP(trigger, 300)) return;
		} else {
			if (!HardCode.itemUpHP(trigger, 300)) return;

			// 태극기 회복 처리. 임시
			if (trigger.getClassNameAtPart(EQUIP_PART__HELMET) == "1004870")
				ItemBalloonUpHP(trigger, 300);
		}
	}
	else if (randValue >= 4)
	{
		// MP 200 회복
		if (!HardCode.itemUpMP(trigger, 200)) return;
		// 태극기 회복 처리. 임시
		if (trigger.getClassNameAtPart(EQUIP_PART__AACCESSORY) == "1004466")		// vahma - japan setting
			ItemBalloonUpMP(trigger, 200);
	}
	else
	{
		// SP 100 회복
		ItemUpSP(trigger, 100);
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
	// send using effect
	controller.effectBy(trigger);
}


//***************************************************************************************************

quest
qUseItem1004798()		// 러브러브 선물세트 (발렌타인 이벤트용)
{
	integer iRandom;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.

	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	iRandom = Util.random(1, 10000);

	if(iRandom <= 10)		// 1004384	러브 홍염의 투구 0.1%
	{
		trigger.addItemClassNamed("1004384", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004384 ] ";
	}
	else if(iRandom <= 20)		// 1004385	러브 홍염의 날개 0.1%
	{
		trigger.addItemClassNamed("1004385", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004385 ] ";
	}
	else if(iRandom <= 30)		// 1004387	러브 홍염의 갑옷 0.1%
	{
		trigger.addItemClassNamed("1004387", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004387 ] ";
	}
	else if(iRandom <= 40)		// 1004389	러브 홍염의 팔찌 0.1%
	{
		trigger.addItemClassNamed("1004389", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004389 ] ";
	}
	else if(iRandom <= 90)		// 1004646	러브 홍염의 슈즈 0.5%
	{
		trigger.addItemClassNamed("1004646", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004646 ] ";
	}
	else if(iRandom <= 2115)	// 1001808	신속의 열매 20.25%
	{
		trigger.addItemClassNamed("1001808", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1001808 ] ";
	}
	else if(iRandom <= 2715)	// 1003017	러브 호랑이 모자 6%
	{
		trigger.addItemClassNamed("1003017", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1003017 ] ";
	}
	else if(iRandom <= 4715)	// 1000223	질풍의 약초 20%
	{
		trigger.addItemClassNamed("1000223", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1000223 ] ";
	}
	else if(iRandom <= 5220)	// 1000144	러브 너구리 모자 5.05%
	{
		trigger.addItemClassNamed("1000144", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1000144 ] ";
	}
	else if(iRandom <= 7220)	// 1000222	축복의 성수 20%
	{
		trigger.addItemClassNamed("1000222", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1000222 ] ";
	}
	else if(iRandom <= 7820)	// 1005062	러브 너구리 목도리 6%
	{
		trigger.addItemClassNamed("1005062", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1005062 ] ";
	}
	else if(iRandom <= 9820)	// 1000022	적중의 푸딩 20%
	{
		trigger.addItemClassNamed("1000022", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1000022 ] ";
	}
	else if(iRandom <= 9840)	// 1004390	러브 큐피트 투구 0.2%
	{
		trigger.addItemClassNamed("1004390", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004390 ] ";
	}
	else if(iRandom <= 9850)	// 1004393	러브 큐피트 방패 0.1%
	{
		trigger.addItemClassNamed("1004393", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004393 ] ";
	}
	else if(iRandom <= 9870)	// 1004388	러브 큐피트 비녀 0.2%
	{
		trigger.addItemClassNamed("1004388", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004388 ] ";
	}
	else if(iRandom <= 9880)	// 1004391	러브 큐피트 날개 0.1%
	{
		trigger.addItemClassNamed("1004391", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004391 ] ";
	}
	else if(iRandom <= 9900)	// 1004386	러브 큐피트 갑옷 0.2%
	{
		trigger.addItemClassNamed("1004386", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004386 ] ";
	}
	else if(iRandom <= 9950)	// 1004444	러브 큐피트 슈즈 0.5%
	{
		trigger.addItemClassNamed("1004444", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1004444 ] ";
	}
	else				// 1002008	러브 큐피트 장갑 0.5%
	{
		trigger.addItemClassNamed("1002008", 1);
		Item_Info = "From Gift Certificate : +ITEM [ 1002008 ] ";
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);

	controller.effectBy(trigger);
}

quest
qUseItem1004871()		// 매크로 감지 아이템
{
	integer wNum;

	object target;
	integer bType;

	target = controller.getObjectArgumentAt(0);

	bType = target.getBuilderType();

	if(!NormalItemCanBeUsed()) return;

	// 사용 불가능 특정 지역 체크
	wNum = trigger.getWorld().getNumber();

	// 싸움가능 지역, 이벤트월드 사용금지
	if(!trigger.getWorld().canFight() || trigger.getWorld().isEventWorld()) {
		trigger.sayTo(TEXT_CASHITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 초보자 던전 및 튜토리얼 대기실, 도플갱어 숲 대기실에서 사용 불가능
	if (wNum == 421 || wNum == 203 || wNum == 178 || wNum == 179 || wNum == 180)
	{
		trigger.sayTo(TEXT_CASHITEM_NOT_USE_FIELD, trigger);
		return;
	}

	if (target.macroTest()) {
		// 운영자에게 사용금지
		if (bType == 1 || bType == 2 || bType == 3 || bType == 5)
			return;
		else
		{
			// decrease item
			if (controller.canBeExhausted())
				controller.decreaseNumber(1);
		}
	}
	else
	{
		trigger.message(MACRO_TEST_DISABLE, MSG_TYPE__SYSTEM);
		return;
	}
	return;
}

quest qUseItem1004970()		// 벤야방 이동 아이템
{
	object loc;

	if(!NormalItemCanBeUsed()) return;

	// 싸움가능 지역, 이벤트월드 사용금지
	if(trigger.getWorld().canFight() || trigger.getWorld().isEventWorld()) {
		trigger.sayTo(TEXT_CASHITEM_NOT_USE_FIELD, trigger);
		return;
	}

	if (!trigger.getWorld().canUseCustomWarp()) {
		trigger.message(CANT_USE_TELEPORT_ITEM_SINCE_EVENTWORLD, MSG_TYPE__SYSTEM);
		return;
	}

	// controller.decreaseNumber(1);
	controller.sweepNumbered(1);

	loc = Location.create();
	loc.set(666,100,100);

	trigger.teleportTo(loc);
}

quest qUseItem1004954()		// 초보자의 가방
{
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 싸움가능 지역, 이벤트월드 사용금지
	if(trigger.getWorld().canFight() || trigger.getWorld().isEventWorld())
	{
		trigger.sayTo(TEXT_CASHITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 인벤토리 및 무게가 꽉찰경우
	if (trigger.getCarryingItemInventory().availCount() < 3 || trigger.getCarryingItemInventory().availWeight() < 300)
	{
		trigger.message(TEXT_CLAD_AVAILCOUNUT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	// 워프 등록기
	trigger.addItemClassNamed("1002814", 1);

	// 샤크바리 슈즈
	trigger.addItemClassNamed("1003374", 1);
	ExpireItem("1003374", 60*60*24*30);

	// 철가면
	trigger.addItemClassNamed("1003375", 1);
	ExpireItem("1003375", 60*60*24*30);

	Item_Info = "From Gift Certificate : +ITEM [ 1002814, 1003374, 1003375 ] ";

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}

quest qUseItem1006056()			// 화이팅 상자 (2006 월드컵 이벤트용)
{
	integer iRandom;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	iRandom = Util.random(1, 10000);

	if(iRandom <= 10)		// 1004981	에피소드1 기념 윙 0.1%
	{
		trigger.addItemClassNamed("1004981", 1);
		trigger.message(TEXT_EXT_BOX_MSG1, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004981 ] ";
	}
	else if(iRandom <= 110)		// 1001808	인크립트 스크롤 1%
	{
		trigger.addItemClassNamed("1001808", 1);
		trigger.message(TEXT_EXT_BOX_MSG2, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001808 ] ";
	}
	else if(iRandom <= 310)		// 1004056	천사 2%
	{
		trigger.addItemClassNamed("1004056", 1);

		// 7일만 사용가능
		ExpireItem("1004056", 60*60*24*7);
		trigger.message(TEXT_EXT_BOX_MSG3, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004056 ] ";
	}
	else if(iRandom <= 510)		// 1004057	악마 2%
	{
		trigger.addItemClassNamed("1004057", 1);

		// 7일만 사용가능
		ExpireItem("1004057", 60*60*24*7);
		trigger.message(TEXT_EXT_BOX_MSG4, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004057 ] ";
	}
	else if(iRandom <= 710)		// 1004059	요정 2%
	{
		trigger.addItemClassNamed("1004059", 1);

		// 7일만 사용가능
		ExpireItem("1004059", 60*60*24*7);
		trigger.message(TEXT_EXT_BOX_MSG5, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004059 ] ";
	}
	else if(iRandom <= 910)		// 1004060	토끼귀 밀짚 모자 2%
	{
		trigger.addItemClassNamed("1004060", 1);

		// 7일만 사용가능
		ExpireItem("1004060", 60*60*24*7);
		trigger.message(TEXT_EXT_BOX_MSG6, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004060 ] ";
	}
	else if(iRandom <= 1110)	// 1004068	메이드 2%
	{
		trigger.addItemClassNamed("1004068", 1);

		// 7일만 사용가능
		ExpireItem("1004068", 60*60*24*7);
		trigger.message(TEXT_EXT_BOX_MSG7, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004068 ] ";
	}
	else if(iRandom <= 1410)	// 1004079	파티 폭죽 3%
	{
		trigger.addItemClassNamed("1004079", 5);
		trigger.message(TEXT_EXT_BOX_MSG8, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004079 ] ";
	}
	else if(iRandom <= 2910)	// 1001895	회피의 쿠키 15%
	{
		trigger.addItemClassNamed("1001895", 1);
		trigger.message(TEXT_EXT_BOX_MSG9, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001895 ] ";
	}
	else if(iRandom <= 4410)	// 1001894	적중의 푸딩 15%
	{
		trigger.addItemClassNamed("1001894", 1);
		trigger.message(TEXT_EXT_BOX_MSG10, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001894 ] ";
	}
	else if(iRandom <= 5910)	// 1001890	질풍의 약초 15%
	{
		trigger.addItemClassNamed("1001890", 1);
		trigger.message(TEXT_EXT_BOX_MSG11, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001890 ] ";
	}
	else if(iRandom <= 7410)	// 1000022	생명의 보석 15%
	{
		trigger.addItemClassNamed("1000022", 1);
		trigger.message(TEXT_EXT_BOX_MSG12, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000022 ] ";
	}
	else if(iRandom <= 8910)	// 1000033	마나의 결정 15%
	{
		trigger.addItemClassNamed("1000033", 1);
		trigger.message(TEXT_EXT_BOX_MSG13, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000033 ] ";
	}
	else if(iRandom <= 8960)	// 1004955	May 나비 리본 0.5%
	{
		trigger.addItemClassNamed("1004955", 1);

		// 30일만 사용가능
		ExpireItem("1004955", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG14, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004955 ] ";
	}
	else if(iRandom <= 9010)	// 1004956	May 엘프 귀 0.5%
	{
		trigger.addItemClassNamed("1004956", 1);

		// 30일만 사용가능
		ExpireItem("1004956", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG15, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004956 ] ";
	}
	else if(iRandom <= 9150)	// 1004957	May 귀마개 1.4%
	{
		trigger.addItemClassNamed("1004957", 1);

		// 30일만 사용가능
		ExpireItem("1004957", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG16, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004957 ] ";
	}
	else if(iRandom <= 9250)	// 1004958	May 스카우터 1%
	{
		trigger.addItemClassNamed("1004958", 1);

		// 30일만 사용가능
		ExpireItem("1004958", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG17, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004958 ] ";
	}
	else if(iRandom <= 9300)	// 1004959	May 비녀 0.5%
	{
		trigger.addItemClassNamed("1004959", 1);

		// 30일만 사용가능
		ExpireItem("1004959", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG18, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004959 ] ";
	}
	else if(iRandom <= 9400)	// 1004960	May 메카귀 1%
	{
		trigger.addItemClassNamed("1004960", 1);

		// 30일만 사용가능
		ExpireItem("1004960", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG19, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004960 ] ";
	}
	else if(iRandom <= 9450)	// 1004961	May 마도사 리본 0.5%
	{
		trigger.addItemClassNamed("1004961", 1);

		// 30일만 사용가능
		ExpireItem("1004961", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG20, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004961 ] ";
	}
	else if(iRandom <= 9500)	// 1004962	May 날개 귀 0.5%
	{
		trigger.addItemClassNamed("1004962", 1);

		// 30일만 사용가능
		ExpireItem("1004962", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG21, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004962 ] ";
	}
	else if(iRandom <= 9600)	// 1004963	May 터번 1%
	{
		trigger.addItemClassNamed("1004963", 1);

		// 30일만 사용가능
		ExpireItem("1004963", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG22, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004963 ] ";
	}
	else if(iRandom <= 9800)	// 1004964	May 솜브레로 2%
	{
		trigger.addItemClassNamed("1004964", 1);

		// 30일만 사용가능
		ExpireItem("1004964", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG23, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004964 ] ";
	}
	else if(iRandom <= 9850)	// 1004966	May 죠안두건 0.5%
	{
		trigger.addItemClassNamed("1004966", 1);

		// 30일만 사용가능
		ExpireItem("1004966", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG24, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004966 ] ";
	}
	else if(iRandom <= 9900)	// 1004967	May 샤크바리두건 0.5%
	{
		trigger.addItemClassNamed("1004967", 1);

		// 30일만 사용가능
		ExpireItem("1004967", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG25, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004967 ] ";
	}
	else				// 1004968	May 밍밍 1%
	{
		trigger.addItemClassNamed("1004968", 1);

		// 30일만 사용가능
		ExpireItem("1004968", 60*60*24*30);
		trigger.message(TEXT_EXT_BOX_MSG26, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004968 ] ";
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}


quest qUseItem1006081()		// 하늘색 상자 (휴면유저 복귀 유도 아이템 2006.6.15)
{
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 싸움가능 지역, 이벤트월드 사용금지
	if(trigger.getWorld().canFight() || trigger.getWorld().isEventWorld())
	{
		trigger.sayTo(TEXT_CASHITEM_NOT_USE_FIELD, trigger);
		return;
	}

	// 인벤토리 및 무게가 꽉찰경우
	if (trigger.getCarryingItemInventory().availCount() < 2 || trigger.getCarryingItemInventory().availWeight() < 100)
	{
		trigger.message(TEXT_CLAD_AVAILCOUNUT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	// 빵 헬름
	trigger.addItemClassNamed("1006079", 1);

	// 스탯 재분배 스크롤
	trigger.addItemClassNamed("1004510", 1);

	// 숙련의 증표 (패시브 아이템 경험치 1.2배 / 레어드롭률 1.1배)
	trigger.addItemClassNamed("1006080", 1);
	ExpireItem("1006080", 60*60*24*30);

	Item_Info = "From Gift Certificate : +ITEM [ 1006079, 1006080 ] ";

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}

quest qUseItem1006082()			// 핑크 상자 (휴면유저 복귀 이벤트용)
{
	integer iRandom;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 2) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	iRandom = Util.random(1, 1300);

	trigger.addItemClassNamed("1004041", 1);
	trigger.message("외치기 뿔피리 하늘색 1개를 지급합니다.", MSG_TYPE__SYSTEM);

	if(iRandom <= 100)		// 1006091	클래식 나비 리본
	{
		trigger.addItemClassNamed("1006091", 1);

		// 30일만 사용가능
		ExpireItem("1006091", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 나비 리본이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006091 : 클래식 나비 리본 ] ";
	}
	else if(iRandom <= 200)		// 1006092	클래식 엘프 귀
	{
		trigger.addItemClassNamed("1006092", 1);

		// 30일만 사용가능
		ExpireItem("1006092", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 엘프 귀가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006092 : 클래식 엘프 귀 ] ";
	}
	else if(iRandom <= 300)		// 1006093	클래식 귀마개
	{
		trigger.addItemClassNamed("1006093", 1);

		// 30일만 사용가능
		ExpireItem("1006093", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 귀마개가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006093 : 클래식 귀마개 ] ";
	}
	else if(iRandom <= 400)		// 1006094	클래식 스카우터
	{
		trigger.addItemClassNamed("1006094", 1);

		// 30일만 사용가능
		ExpireItem("1006094", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 스카우터가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006094 : 클래식 스카우터 ] ";
	}
	else if(iRandom <= 500)		// 1006095	클래식 비녀
	{
		trigger.addItemClassNamed("1006095", 1);

		// 30일만 사용가능
		ExpireItem("1006095", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 비녀가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006095 : 클래식 비녀 ] ";
	}
	else if(iRandom <= 600)		// 1006096	클래식 메카귀
	{
		trigger.addItemClassNamed("1006096", 1);

		// 30일만 사용가능
		ExpireItem("1006096", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 메카귀가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006096 : 클래식 메카귀 ] ";
	}
	else if(iRandom <= 700)		// 1006097	클래식 마도사 리본
	{
		trigger.addItemClassNamed("1006097", 1);

		// 30일만 사용가능
		ExpireItem("1006097", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 마도사 리본이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006097 : 클래식 마도사 리본 ] ";
	}
	else if(iRandom <= 800)		// 1006098	클래식 날개귀
	{
		trigger.addItemClassNamed("1006098", 5);

		// 30일만 사용가능
		ExpireItem("1006098", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 날개귀가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006098 : 클래식 날개귀 ] ";
	}
	else if(iRandom <= 900)		// 1006099	클래식 터번
	{
		trigger.addItemClassNamed("1006099", 1);

		// 30일만 사용가능
		ExpireItem("1006099", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 터번이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006099 : 클래식 터번 ] ";
	}
	else if(iRandom <= 1000)	// 1006100	클래식 솜브레로
	{
		trigger.addItemClassNamed("1006100", 1);

		// 30일만 사용가능
		ExpireItem("1006100", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 솜브레로가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006100 : 클래식 솜브레로 ] ";
	}
	else if(iRandom <= 1100)	// 1006101	클래식 죠안두건
	{
		trigger.addItemClassNamed("1006101", 1);

		// 30일만 사용가능
		ExpireItem("1006101", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 죠안두건이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006101 : 클래식 죠안두건 ] ";
	}
	else if(iRandom <= 1200)	// 1006102	클래식 샤크바리두건
	{
		trigger.addItemClassNamed("1006102", 1);

		// 30일만 사용가능
		ExpireItem("1006102", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 샤크바리두건이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006102 : 클래식 샤크바리두건 ] ";
	}
	else				// 1006103	클래식 밍밍
	{
		trigger.addItemClassNamed("1006103", 1);

		// 30일만 사용가능
		ExpireItem("1006103", 60*60*24*30);
		trigger.message("하늘색 상자에서 클래식 밍밍이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006103 : 클래식 밍밍 ] ";
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}


//***********************************************
//*** 작업자   : stunlee                  *******
//*** 내용     : 물놀이용품상자           *******
//*** 작성일시 : 2006/07/12               *******
//***********************************************
quest qUseItem1006162()			// 물놀이용품상자(여름 이벤트용)
{
	integer iRandom;
	integer iRandom2;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 2) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 200) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	iRandom = Util.random(1, 10000);
	iRandom2 = Util.random(1, 4400);

	if(iRandom <= 990)			// 1004978 꽃수영모자 9.9%
	{
		trigger.addItemClassNamed("1004978", 1);

		// 30일만 사용가능
		ExpireItem("1004978", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 꽃수영모자가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004978 : 꽃수영모자 ] ";
	}
	else if(iRandom <= 1980)		// 1006163 빅선글라스 9.9%
	{
		trigger.addItemClassNamed("1006163", 1);

		// 30일만 사용가능
		ExpireItem("1006163", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 빅선글라스가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006163 : 빅선글라스 ] ";
	}
	else if(iRandom <= 2870)		// 1004980 루시안 튜브 8.9%
	{
		trigger.addItemClassNamed("1004980", 1);

		// 30일만 사용가능
		ExpireItem("1004980", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 루시안 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1004980 : 루시안 튜브 ] ";
	}
	else if(iRandom <= 3760)		// 1006058 보리스 튜브 8.9%
	{
		trigger.addItemClassNamed("1006058", 1);

		// 30일만 사용가능
		ExpireItem("1006058", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 보리스 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006058 : 보리스 튜브 ] ";
	}
	else if(iRandom <= 4650)		// 1006059 막시민 튜브 8.9%
	{
		trigger.addItemClassNamed("1006059", 1);

		// 30일만 사용가능
		ExpireItem("1006059", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006059 : 막시민 튜브 ] ";
	}
	else if(iRandom <= 5540)		// 1006060 시벨린 튜브 8.9%
	{
		trigger.addItemClassNamed("1006060", 1);

		// 30일만 사용가능
		ExpireItem("1006060", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006060 : 시벨린 튜브 ] ";
	}
	else if(iRandom <= 6430)		// 1006061 이스핀 튜브 8.9%
	{
		trigger.addItemClassNamed("1006061", 1);

		// 30일만 사용가능
		ExpireItem("1006061", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006061 : 이스핀 튜브 ] ";
	}
	else if(iRandom <= 7320)		// 1006062 밀라 튜브 8.9%
	{
		trigger.addItemClassNamed("1006062", 5);

		// 30일만 사용가능
		ExpireItem("1006062", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006062 : 밀라 튜브 ] ";
	}
	else if(iRandom <= 8210)		// 1006063 티치엘 튜브 8.9%
	{
		trigger.addItemClassNamed("1006063", 1);

		// 30일만 사용가능
		ExpireItem("1006063", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006063 : 티치엘 튜브 ] ";
	}
	else if(iRandom <= 9100)		// 1006064 나야 튜브 8.9%
	{
		trigger.addItemClassNamed("1006064", 1);

		// 30일만 사용가능
		ExpireItem("1006064", 60*60*24*30);
		trigger.message("물놀이 용품 상자에서 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006064 : 나야 튜브 ] ";
	}
	else if(iRandom <= 9110)		// 1006180 꽃수영모자 0.1%
	{
		trigger.addItemClassNamed("1006180", 1);

		trigger.message("물놀이 용품 상자에서 꽃수영모자가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006180 : 꽃수영모자 ] ";
	}
	else if(iRandom <= 9120)		// 1006181 빅선글라스 0.1%
	{
		trigger.addItemClassNamed("1006181", 1);

		trigger.message("물놀이 용품 상자에서 빅선글라스가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006181 : 빅선글라스 ] ";
	}
	else if(iRandom <= 9130)		// 1006182 류시안 튜브 0.1%
	{
		trigger.addItemClassNamed("1006182", 1);

		trigger.message("물놀이 용품 상자에서 류시안 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006182 : 류시안 튜브 ] ";
	}
	else if(iRandom <= 9140)		// 1006183 보리스 튜브 0.1%
	{
		trigger.addItemClassNamed("1006183", 1);

		trigger.message("물놀이 용품 상자에서 보리스 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006183 : 보리스 튜브 ] ";
	}
	else if(iRandom <= 9150)		// 1006184 막시민 튜브 0.1%
	{
		trigger.addItemClassNamed("1006184", 1);

		trigger.message("물놀이 용품 상자에서 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006184 : 막시민 튜브 ] ";
	}
	else if(iRandom <= 9160)		// 1006185 시벨린 튜브 0.1%
	{
		trigger.addItemClassNamed("1006185", 1);

		trigger.message("물놀이 용품 상자에서 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006185 : 시벨린 튜브 ] ";
	}
	else if(iRandom <= 9170)		// 1006186 이스핀 튜브 0.1%
	{
		trigger.addItemClassNamed("1006186", 1);

		trigger.message("물놀이 용품 상자에서 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006186 : 이스핀 튜브 ] ";
	}
	else if(iRandom <= 9180)		// 1006187 밀라 튜브 0.1%
	{
		trigger.addItemClassNamed("1006187", 1);

		trigger.message("물놀이 용품 상자에서 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006187 : 밀라 튜브 ] ";
	}
	else if(iRandom <= 9190)		// 1006188 티치엘 튜브 0.1%
	{
		trigger.addItemClassNamed("1006188", 1);

		trigger.message("물놀이 용품 상자에서 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006188 : 티치엘 튜브 ] ";
	}
	else if(iRandom <= 9200)		// 1006189 나야 튜브 0.1%
	{
		trigger.addItemClassNamed("1006189", 1);

		trigger.message("물놀이 용품 상자에서 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006189 : 나야 튜브 ] ";
	}
	else if(iRandom <= 9300)		// 1002697 순록옷 1%
	{
		trigger.addItemClassNamed("1002697", 1);

		trigger.message("물놀이 용품 상자에서 순록옷이 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1002697 : 순록옷 ] ";
	}
	else if(iRandom <= 9800)		// 1001602 간판 염색약(크리스마스 트리)
	{
		trigger.addItemClassNamed("1001602", 1);

		trigger.message("물놀이 용품 상자에서 간판 염색약(크리스마스 트리)가 나왔습니다.", MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001602 : 간판 염색약(크리스마스 트리) ] ";
	}
	else                    		// 랜덤 : 물놀이 용품중 2개
	{
		if(iRandom2 <= 100)		// 꽃수영모자(1004978), 빅선글라스(1006163)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006163", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006163", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 빅선글라스가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978,  1006163] ";
		}
		else if(iRandom2 <= 200)	// 꽃수영모자(1004978),루시안 튜브(1004980)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1004980", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1004980", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 루시안 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1004980] ";
		}
		else if(iRandom2 <= 300)	// 꽃수영모자(1004978), 보리스 튜브(1006058)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006058", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006058", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 보리스 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006058] ";
		}
		else if(iRandom2 <= 400)	// 꽃수영모자(1004978), 막시민 튜브(1006059)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006059", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006059", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006059] ";
		}
		else if(iRandom2 <= 500)	// 꽃수영모자(1004978),시벨린 튜브(1006060)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006060", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006060", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006060] ";
		}
		else if(iRandom2 <= 600)	// 꽃수영모자(1004978), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006061] ";
		}
		else if(iRandom2 <= 700)	// 꽃수영모자(1004978), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006062] ";
		}
		else if(iRandom2 <= 800)	// 꽃수영모자(1004978), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006063] ";
		}
		else if(iRandom2 <= 900)	// 꽃수영모자(1004978), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1004978", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1004978", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 꽃수영모자와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004978, 1006064] ";
		}
		else if(iRandom2 <= 1000)	// 빅선글라스(1006163), 루시안 튜브(1004980)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1004980", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1004980", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 루시안 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1004980] ";
		}
		else if(iRandom2 <= 1100)	// 빅선글라스(1006163), 보리스 튜브(1006058)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006058", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006058", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 보리스 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006058] ";
		}
		else if(iRandom2 <= 1200)	// 빅선글라스(1006163), 막시민 튜브(1006059)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006059", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006059", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006059] ";
		}
		else if(iRandom2 <= 1300)	// 빅선글라스(1006163), 시벨린 튜브(1006060)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006060", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006060", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006060] ";
		}
		else if(iRandom2 <= 1400)	// 빅선글라스(1006163), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006061] ";
		}
		else if(iRandom2 <= 1500)	// 빅선글라스(1006163), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006062] ";
		}
		else if(iRandom2 <= 1600)	// 빅선글라스(1006163), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006063] ";
		}
		else if(iRandom2 <= 1700)	// 빅선글라스(1006163), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006163", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006163", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 빅선글라스와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006163, 1006064] ";
		}
		else if(iRandom2 <= 1800)	// 루시안 튜브(1004980), 보리스 튜브(1006058)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006058", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006058", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 보리스 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006058] ";
		}
		else if(iRandom2 <= 1900)	// 루시안 튜브(1004980), 막시민 튜브(1006059)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006059", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006059", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006059] ";
		}
		else if(iRandom2 <= 2000)	// 루시안 튜브(1004980), 시벨린 튜브(1006060)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006060", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006060", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006060] ";
		}
		else if(iRandom2 <= 2100)	// 루시안 튜브(1004980), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006061] ";
		}
		else if(iRandom2 <= 2200)	// 루시안 튜브(1004980), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006062] ";
		}
		else if(iRandom2 <= 2300)	// 루시안 튜브(1004980), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006063] ";
		}
		else if(iRandom2 <= 2400)	// 루시안 튜브(1004980), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1004980", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1004980", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 루시안 튜브와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1004980, 1006064] ";
		}
		else if(iRandom2 <= 2500)	// 보리스 튜브(1006058), 막시민 튜브(1006059)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006059", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006059", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 막시민 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006059] ";
		}
		else if(iRandom2 <= 2600)	// 보리스 튜브(1006058), 시벨린 튜브(1006060)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006060", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006060", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006060] ";
		}
		else if(iRandom2 <= 2700)	// 보리스 튜브(1006058), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006061] ";
		}
		else if(iRandom2 <= 2800)	// 보리스 튜브(1006058), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006062] ";
		}
		else if(iRandom2 <= 2900)	// 보리스 튜브(1006058), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006063] ";
		}
		else if(iRandom2 <= 3000)	// 보리스 튜브(1006058), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006058", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006058", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006058, 1006064] ";
		}
		else if(iRandom2 <= 3100)	// 막시민 튜브(1006059), 시벨린 튜브(1006060)
		{
			trigger.addItemClassNamed("1006059", 1);
			trigger.addItemClassNamed("1006060", 1);
			// 30일만 사용가능
			ExpireItem("1006059", 60*60*24*30);
			ExpireItem("1006060", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006059, 1006060] ";
		}
		else if(iRandom2 <= 3100)	// 막시민 튜브(1006059), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1006059", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1006059", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006059, 1006061] ";
		}
		else if(iRandom2 <= 3100)	// 막시민 튜브(1006059), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1006059", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1006059", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006059, 1006062] ";
		}
		else if(iRandom2 <= 3100)	// 막시민 튜브(1006059), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006059", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006059", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006059, 1006063] ";
		}
		else if(iRandom2 <= 3100)	// 막시민 튜브(1006059), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006059", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006059", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 보리스 튜브와 시벨린 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006059, 1006064] ";
		}
		else if(iRandom2 <= 3600)	// 시벨린 튜브(1006060), 이스핀 튜브(1006061)
		{
			trigger.addItemClassNamed("1006060", 1);
			trigger.addItemClassNamed("1006061", 1);
			// 30일만 사용가능
			ExpireItem("1006060", 60*60*24*30);
			ExpireItem("1006061", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 시벨린 튜브와 이스핀 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006060, 1006061] ";
		}
		else if(iRandom2 <= 3700)	// 시벨린 튜브(1006060), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1006060", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1006060", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 시벨린 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006060, 1006062] ";
		}
		else if(iRandom2 <= 3800)	// 시벨린 튜브(1006060), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006060", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006060", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 시벨린 튜브와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006060, 1006063] ";
		}
		else if(iRandom2 <= 3900)	// 시벨린 튜브(1006060), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006060", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006060", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 시벨린 튜브와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006060, 1006064] ";
		}
		else if(iRandom2 <= 4000)	// 이스핀 튜브(1006061), 밀라 튜브(1006062)
		{
			trigger.addItemClassNamed("1006061", 1);
			trigger.addItemClassNamed("1006062", 1);
			// 30일만 사용가능
			ExpireItem("1006061", 60*60*24*30);
			ExpireItem("1006062", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 이스핀 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006061, 1006062] ";
		}
		else if(iRandom2 <= 4100)	// 이스핀 튜브(1006061), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006061", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006061", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 이스핀 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006061, 1006063] ";
		}
		else if(iRandom2 <= 4200)	// 이스핀 튜브(1006061), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006061", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006061", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 이스핀 튜브와 밀라 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006061, 1006064] ";
		}
		else if(iRandom2 <= 4300)	// 밀라 튜브(1006062), 티치엘 튜브(1006063)
		{
			trigger.addItemClassNamed("1006062", 1);
			trigger.addItemClassNamed("1006063", 1);
			// 30일만 사용가능
			ExpireItem("1006062", 60*60*24*30);
			ExpireItem("1006063", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 밀라 튜브와 티치엘 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006062, 1006063] ";
		}
		else				// 밀라 튜브(1006062), 나야 튜브(1006064)
		{
			trigger.addItemClassNamed("1006062", 1);
			trigger.addItemClassNamed("1006064", 1);
			// 30일만 사용가능
			ExpireItem("1006062", 60*60*24*30);
			ExpireItem("1006064", 60*60*24*30);
			trigger.message("물놀이 용품 상자에서 밀라 튜브와 나야 튜브가 나왔습니다.", MSG_TYPE__SYSTEM);
			Item_Info = "From Gift Certificate : +ITEM [ 1006062, 1006064] ";
		}
	}

	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}

//***********************************************
//*** 작업자   : stunlee                  *******
//*** 내용     : 크리스마스선물           *******
//*** 작성일시 : 2006/07/12               *******
//***********************************************
quest qUseItem1006123()			// 크리스마스선물
{
	integer iRandom;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 50) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	iRandom = Util.random(1, 10000);

	if(iRandom <= 25)		// 블러드 암릿 1003393
	{
		trigger.addItemClassNamed("1003393", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG1, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1003393 ] ";
	}
	else if(iRandom <= 50)		// 사울아비 밴드 1002187
	{
		trigger.addItemClassNamed("1002187", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG2, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1002187 ] ";
	}
	else if(iRandom <= 75)		// 라그랑즈 팔찌 1002203
	{
		trigger.addItemClassNamed("1002203", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG3, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1002203 ] ";
	}
	else if(iRandom <= 100)		// 스크트무 실드 1003025
	{
		trigger.addItemClassNamed("1003025", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG4, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1003025 ] ";
	}
	else if(iRandom <= 125)		// 빙한의 투구 1000992
	{
		trigger.addItemClassNamed("1000992", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG5, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000992 ] ";
	}
	else if(iRandom <= 150)		// 빙한의 날개 1000993
	{
		trigger.addItemClassNamed("1000993", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG6, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000993 ] ";
	}
	else if(iRandom <= 175)		// 빙한의 갑옷 1000994
	{
		trigger.addItemClassNamed("1000994", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG7, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000994 ] ";
	}
	else if(iRandom <= 200)		// 빙한의 팔찌 1000995
	{
		trigger.addItemClassNamed("1000995", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG8, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000995 ] ";
	}
	else if(iRandom <= 225)		// 빙한의 슈즈 1000996
	{
		trigger.addItemClassNamed("1000996", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG9, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000996 ] ";
	}
	else if(iRandom <= 1000)	// 질풍의 약초 1001890
	{
		trigger.addItemClassNamed("1001890", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG10, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001890 ] ";
	}
	else if(iRandom <= 3000)	// 리저렉션 포션(대) 1000040
	{
		trigger.addItemClassNamed("1000040", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG11, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000040 ] ";
	}
	else if(iRandom <= 6000)	// 마나의 결정 1000033
	{
		trigger.addItemClassNamed("1000033", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG12, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000033 ] ";
	}
	else if(iRandom <= 9000)	// 생명의 조각 1000022
	{
		trigger.addItemClassNamed("1000022", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG13, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000022 ] ";
	}
	else				// 천사의 눈물 1000053
	{
		trigger.addItemClassNamed("1000053", 1);
		trigger.message(TEXT_CHRISTMAS_BOX_MSG14, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000053 ] ";
	}
	trigger.updateAttr();

	if(controller.canBeExhausted())
	{
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);
}

//******************************************************
// 추석 이벤트 랜덤 아이템
// 2006.10.02 written by Han
//******************************************************
quest qUseItem1002339()
{
	if (!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_CLAD_LACK_EVSLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_CLAD_LACK_EVWEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getRandomItem(14))		// vahma - japan setting
	{
		// decrease number
		if (controller.canBeExhausted()) {
			controller.decreaseNumber(1);
		}

		// send using effect
		controller.effectBy(trigger);
	}
	else
	{
		trigger.message(TEXT_USABLEITEM_NOT_GET, MSG_TYPE__SYSTEM);
		return;
	}
}


//******************************************************
// 신규 조제 아이템
// 2006.10.26 written by Stunlee
//******************************************************
//조제 1단계
quest
qMedicineUseItem1_wait()
{
	trigger.message(TEXT_USABLEITEM_CANT_TIMEPA + "3" + TEXT_USABLEITEM_CANT_TIMEPB, MSG_TYPE__SYSTEM);
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	Machine.setSavable();

	// 3분간 기다림
   	//Event.timedWaitFor(EVENT_GET, 1200);
	Util.sleep(180);
	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qMedicineUseItem2_wait()
{
	trigger.message(TEXT_USABLEITEM_CANT_TIMEPA + "4" + TEXT_USABLEITEM_CANT_TIMEPB, MSG_TYPE__SYSTEM);
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	Machine.setSavable();

	// 4분간 기다림
   	//Event.timedWaitFor(EVENT_GET, 1200);
	Util.sleep(240);
	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qMedicineUseItem3_wait()
{
	trigger.message(TEXT_USABLEITEM_CANT_TIMEPA + "5" + TEXT_USABLEITEM_CANT_TIMEPB, MSG_TYPE__SYSTEM);
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	Machine.setSavable();

	// 5분간 기다림
   	//Event.timedWaitFor(EVENT_GET, 1200);
	Util.sleep(300);
	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qMedicineUseItem4_wait()
{
	trigger.message(TEXT_USABLEITEM_CANT_TIMEPA + "5" + TEXT_USABLEITEM_CANT_TIMEPB, MSG_TYPE__SYSTEM);
	trigger.setState(CREATURE_STATE__ITEM_USE, true);

	Machine.setSavable();

	// 5분간 기다림
   	//Event.timedWaitFor(EVENT_GET, 1200);
	Util.sleep(600);
	trigger.setState(CREATURE_STATE__ITEM_USE, false);
}

quest
qMedicineUseItem()			// 조제 아이템 사용
{
	object castedSpellInven;

	string Type = Machine.getArgAt(0);

	castedSpellInven = trigger.getCastedSpellInventory();

	if(!NormalItemCanBeUsed()) return;

	// 블레스 사용중일 때는 아이템 사용 불가
	if (castedSpellInven.hasNamed("3000210") || castedSpellInven.hasNamed("3000862")
	 || castedSpellInven.hasNamed("3000807") || castedSpellInven.hasNamed("3000806"))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING_ERROR, MSG_TYPE__SYSTEM);
		return;
	}

	if (Type == "1")		// 우황 : Def증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001889") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		UseSkill(trigger,"3001868",600);
	}
	else if (Type == "2")		// 화용단 : Dex증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001869") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001891") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
		UseSkill(trigger,"3001869",600);

	}
	else if (Type == "3")		// 로얄 허니 : MR증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001874")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001882")
		 || castedSpellInven.hasNamed("3001883") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		UseSkill(trigger,"3001870",600);

	}
	else if (Type == "4")		// 스쿠알렌 : Stab, Hack증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001871") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001877") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		UseSkill(trigger,"3001871",600);

	}
	else if (Type == "5")		// 우황정단 : Def증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001889") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
		UseSkill(trigger,"3001872",600);


	}
	else if (Type == "6")		// 화용정단 : Dex증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001869") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001891") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
		UseSkill(trigger,"3001873",600);

	}
	else if (Type == "7")		// 자양강장제(소) : MR증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001874")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001882")
		 || castedSpellInven.hasNamed("3001883") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		UseSkill(trigger,"3001874",600);

	}
	else if (Type == "8")		// 스쿠알렌(정) :  Stab, Hack증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001871") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001877") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		UseSkill(trigger,"3001875",600);

	}
	else if (Type == "9")		// 풍정단 : Dex증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001869") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001891") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem1_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001876",600))
			trigger.giveQuestTo("qMedicineUseItem1_wait", trigger, null);

	}
	else if (Type == "10")		// 화용대단 : Stab, Hack증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001871") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001877") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem1_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001877",600))
			trigger.giveQuestTo("qMedicineUseItem1_wait", trigger, null);

	}
	else if (Type == "11")		// 방어의 포션 : Def, MR증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001889")
		 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001874")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001881") || castedSpellInven.hasNamed("3001883")
		 || castedSpellInven.hasNamed("3001885") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem1_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001878",600))
			trigger.giveQuestTo("qMedicineUseItem1_wait", trigger, null);

	}
	else if (Type == "12")		// 충전의 포션(소) : 모든 능력치 증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001869")
		 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001871")
		 || castedSpellInven.hasNamed("3001872") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001874") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001877") 
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001882") || castedSpellInven.hasNamed("3001883")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001888") || castedSpellInven.hasNamed("3001889") 
		 || castedSpellInven.hasNamed("3001890") || castedSpellInven.hasNamed("3001891")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem1_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001879",600))
			trigger.giveQuestTo("qMedicineUseItem1_wait", trigger, null);

	}
	else if (Type == "13")		// 충전의 포션(중) : 모든 능력치 증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001869")
		 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001871")
		 || castedSpellInven.hasNamed("3001872") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001874") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001877") 
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001882") || castedSpellInven.hasNamed("3001883")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001888") || castedSpellInven.hasNamed("3001889") 
		 || castedSpellInven.hasNamed("3001890") || castedSpellInven.hasNamed("3001891")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem2_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001880",600))
			trigger.giveQuestTo("qMedicineUseItem2_wait", trigger, null);

	}
	else if (Type == "14")		// 방어의 포션 : Def증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001889") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem2_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001881",600))
			trigger.giveQuestTo("qMedicineUseItem2_wait", trigger, null);

	}
	else if (Type == "15")		// 화용대환단 : MR증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001874")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001882")
		 || castedSpellInven.hasNamed("3001883") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem2_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001882",600))
			trigger.giveQuestTo("qMedicineUseItem2_wait", trigger, null);

	}
	else if (Type == "16")		// 레지스트의 포션 : MR증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001874")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001882")
		 || castedSpellInven.hasNamed("3001883") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem3_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001883",600))
			trigger.giveQuestTo("qMedicineUseItem3_wait", trigger, null);

	}
	else if (Type == "17")		// 방어의 포션 : Def증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001889") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem3_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001884",600))
			trigger.giveQuestTo("qMedicineUseItem3_wait", trigger, null);

	}
	else if (Type == "18")		// 충전의 포션 : 모든능력치 증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001869")
		 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001871")
		 || castedSpellInven.hasNamed("3001872") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001874") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001877") 
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001882") || castedSpellInven.hasNamed("3001883")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001888") || castedSpellInven.hasNamed("3001889") 
		 || castedSpellInven.hasNamed("3001890") || castedSpellInven.hasNamed("3001891")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem3_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001885",600))
			trigger.giveQuestTo("qMedicineUseItem3_wait", trigger, null);

	}
	else if (Type == "19")		// 검술의 비약 : Stab 증가
	{
		// 이미 사용 중
		if (castedSpellInven.hasNamed("3001871") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001877") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001886",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001886",1800);
	}
	else if (Type == "20")		// 도법의 비약 : Hack 증가
	{
		if (castedSpellInven.hasNamed("3001871") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001877") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001887") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001887",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001887",1800);
	}
	else if (Type == "21")		// 지식의 비약 : Int 증가
	{
		if (castedSpellInven.hasNamed("3001879") || castedSpellInven.hasNamed("3001880")
		 || castedSpellInven.hasNamed("3001885")|| castedSpellInven.hasNamed("3001888")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001888",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001888",1800);
	}
	else if (Type == "22")		// 보호의 비약 :  Def 증가
	{
		if (castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001872")
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001889") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001889",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001889",1800);
	}
	else if (Type == "23")		// 민첩의 비약 : Agi 증가
	{
		if (castedSpellInven.hasNamed("3001879") || castedSpellInven.hasNamed("3001880")
		 || castedSpellInven.hasNamed("3001885")|| castedSpellInven.hasNamed("3001890")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001890",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001890",1800);
	}
	else if (Type == "24")		// 통찰의 비약 : Dex 증가
	{
		if (castedSpellInven.hasNamed("3001869") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001879") 
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001891") || castedSpellInven.hasNamed("3001893")
		 || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}
/*
		if (trigger.hasQuest("qMedicineUseItem_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001891",600))
			trigger.giveQuestTo("qMedicineUseItem_wait", trigger, null);
*/
		UseSkill(trigger,"3001891",1800);
	}
	else if (Type == "25")		// 사미선령지체 : 올스텟 증가
	{
		if (castedSpellInven.hasNamed("3001835") || castedSpellInven.hasNamed("3001836")
		 || castedSpellInven.hasNamed("3001837") || castedSpellInven.hasNamed("3001838") 
		 || castedSpellInven.hasNamed("3001839") || castedSpellInven.hasNamed("3001840")
		 || castedSpellInven.hasNamed("3001841") || castedSpellInven.hasNamed("3001842")
		 || castedSpellInven.hasNamed("3001843") || castedSpellInven.hasNamed("3001844")
		 || castedSpellInven.hasNamed("3001845") || castedSpellInven.hasNamed("3001846")
		 || castedSpellInven.hasNamed("3001847") || castedSpellInven.hasNamed("3001848")
		 || castedSpellInven.hasNamed("3001849") || castedSpellInven.hasNamed("3001850")
		 || castedSpellInven.hasNamed("3001851") || castedSpellInven.hasNamed("3001852")
		 || castedSpellInven.hasNamed("3001853") || castedSpellInven.hasNamed("3001854")
		 || castedSpellInven.hasNamed("3001855") || castedSpellInven.hasNamed("3001856")
		 || castedSpellInven.hasNamed("3001857") || castedSpellInven.hasNamed("3001858")
		 || castedSpellInven.hasNamed("3001859") || castedSpellInven.hasNamed("3001860")
		 || castedSpellInven.hasNamed("3001861") || castedSpellInven.hasNamed("3001862")
		 || castedSpellInven.hasNamed("3001863") || castedSpellInven.hasNamed("3001864")
		 || castedSpellInven.hasNamed("3001865") || castedSpellInven.hasNamed("3001866")
		 || castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001869")
		 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001871")
		 || castedSpellInven.hasNamed("3001872") || castedSpellInven.hasNamed("3001873")
		 || castedSpellInven.hasNamed("3001874") || castedSpellInven.hasNamed("3001875")
		 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001877") 
		 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
		 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
		 || castedSpellInven.hasNamed("3001882") || castedSpellInven.hasNamed("3001883")
		 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
		 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
		 || castedSpellInven.hasNamed("3001888") || castedSpellInven.hasNamed("3001889") 
		 || castedSpellInven.hasNamed("3001890") || castedSpellInven.hasNamed("3001891")
		 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
		{
			trigger.message(TEXT_USABLEITEM_PREPARATION_ERROR, MSG_TYPE__SYSTEM);
			return;
		}

		if (trigger.hasQuest("qMedicineUseItem4_wait")) 
		{
			trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
			return;
		}

		if (UseSkill(trigger,"3001893",300))
			trigger.giveQuestTo("qMedicineUseItem4_wait", trigger, null);

	}

	// send using effect
	controller.effectBy(trigger);
	return;
}

quest
qMedicineCookUseItem()		// 요리 회복 아이템 사용
{
	object castedSpellInven;

	string Type = Machine.getArgAt(0);

	castedSpellInven = trigger.getCastedSpellInventory();

	if(!NormalItemCanBeUsed()) return;

	if (castedSpellInven.hasNamed("3000210") || castedSpellInven.hasNamed("3000862")
	 || castedSpellInven.hasNamed("3000807") || castedSpellInven.hasNamed("3000806"))
	{
		trigger.message(TEXT_USABLEITEM_BLESSING_ERROR, MSG_TYPE__SYSTEM);
		return;
	}
	if (castedSpellInven.hasNamed("3001835") || castedSpellInven.hasNamed("3001836")
	 || castedSpellInven.hasNamed("3001837") || castedSpellInven.hasNamed("3001838")
	 || castedSpellInven.hasNamed("3001839") || castedSpellInven.hasNamed("3001840")
	 || castedSpellInven.hasNamed("3001841") || castedSpellInven.hasNamed("3001842")
	 || castedSpellInven.hasNamed("3001843") || castedSpellInven.hasNamed("3001844")
	 || castedSpellInven.hasNamed("3001845") || castedSpellInven.hasNamed("3001846")
	 || castedSpellInven.hasNamed("3001847") || castedSpellInven.hasNamed("3001848")
	 || castedSpellInven.hasNamed("3001849") || castedSpellInven.hasNamed("3001850")
	 || castedSpellInven.hasNamed("3001851") || castedSpellInven.hasNamed("3001852")
	 || castedSpellInven.hasNamed("3001853") || castedSpellInven.hasNamed("3001854")
	 || castedSpellInven.hasNamed("3001855") || castedSpellInven.hasNamed("3001856")
	 || castedSpellInven.hasNamed("3001857") || castedSpellInven.hasNamed("3001858")
	 || castedSpellInven.hasNamed("3001859") || castedSpellInven.hasNamed("3001860")
	 || castedSpellInven.hasNamed("3001861") || castedSpellInven.hasNamed("3001862")
	 || castedSpellInven.hasNamed("3001863") || castedSpellInven.hasNamed("3001864")
	 || castedSpellInven.hasNamed("3001865") || castedSpellInven.hasNamed("3001866")
	 || castedSpellInven.hasNamed("3001868") || castedSpellInven.hasNamed("3001869")
	 || castedSpellInven.hasNamed("3001870") || castedSpellInven.hasNamed("3001871")
	 || castedSpellInven.hasNamed("3001872") || castedSpellInven.hasNamed("3001873")
	 || castedSpellInven.hasNamed("3001874") || castedSpellInven.hasNamed("3001875")
	 || castedSpellInven.hasNamed("3001876") || castedSpellInven.hasNamed("3001877")
	 || castedSpellInven.hasNamed("3001878") || castedSpellInven.hasNamed("3001879")
	 || castedSpellInven.hasNamed("3001880") || castedSpellInven.hasNamed("3001881")
	 || castedSpellInven.hasNamed("3001882") || castedSpellInven.hasNamed("3001883")
	 || castedSpellInven.hasNamed("3001884") || castedSpellInven.hasNamed("3001885")
	 || castedSpellInven.hasNamed("3001886") || castedSpellInven.hasNamed("3001887")
	 || castedSpellInven.hasNamed("3001888") || castedSpellInven.hasNamed("3001889")
	 || castedSpellInven.hasNamed("3001890") || castedSpellInven.hasNamed("3001891")
	 || castedSpellInven.hasNamed("3001893") || castedSpellInven.hasNamed("3001894"))
	{
		trigger.message(TEXT_USABLEITEM_COOKS_ERROR, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.hasQuest("qMedicineUseItem4_wait")) 
	{
		trigger.message(TEXT_USABLEITEM_CANT_TIME, MSG_TYPE__SYSTEM);
		return;
	}

	if(Type == "1")
	{
		if (UseSkill(trigger,"3001894",300))
			trigger.giveQuestTo("qMedicineUseItem4_wait", trigger, null);
	}

	// send using effect
	controller.effectBy(trigger);
	return;
}

//******************************************************
// 토끼굴 보상 아이템(레퍼스의 선물상자)
// 2006.11.09 written by Stunlee
//******************************************************
quest
qUseItem1006540()				// 선물 상자
{
	integer iRandom;
	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;

	iRandom = Util.random(1, 1000);
	// Log Info
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 100) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	if(iRandom <= 10)		// 1006561 레퍼스 토끼귀 장식
	{
		trigger.addItemClassNamed("1006561", 1);
		trigger.message(TEXT_GIST_BOX_MSG1, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006561 ] ";
	}
	else if(iRandom <= 20)		// 1006562 레퍼스 토끼 인형 머리띠
	{
		trigger.addItemClassNamed("1006562", 1);
		trigger.message(TEXT_GIST_BOX_MSG2, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006562 ] ";
	}
	else if(iRandom <= 40)		// 1006563 레퍼스 토끼 꼬리
	{
		trigger.addItemClassNamed("1006563", 1);
		trigger.message(TEXT_GIST_BOX_MSG3, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006563 ] ";
	}
	else if(iRandom <= 50)		// 1006565 레퍼스 토끼털 옷
	{
		trigger.addItemClassNamed("1006565", 1);
		trigger.message(TEXT_GIST_BOX_MSG4, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006565 ] ";
	}
	else if(iRandom <= 60)		// 1006564 레퍼스 토끼발 슈즈
	{
		trigger.addItemClassNamed("1006564", 1);
		trigger.message(TEXT_GIST_BOX_MSG5, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006564 ] ";
	}
	else if(iRandom <= 690)		// 1006566 발빠른 당근 쥬스
	{
		trigger.addItemClassNamed("1006566", 1);
		trigger.message(TEXT_GIST_BOX_MSG6, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1006566 ] ";
	}
	else if(iRandom <= 840)		// 1001889 신속의 열매
	{
		trigger.addItemClassNamed("1001889", 1);
		trigger.message(TEXT_GIST_BOX_MSG7, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001889 ] ";
	}
	else if(iRandom <= 850)		// 1001895 회피의 쿠키
	{
		trigger.addItemClassNamed("1001895", 1);
		trigger.message(TEXT_GIST_BOX_MSG8, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001895 ] ";
	}
	else if(iRandom <= 1000)	// 1001894 적중의 쿠키
	{
		trigger.addItemClassNamed("1001894", 1);
		trigger.message(TEXT_GIST_BOX_MSG9, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001894 ] ";
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	Util.log(time_Info + Item_Info + world_Info);

	// send using effect
	controller.effectBy(trigger);
}


//******************************************************
// 일본 수표 아이템(교환시 100만 시드 획득)
// 2006.11.13 written by Stunlee
//******************************************************
quest
qUseItem1005056()				// 수표
{
	if(trigger.getAvailGold() < 1000000)		// 유저 소지 한도 체크
	{
		trigger.message(TEXT_GETAVAILGOLD_SMALL_MSG, MSG_TYPE__SYSTEM);
		return ;
	}

	trigger.setGold(trigger.getGold() + 1000000);			// 유저에게 돈 지급
	trigger.updateAttr();

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}
}
/*
//******************************************************
// 우수고객용 선물상자 아이템
// 2006.11.14 written by Stunlee
//******************************************************
quest qUseItem1006573()			// 우수고객용 선물상자
{
	integer iRandom;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 2) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 200) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	iRandom = Util.random(1, 10000);

	if(iRandom <= 990)	
}
*/

//******************************************************
// 눈사람 일족의 선물 상자 (일본 겨울방학 이벤트 지급용)
// 2006.11.19 written by Han
//******************************************************
function integer itemSupplyCount(integer iRandom)
{
	if (iRandom <= 600)
		return 1;
	else if(iRandom <= 900)
		return 3;
	else
		return 5;
}

quest
qUseItem1006608()		// 눈사람 일족의 선물 상자
{
	integer iRandom, itemCnt;

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 5) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 50) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 신속의 열매 지급
	iRandom = Util.random(1,1000);
	itemCnt = itemSupplyCount(iRandom);
	trigger.addItemClassNamed("1001889", itemCnt);
	trigger.message(TEXT_SNOWMAN_ITME_BOX_MSG1 + itemCnt + TEXT_SNOWMAN_ITME_BOX_MSG6, MSG_TYPE__SYSTEM);

	// 질풍의 약초 지급
	iRandom = Util.random(1,1000);
	itemCnt = itemSupplyCount(iRandom);
	trigger.addItemClassNamed("1001890", itemCnt);
	trigger.message(TEXT_SNOWMAN_ITME_BOX_MSG2 + itemCnt + TEXT_SNOWMAN_ITME_BOX_MSG6, MSG_TYPE__SYSTEM);

	// 괴력의 햄 지급
	iRandom = Util.random(1,1000);
	itemCnt = itemSupplyCount(iRandom);
	trigger.addItemClassNamed("1001892", itemCnt);
	trigger.message(TEXT_SNOWMAN_ITME_BOX_MSG3 + itemCnt + TEXT_SNOWMAN_ITME_BOX_MSG6, MSG_TYPE__SYSTEM);

	// 적중의 푸딩 지급
	iRandom = Util.random(1,1000);
	itemCnt = itemSupplyCount(iRandom);
	trigger.addItemClassNamed("1001894", itemCnt);
	trigger.message(TEXT_SNOWMAN_ITME_BOX_MSG4 + itemCnt + TEXT_SNOWMAN_ITME_BOX_MSG6, MSG_TYPE__SYSTEM);

	// 회피의 쿠키 지급
	iRandom = Util.random(1,1000);
	itemCnt = itemSupplyCount(iRandom);
	trigger.addItemClassNamed("1001895", itemCnt);
	trigger.message(TEXT_SNOWMAN_ITME_BOX_MSG5 + itemCnt + TEXT_SNOWMAN_ITME_BOX_MSG6, MSG_TYPE__SYSTEM);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

//******************************************************
// 레벨업 축하 선물 (친친 레벨업 킹 이벤트 지급용)
// 2006.12.19 written by Han
//******************************************************
quest
qUseItem1006748()		// 레벨업 축하 선물
{
	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 3) {
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}
	if (trigger.getAvailInvenWeight() < 30) {
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}

	// 케이크 조각 1개 지급
	trigger.addItemClassNamed("1002698", 1);
	trigger.message(TEXT_LEVEL_UP_KING_EVENT_BOX1, MSG_TYPE__SYSTEM);
	// 신속의 열매 2개
	trigger.addItemClassNamed("1001889", 2);
	trigger.message(TEXT_LEVEL_UP_KING_EVENT_BOX2, MSG_TYPE__SYSTEM);
	// 건강식 오리 구이 3개
	trigger.addItemClassNamed("1004007", 3);
	trigger.message(TEXT_LEVEL_UP_KING_EVENT_BOX3, MSG_TYPE__SYSTEM);

	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);
}

//******************************************************
// 일본 3주년 선물 상자 
// 2007. 2.20 written by Stunlee
//******************************************************
quest
qUseItem1005062()		// 일본 3주년 선물 상자
{
	integer iRandom1;

	integer tickTime;
	string time_Info, world_Info, Item_Info;
	string userName;


	iRandom1 = Util.random(1,1000000);
	userName = trigger.getName();
	tickTime = Util.getTick();

	time_Info = "(" + Util.getYear(tickTime) + ") " + Util.getMonth(tickTime) + "/" + Util.getDay(tickTime) + " " + Util.getHour(tickTime) + ":" +  Util.getMinute(tickTime) + " User [" + userName + "] ";
	world_Info = "[" + trigger.getWorld().getName() + ":" + trigger.getX() + "," + trigger.getY() + "]";

	if(!NormalItemCanBeUsed()) return;

	// 아이템 지급 전에 슬롯이랑 무게랑 체크한다.
	if (trigger.getEmptyInvenSlotCount() < 1)
	{
		trigger.message(TEXT_NOT_ENOUGH_SLOT, MSG_TYPE__SYSTEM);
		return;
	}

	if (trigger.getAvailInvenWeight() < 10)
	{
		trigger.message(TEXT_NOT_ENOUGH_WEIGHT, MSG_TYPE__SYSTEM);
		return;
	}



	if (iRandom1 <= 10000)	// 레어 기념 가면
	{
		trigger.addItemClassNamed("1005060", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1005060 ] ";

	}
	else if (iRandom1 <= 500000)	// 일반 기념 가면
	{
		trigger.addItemClassNamed("1005061", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1005061 ] ";

	}
	else if (iRandom1 <= 580000)
	{
		trigger.addItemClassNamed("1001895", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_1, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001895 ] ";
	}
	else if (iRandom1 <= 660000)
	{
		trigger.addItemClassNamed("1001894", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_2, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001894 ] ";
	}
	else if (iRandom1 <= 740000)
	{
		trigger.addItemClassNamed("1001890", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_3, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1001890 ] ";
	}
	else if (iRandom1 <= 790000)
	{
		trigger.addItemClassNamed("1000018", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_4, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000018 ] ";
	}
	else if (iRandom1 <= 840000)
	{
		trigger.addItemClassNamed("1000029", 1);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_5, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000029 ] ";
	}
	else if (iRandom1 <= 920000)
	{
		trigger.addItemClassNamed("1000017", 3);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_6, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000017 ] ";
	}
	else
	{
		trigger.addItemClassNamed("1000028", 3);
		trigger.message(TEXT_JAPAN_MEMORY_ITEM_7, MSG_TYPE__SYSTEM);
		Item_Info = "From Gift Certificate : +ITEM [ 1000028 ] ";
	}
	// decrease number
	if (controller.canBeExhausted()) {
		controller.decreaseNumber(1);
	}

	// send using effect
	controller.effectBy(trigger);

	Util.log(time_Info + Item_Info + world_Info);
}

